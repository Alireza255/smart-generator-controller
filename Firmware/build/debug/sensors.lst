ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"sensors.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/IO/sensors.c"
  20              		.section	.rodata.sensor_tps_get.str1.4,"aMS",%progbits,1
  21              		.align	2
  22              	.LC3:
  23 0000 74707320 		.ascii	"tps is null\000"
  23      6973206E 
  23      756C6C00 
  24              		.align	2
  25              	.LC4:
  26 000c 74707320 		.ascii	"tps wrong sensor calib\000"
  26      77726F6E 
  26      67207365 
  26      6E736F72 
  26      2063616C 
  27              		.section	.text.sensor_tps_get,"ax",%progbits
  28              		.align	1
  29              		.global	sensor_tps_get
  30              		.syntax unified
  31              		.thumb
  32              		.thumb_func
  34              	sensor_tps_get:
  35              	.LVL0:
  36              	.LFB228:
   1:controller/IO/sensors.c **** #include "sensors.h"
   2:controller/IO/sensors.c **** 
   3:controller/IO/sensors.c **** static sensor_map_t *map_sensor = NULL;
   4:controller/IO/sensors.c **** static thermistor_t *sensor_iat = NULL;
   5:controller/IO/sensors.c **** static thermistor_t *sensor_clt = NULL;
   6:controller/IO/sensors.c **** static sensor_ops_t *sensor_ops = NULL;
   7:controller/IO/sensors.c **** 
   8:controller/IO/sensors.c **** percent_t sensor_tps_get(sensor_tps_t *sensor)
   9:controller/IO/sensors.c **** {
  37              		.loc 1 9 1 view -0
  38              		.cfi_startproc
  39              		@ args = 0, pretend = 0, frame = 0
  40              		@ frame_needed = 0, uses_anonymous_args = 0
  41              		.loc 1 9 1 is_stmt 0 view .LVU1
  42 0000 10B5     		push	{r4, lr}
  43              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 2


  44              		.cfi_offset 4, -8
  45              		.cfi_offset 14, -4
  10:controller/IO/sensors.c ****     if (sensor == NULL)
  46              		.loc 1 10 5 is_stmt 1 view .LVU2
  47              		.loc 1 10 8 is_stmt 0 view .LVU3
  48 0002 A0B3     		cbz	r0, .L17
  49 0004 0446     		mov	r4, r0
  11:controller/IO/sensors.c ****     {
  12:controller/IO/sensors.c ****         log_error("tps is null");
  13:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
  14:controller/IO/sensors.c ****     }
  15:controller/IO/sensors.c ****      if (sensor->wide_open_throttle_adc_value == 0 && sensor->closed_throttle_adc_value == 0)
  50              		.loc 1 15 6 is_stmt 1 view .LVU4
  51              		.loc 1 15 16 is_stmt 0 view .LVU5
  52 0006 0388     		ldrh	r3, [r0]
  53              		.loc 1 15 9 view .LVU6
  54 0008 0BB9     		cbnz	r3, .L4
  55              		.loc 1 15 61 discriminator 1 view .LVU7
  56 000a 4388     		ldrh	r3, [r0, #2]
  57              		.loc 1 15 52 discriminator 1 view .LVU8
  58 000c ABB3     		cbz	r3, .L18
  59              	.L4:
  16:controller/IO/sensors.c ****     {
  17:controller/IO/sensors.c ****         log_error("tps wrong sensor calib");
  18:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
  19:controller/IO/sensors.c ****     }
  20:controller/IO/sensors.c ****     percent_t result = 0;
  60              		.loc 1 20 5 is_stmt 1 view .LVU9
  61              	.LVL1:
  21:controller/IO/sensors.c ****     uint16_t raw_data = analog_inputs_get_data(sensor->analog_channel);
  62              		.loc 1 21 5 view .LVU10
  63              		.loc 1 21 25 is_stmt 0 view .LVU11
  64 000e 2079     		ldrb	r0, [r4, #4]	@ zero_extendqisi2
  65              	.LVL2:
  66              		.loc 1 21 25 view .LVU12
  67 0010 FFF7FEFF 		bl	analog_inputs_get_data
  68              	.LVL3:
  69 0014 07EE900A 		vmov	s15, r0	@ int
  70              	.LVL4:
  22:controller/IO/sensors.c ****     if (sensor->is_inverted)
  71              		.loc 1 22 5 is_stmt 1 view .LVU13
  72              		.loc 1 22 15 is_stmt 0 view .LVU14
  73 0018 6379     		ldrb	r3, [r4, #5]	@ zero_extendqisi2
  74              		.loc 1 22 8 view .LVU15
  75 001a A3B3     		cbz	r3, .L5
  23:controller/IO/sensors.c ****     {
  24:controller/IO/sensors.c ****         result = mapf((float)raw_data, (float)sensor->wide_open_throttle_adc_value, (float)sensor->
  76              		.loc 1 24 9 is_stmt 1 view .LVU16
  77              		.loc 1 24 18 is_stmt 0 view .LVU17
  78 001c F8EE677A 		vcvt.f32.u32	s15, s15
  79              	.LVL5:
  80              		.loc 1 24 53 view .LVU18
  81 0020 2288     		ldrh	r2, [r4]
  82              		.loc 1 24 18 view .LVU19
  83 0022 07EE102A 		vmov	s14, r2	@ int
  84 0026 F8EE476A 		vcvt.f32.u32	s13, s14
  85              		.loc 1 24 98 view .LVU20
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 3


  86 002a 6388     		ldrh	r3, [r4, #2]
  87              		.loc 1 24 18 view .LVU21
  88 002c 07EE103A 		vmov	s14, r3	@ int
  89 0030 B8EE477A 		vcvt.f32.u32	s14, s14
  90              	.LVL6:
  91              	.LBB8:
  92              	.LBI8:
  93              		.file 2 "controller/utils/utils.h"
   1:controller/utils/utils.h **** /**
   2:controller/utils/utils.h ****  * @file utils.h
   3:controller/utils/utils.h ****  * @brief Header file containing utility functions and definitions for the smart generator controll
   4:controller/utils/utils.h ****  * 
   5:controller/utils/utils.h ****  * This file provides declarations for utility functions and macros that are
   6:controller/utils/utils.h ****  * used throughout the firmware to support various functionalities.
   7:controller/utils/utils.h ****  * 
   8:controller/utils/utils.h ****  * @note Ensure that this file is included wherever utility functions are required.
   9:controller/utils/utils.h ****  */
  10:controller/utils/utils.h **** #ifndef UTILS_H
  11:controller/utils/utils.h **** #define UTILS_H
  12:controller/utils/utils.h **** 
  13:controller/utils/utils.h **** #include "types.h"
  14:controller/utils/utils.h **** #include "math.h"
  15:controller/utils/utils.h **** #define IS_IN_RANGE(value, min, max) ((value) >= (min) && (value) <= (max))
  16:controller/utils/utils.h **** #define ABS(value) ((value) < 0 ? -(value) : (value))
  17:controller/utils/utils.h **** #define CLAMP(value, min, max) ((value) < (min) ? (min) : ((value) > (max) ? (max) : (value)))
  18:controller/utils/utils.h **** 
  19:controller/utils/utils.h **** /**
  20:controller/utils/utils.h ****  * @brief Maps a value from one range to another.
  21:controller/utils/utils.h ****  * 
  22:controller/utils/utils.h ****  * @param x The value to map.
  23:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  24:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  25:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  26:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  27:controller/utils/utils.h ****  * @return The mapped value in the output range.
  28:controller/utils/utils.h ****  */
  29:controller/utils/utils.h **** #define MAP(x, in_min, in_max, out_min, out_max) \
  30:controller/utils/utils.h ****     (((x) - (in_min)) * ((out_max) - (out_min)) / ((in_max) - (in_min)) + (out_min))
  31:controller/utils/utils.h **** 
  32:controller/utils/utils.h **** 
  33:controller/utils/utils.h **** /**
  34:controller/utils/utils.h ****  * @brief Maps a uint16_t value from one range to another.
  35:controller/utils/utils.h ****  * 
  36:controller/utils/utils.h ****  * @param x The value to map.
  37:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  38:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  39:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  40:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  41:controller/utils/utils.h ****  * @return The mapped value in the output range.
  42:controller/utils/utils.h ****  */
  43:controller/utils/utils.h **** static inline uint16_t map_uint16(uint16_t x, uint16_t in_min, uint16_t in_max, uint16_t out_min, u
  44:controller/utils/utils.h **** {
  45:controller/utils/utils.h ****     if (in_max == in_min)
  46:controller/utils/utils.h ****     {
  47:controller/utils/utils.h ****         return 0; // Avoid division by zero
  48:controller/utils/utils.h ****     }
  49:controller/utils/utils.h ****     return (uint16_t)((x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 4


  50:controller/utils/utils.h **** }
  51:controller/utils/utils.h **** 
  52:controller/utils/utils.h **** static inline float mapf(float x, float in_min, float in_max, float out_min, float out_max)
  94              		.loc 2 52 21 is_stmt 1 view .LVU22
  95              	.LBB9:
  53:controller/utils/utils.h **** {
  54:controller/utils/utils.h ****     if (in_max == in_min)
  96              		.loc 2 54 5 view .LVU23
  97              		.loc 2 54 8 is_stmt 0 view .LVU24
  98 0034 9A42     		cmp	r2, r3
  99 0036 43D0     		beq	.L10
  55:controller/utils/utils.h ****     {
  56:controller/utils/utils.h ****         return 0.0f; // Avoid division by zero
  57:controller/utils/utils.h ****     }
  58:controller/utils/utils.h ****     return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
 100              		.loc 2 58 5 is_stmt 1 view .LVU25
 101              		.loc 2 58 15 is_stmt 0 view .LVU26
 102 0038 77EEE67A 		vsub.f32	s15, s15, s13
 103              	.LVL7:
 104              		.loc 2 58 25 view .LVU27
 105 003c 9FED266A 		vldr.32	s12, .L21
 106 0040 67EE867A 		vmul.f32	s15, s15, s12
 107              		.loc 2 58 57 view .LVU28
 108 0044 37EE667A 		vsub.f32	s14, s14, s13
 109              	.LVL8:
 110              		.loc 2 58 47 view .LVU29
 111 0048 87EE870A 		vdiv.f32	s0, s15, s14
 112              		.loc 2 58 67 view .LVU30
 113 004c DFED237A 		vldr.32	s15, .L21+4
 114 0050 30EE270A 		vadd.f32	s0, s0, s15
 115              	.LVL9:
 116              	.L7:
 117              		.loc 2 58 67 view .LVU31
 118              	.LBE9:
 119              	.LBE8:
  25:controller/IO/sensors.c ****     }
  26:controller/IO/sensors.c ****     else
  27:controller/IO/sensors.c ****     {
  28:controller/IO/sensors.c ****         result = mapf((float)raw_data, (float)sensor->closed_throttle_adc_value, (float)sensor->wid
  29:controller/IO/sensors.c ****     }
  30:controller/IO/sensors.c ****     if (!IS_IN_RANGE(result, (percent_t)0, (percent_t)100))
 120              		.loc 1 30 5 is_stmt 1 view .LVU32
 121              		.loc 1 30 8 is_stmt 0 view .LVU33
 122 0054 B5EEC00A 		vcmpe.f32	s0, #0
 123 0058 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 124 005c 36DB     		blt	.L19
 125              	.LVL10:
 126              	.L6:
 127              		.loc 1 30 9 discriminator 1 view .LVU34
 128 005e DFED1E7A 		vldr.32	s15, .L21
 129 0062 B4EEE70A 		vcmpe.f32	s0, s15
 130 0066 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 131 006a 32D8     		bhi	.L20
 132              	.LVL11:
 133              	.L1:
  31:controller/IO/sensors.c ****     {
  32:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 5


  33:controller/IO/sensors.c ****         log_error("tps out of range!");
  34:controller/IO/sensors.c ****     }
  35:controller/IO/sensors.c ****     return result;
  36:controller/IO/sensors.c **** }
 134              		.loc 1 36 1 view .LVU35
 135 006c 10BD     		pop	{r4, pc}
 136              	.LVL12:
 137              	.L17:
  12:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
 138              		.loc 1 12 9 is_stmt 1 view .LVU36
 139 006e 1C48     		ldr	r0, .L21+8
 140              	.LVL13:
  12:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
 141              		.loc 1 12 9 is_stmt 0 view .LVU37
 142 0070 FFF7FEFF 		bl	log_error
 143              	.LVL14:
  13:controller/IO/sensors.c ****     }
 144              		.loc 1 13 9 is_stmt 1 view .LVU38
  13:controller/IO/sensors.c ****     }
 145              		.loc 1 13 16 is_stmt 0 view .LVU39
 146 0074 9FED1B0A 		vldr.32	s0, .L21+12
 147 0078 F8E7     		b	.L1
 148              	.LVL15:
 149              	.L18:
  17:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
 150              		.loc 1 17 9 is_stmt 1 view .LVU40
 151 007a 1B48     		ldr	r0, .L21+16
 152              	.LVL16:
  17:controller/IO/sensors.c ****         return SENSOR_TPS_FAIL_SAFE;
 153              		.loc 1 17 9 is_stmt 0 view .LVU41
 154 007c FFF7FEFF 		bl	log_error
 155              	.LVL17:
  18:controller/IO/sensors.c ****     }
 156              		.loc 1 18 9 is_stmt 1 view .LVU42
  18:controller/IO/sensors.c ****     }
 157              		.loc 1 18 16 is_stmt 0 view .LVU43
 158 0080 9FED180A 		vldr.32	s0, .L21+12
 159 0084 F2E7     		b	.L1
 160              	.LVL18:
 161              	.L5:
  28:controller/IO/sensors.c ****     }
 162              		.loc 1 28 9 is_stmt 1 view .LVU44
  28:controller/IO/sensors.c ****     }
 163              		.loc 1 28 18 is_stmt 0 view .LVU45
 164 0086 F8EE677A 		vcvt.f32.u32	s15, s15
 165              	.LVL19:
  28:controller/IO/sensors.c ****     }
 166              		.loc 1 28 53 view .LVU46
 167 008a 6288     		ldrh	r2, [r4, #2]
  28:controller/IO/sensors.c ****     }
 168              		.loc 1 28 18 view .LVU47
 169 008c 07EE102A 		vmov	s14, r2	@ int
 170 0090 F8EE476A 		vcvt.f32.u32	s13, s14
  28:controller/IO/sensors.c ****     }
 171              		.loc 1 28 95 view .LVU48
 172 0094 2388     		ldrh	r3, [r4]
  28:controller/IO/sensors.c ****     }
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 6


 173              		.loc 1 28 18 view .LVU49
 174 0096 07EE103A 		vmov	s14, r3	@ int
 175 009a B8EE477A 		vcvt.f32.u32	s14, s14
 176              	.LVL20:
 177              	.LBB10:
 178              	.LBI10:
  52:controller/utils/utils.h **** {
 179              		.loc 2 52 21 is_stmt 1 view .LVU50
 180              	.LBB11:
  54:controller/utils/utils.h ****     {
 181              		.loc 2 54 5 view .LVU51
  54:controller/utils/utils.h ****     {
 182              		.loc 2 54 8 is_stmt 0 view .LVU52
 183 009e 9A42     		cmp	r2, r3
 184 00a0 11D0     		beq	.L11
 185              		.loc 2 58 5 is_stmt 1 view .LVU53
 186              		.loc 2 58 15 is_stmt 0 view .LVU54
 187 00a2 77EEE67A 		vsub.f32	s15, s15, s13
 188              	.LVL21:
 189              		.loc 2 58 25 view .LVU55
 190 00a6 9FED0C6A 		vldr.32	s12, .L21
 191 00aa 67EE867A 		vmul.f32	s15, s15, s12
 192              		.loc 2 58 57 view .LVU56
 193 00ae 37EE667A 		vsub.f32	s14, s14, s13
 194              	.LVL22:
 195              		.loc 2 58 47 view .LVU57
 196 00b2 87EE870A 		vdiv.f32	s0, s15, s14
 197              		.loc 2 58 67 view .LVU58
 198 00b6 DFED097A 		vldr.32	s15, .L21+4
 199 00ba 30EE270A 		vadd.f32	s0, s0, s15
 200              	.LVL23:
 201              		.loc 2 58 67 view .LVU59
 202 00be C9E7     		b	.L7
 203              	.LVL24:
 204              	.L10:
 205              		.loc 2 58 67 view .LVU60
 206              	.LBE11:
 207              	.LBE10:
  24:controller/IO/sensors.c ****     }
 208              		.loc 1 24 18 view .LVU61
 209 00c0 9FED060A 		vldr.32	s0, .L21+4
 210 00c4 CBE7     		b	.L6
 211              	.LVL25:
 212              	.L11:
  28:controller/IO/sensors.c ****     }
 213              		.loc 1 28 18 view .LVU62
 214 00c6 9FED050A 		vldr.32	s0, .L21+4
 215 00ca C8E7     		b	.L6
 216              	.LVL26:
 217              	.L19:
  32:controller/IO/sensors.c ****         log_error("tps out of range!");
 218              		.loc 1 32 16 view .LVU63
 219 00cc 9FED050A 		vldr.32	s0, .L21+12
 220              	.LVL27:
  32:controller/IO/sensors.c ****         log_error("tps out of range!");
 221              		.loc 1 32 16 view .LVU64
 222 00d0 CCE7     		b	.L1
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 7


 223              	.LVL28:
 224              	.L20:
  32:controller/IO/sensors.c ****         log_error("tps out of range!");
 225              		.loc 1 32 16 view .LVU65
 226 00d2 9FED040A 		vldr.32	s0, .L21+12
 227 00d6 C9E7     		b	.L1
 228              	.L22:
 229              		.align	2
 230              	.L21:
 231 00d8 0000C842 		.word	1120403456
 232 00dc 00000000 		.word	0
 233 00e0 00000000 		.word	.LC3
 234 00e4 0000C07F 		.word	2143289344
 235 00e8 0C000000 		.word	.LC4
 236              		.cfi_endproc
 237              	.LFE228:
 239              		.section	.rodata.sensor_map_init.str1.4,"aMS",%progbits,1
 240              		.align	2
 241              	.LC5:
 242 0000 6D617020 		.ascii	"map sensor is null\000"
 242      73656E73 
 242      6F722069 
 242      73206E75 
 242      6C6C00
 243 0013 00       		.align	2
 244              	.LC6:
 245 0014 6D617020 		.ascii	"map sensor type not configured!\000"
 245      73656E73 
 245      6F722074 
 245      79706520 
 245      6E6F7420 
 246              		.section	.text.sensor_map_init,"ax",%progbits
 247              		.align	1
 248              		.global	sensor_map_init
 249              		.syntax unified
 250              		.thumb
 251              		.thumb_func
 253              	sensor_map_init:
 254              	.LVL29:
 255              	.LFB229:
  37:controller/IO/sensors.c **** 
  38:controller/IO/sensors.c **** void sensor_map_init(sensor_map_t *sensor, sensor_map_type_t type)
  39:controller/IO/sensors.c **** {
 256              		.loc 1 39 1 is_stmt 1 view -0
 257              		.cfi_startproc
 258              		@ args = 0, pretend = 0, frame = 0
 259              		@ frame_needed = 0, uses_anonymous_args = 0
 260              		.loc 1 39 1 is_stmt 0 view .LVU67
 261 0000 10B5     		push	{r4, lr}
 262              		.cfi_def_cfa_offset 8
 263              		.cfi_offset 4, -8
 264              		.cfi_offset 14, -4
  40:controller/IO/sensors.c ****     if (sensor == NULL)
 265              		.loc 1 40 5 is_stmt 1 view .LVU68
 266              		.loc 1 40 8 is_stmt 0 view .LVU69
 267 0002 68B1     		cbz	r0, .L30
 268 0004 0446     		mov	r4, r0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 8


  41:controller/IO/sensors.c ****     {
  42:controller/IO/sensors.c ****         log_error("map sensor is null");
  43:controller/IO/sensors.c ****         return;
  44:controller/IO/sensors.c ****     }
  45:controller/IO/sensors.c ****     switch (type)
 269              		.loc 1 45 5 is_stmt 1 view .LVU70
 270 0006 79B1     		cbz	r1, .L26
 271 0008 0129     		cmp	r1, #1
 272 000a 15D1     		bne	.L27
  46:controller/IO/sensors.c ****     {
  47:controller/IO/sensors.c ****     case SENSOR_MAP_TYPE_BOSCH_816:
  48:controller/IO/sensors.c ****         /**
  49:controller/IO/sensors.c ****          * a simple linear sensor
  50:controller/IO/sensors.c ****          */
  51:controller/IO/sensors.c ****         /**
  52:controller/IO/sensors.c ****          * @todo actually calculate these values!
  53:controller/IO/sensors.c ****          */
  54:controller/IO/sensors.c ****         sensor->adc_value_0_bar = 100;
 273              		.loc 1 54 9 view .LVU71
 274              		.loc 1 54 33 is_stmt 0 view .LVU72
 275 000c 6423     		movs	r3, #100
 276 000e 0380     		strh	r3, [r0]	@ movhi
  55:controller/IO/sensors.c ****         sensor->adc_value_1_bar = 3000;
 277              		.loc 1 55 9 is_stmt 1 view .LVU73
 278              		.loc 1 55 33 is_stmt 0 view .LVU74
 279 0010 40F6B833 		movw	r3, #3000
 280 0014 4380     		strh	r3, [r0, #2]	@ movhi
  56:controller/IO/sensors.c ****         sensor->analog_channel = ANALOG_INPUT_SENSOR_MAP_PIN;
 281              		.loc 1 56 9 is_stmt 1 view .LVU75
 282              		.loc 1 56 32 is_stmt 0 view .LVU76
 283 0016 0423     		movs	r3, #4
 284 0018 0371     		strb	r3, [r0, #4]
  57:controller/IO/sensors.c ****         break;
 285              		.loc 1 57 9 is_stmt 1 view .LVU77
 286              	.LVL30:
 287              	.L28:
  58:controller/IO/sensors.c ****     case SENSOR_MAP_TYPE_TEST:
  59:controller/IO/sensors.c ****         /**
  60:controller/IO/sensors.c ****          * a simple linear sensor
  61:controller/IO/sensors.c ****          */
  62:controller/IO/sensors.c ****         /**
  63:controller/IO/sensors.c ****          * @todo actually calculate these values!
  64:controller/IO/sensors.c ****          */
  65:controller/IO/sensors.c ****         sensor->adc_value_0_bar = 100;
  66:controller/IO/sensors.c ****         sensor->adc_value_1_bar = 3000;
  67:controller/IO/sensors.c ****         sensor->analog_channel = ANALOG_INPUT_SENSOR_MAP_PIN;
  68:controller/IO/sensors.c ****         break;
  69:controller/IO/sensors.c ****     
  70:controller/IO/sensors.c ****     default:
  71:controller/IO/sensors.c ****         log_error("map sensor type not configured!");
  72:controller/IO/sensors.c ****         break;
  73:controller/IO/sensors.c ****     }
  74:controller/IO/sensors.c ****     map_sensor = sensor;
 288              		.loc 1 74 5 view .LVU78
 289              		.loc 1 74 16 is_stmt 0 view .LVU79
 290 001a 094B     		ldr	r3, .L31
 291 001c 1C60     		str	r4, [r3]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 9


 292              	.LVL31:
 293              	.L23:
  75:controller/IO/sensors.c **** }
 294              		.loc 1 75 1 view .LVU80
 295 001e 10BD     		pop	{r4, pc}
 296              	.LVL32:
 297              	.L30:
  42:controller/IO/sensors.c ****         return;
 298              		.loc 1 42 9 is_stmt 1 view .LVU81
 299 0020 0848     		ldr	r0, .L31+4
 300              	.LVL33:
  42:controller/IO/sensors.c ****         return;
 301              		.loc 1 42 9 is_stmt 0 view .LVU82
 302 0022 FFF7FEFF 		bl	log_error
 303              	.LVL34:
  43:controller/IO/sensors.c ****     }
 304              		.loc 1 43 9 is_stmt 1 view .LVU83
 305 0026 FAE7     		b	.L23
 306              	.LVL35:
 307              	.L26:
  65:controller/IO/sensors.c ****         sensor->adc_value_1_bar = 3000;
 308              		.loc 1 65 9 view .LVU84
  65:controller/IO/sensors.c ****         sensor->adc_value_1_bar = 3000;
 309              		.loc 1 65 33 is_stmt 0 view .LVU85
 310 0028 6423     		movs	r3, #100
 311 002a 0380     		strh	r3, [r0]	@ movhi
  66:controller/IO/sensors.c ****         sensor->analog_channel = ANALOG_INPUT_SENSOR_MAP_PIN;
 312              		.loc 1 66 9 is_stmt 1 view .LVU86
  66:controller/IO/sensors.c ****         sensor->analog_channel = ANALOG_INPUT_SENSOR_MAP_PIN;
 313              		.loc 1 66 33 is_stmt 0 view .LVU87
 314 002c 40F6B833 		movw	r3, #3000
 315 0030 4380     		strh	r3, [r0, #2]	@ movhi
  67:controller/IO/sensors.c ****         break;
 316              		.loc 1 67 9 is_stmt 1 view .LVU88
  67:controller/IO/sensors.c ****         break;
 317              		.loc 1 67 32 is_stmt 0 view .LVU89
 318 0032 0423     		movs	r3, #4
 319 0034 0371     		strb	r3, [r0, #4]
  68:controller/IO/sensors.c ****     
 320              		.loc 1 68 9 is_stmt 1 view .LVU90
 321 0036 F0E7     		b	.L28
 322              	.L27:
  71:controller/IO/sensors.c ****         break;
 323              		.loc 1 71 9 view .LVU91
 324 0038 0348     		ldr	r0, .L31+8
 325              	.LVL36:
  71:controller/IO/sensors.c ****         break;
 326              		.loc 1 71 9 is_stmt 0 view .LVU92
 327 003a FFF7FEFF 		bl	log_error
 328              	.LVL37:
  72:controller/IO/sensors.c ****     }
 329              		.loc 1 72 9 is_stmt 1 view .LVU93
 330 003e ECE7     		b	.L28
 331              	.L32:
 332              		.align	2
 333              	.L31:
 334 0040 00000000 		.word	map_sensor
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 10


 335 0044 00000000 		.word	.LC5
 336 0048 14000000 		.word	.LC6
 337              		.cfi_endproc
 338              	.LFE229:
 340              		.section	.rodata.sensor_map_get.str1.4,"aMS",%progbits,1
 341              		.align	2
 342              	.LC7:
 343 0000 6D617020 		.ascii	"map sensor no init!\000"
 343      73656E73 
 343      6F72206E 
 343      6F20696E 
 343      69742100 
 344              		.align	2
 345              	.LC8:
 346 0014 6D617020 		.ascii	"map sensor out of range!\000"
 346      73656E73 
 346      6F72206F 
 346      7574206F 
 346      66207261 
 347              		.section	.text.sensor_map_get,"ax",%progbits
 348              		.align	1
 349              		.global	sensor_map_get
 350              		.syntax unified
 351              		.thumb
 352              		.thumb_func
 354              	sensor_map_get:
 355              	.LFB230:
  76:controller/IO/sensors.c **** 
  77:controller/IO/sensors.c **** 
  78:controller/IO/sensors.c **** pressure_t sensor_map_get()
  79:controller/IO/sensors.c **** {
 356              		.loc 1 79 1 view -0
 357              		.cfi_startproc
 358              		@ args = 0, pretend = 0, frame = 0
 359              		@ frame_needed = 0, uses_anonymous_args = 0
 360 0000 08B5     		push	{r3, lr}
 361              		.cfi_def_cfa_offset 8
 362              		.cfi_offset 3, -8
 363              		.cfi_offset 14, -4
  80:controller/IO/sensors.c ****     if (map_sensor->adc_value_0_bar == 0 && map_sensor->adc_value_1_bar == 0)
 364              		.loc 1 80 5 view .LVU95
 365              		.loc 1 80 19 is_stmt 0 view .LVU96
 366 0002 224B     		ldr	r3, .L44
 367 0004 1B68     		ldr	r3, [r3]
 368 0006 1A88     		ldrh	r2, [r3]
 369              		.loc 1 80 8 view .LVU97
 370 0008 0AB9     		cbnz	r2, .L34
 371              		.loc 1 80 55 discriminator 1 view .LVU98
 372 000a 5A88     		ldrh	r2, [r3, #2]
 373              		.loc 1 80 42 discriminator 1 view .LVU99
 374 000c 7AB3     		cbz	r2, .L42
 375              	.L34:
  81:controller/IO/sensors.c ****     {
  82:controller/IO/sensors.c ****         log_error("map sensor no init!");
  83:controller/IO/sensors.c ****         return SENSOR_MAP_FAIL_SAFE;
  84:controller/IO/sensors.c ****     }
  85:controller/IO/sensors.c ****     
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 11


  86:controller/IO/sensors.c ****     uint16_t raw_adc_value = 0;
 376              		.loc 1 86 5 is_stmt 1 view .LVU100
 377              	.LVL38:
  87:controller/IO/sensors.c ****     raw_adc_value = analog_inputs_get_data(map_sensor->analog_channel);
 378              		.loc 1 87 5 view .LVU101
 379              		.loc 1 87 21 is_stmt 0 view .LVU102
 380 000e 1879     		ldrb	r0, [r3, #4]	@ zero_extendqisi2
 381 0010 FFF7FEFF 		bl	analog_inputs_get_data
 382              	.LVL39:
 383 0014 07EE900A 		vmov	s15, r0	@ int
 384              	.LVL40:
  88:controller/IO/sensors.c **** 
  89:controller/IO/sensors.c ****     pressure_t result = SENSOR_MAP_FAIL_SAFE;
 385              		.loc 1 89 5 is_stmt 1 view .LVU103
  90:controller/IO/sensors.c **** 
  91:controller/IO/sensors.c ****     result = mapf((float)raw_adc_value, (float)map_sensor->adc_value_0_bar, (float)map_sensor->adc_
 386              		.loc 1 91 5 view .LVU104
 387              		.loc 1 91 14 is_stmt 0 view .LVU105
 388 0018 F8EE677A 		vcvt.f32.u32	s15, s15
 389              	.LVL41:
 390              		.loc 1 91 58 view .LVU106
 391 001c 1B4B     		ldr	r3, .L44
 392 001e 1B68     		ldr	r3, [r3]
 393 0020 1A88     		ldrh	r2, [r3]
 394              		.loc 1 91 14 view .LVU107
 395 0022 07EE102A 		vmov	s14, r2	@ int
 396 0026 F8EE476A 		vcvt.f32.u32	s13, s14
 397              		.loc 1 91 94 view .LVU108
 398 002a 5B88     		ldrh	r3, [r3, #2]
 399              		.loc 1 91 14 view .LVU109
 400 002c 07EE103A 		vmov	s14, r3	@ int
 401 0030 B8EE477A 		vcvt.f32.u32	s14, s14
 402              	.LVL42:
 403              	.LBB12:
 404              	.LBI12:
  52:controller/utils/utils.h **** {
 405              		.loc 2 52 21 is_stmt 1 view .LVU110
 406              	.LBB13:
  54:controller/utils/utils.h ****     {
 407              		.loc 2 54 5 view .LVU111
  54:controller/utils/utils.h ****     {
 408              		.loc 2 54 8 is_stmt 0 view .LVU112
 409 0034 9A42     		cmp	r2, r3
 410 0036 20D0     		beq	.L39
 411              		.loc 2 58 5 is_stmt 1 view .LVU113
 412              		.loc 2 58 15 is_stmt 0 view .LVU114
 413 0038 77EEE67A 		vsub.f32	s15, s15, s13
 414              	.LVL43:
 415              		.loc 2 58 25 view .LVU115
 416 003c 9FED146A 		vldr.32	s12, .L44+4
 417 0040 67EE867A 		vmul.f32	s15, s15, s12
 418              		.loc 2 58 57 view .LVU116
 419 0044 37EE667A 		vsub.f32	s14, s14, s13
 420              	.LVL44:
 421              		.loc 2 58 47 view .LVU117
 422 0048 87EE870A 		vdiv.f32	s0, s15, s14
 423              		.loc 2 58 67 view .LVU118
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 12


 424 004c DFED117A 		vldr.32	s15, .L44+8
 425 0050 30EE270A 		vadd.f32	s0, s0, s15
 426              	.LVL45:
 427              		.loc 2 58 67 view .LVU119
 428              	.LBE13:
 429              	.LBE12:
  92:controller/IO/sensors.c **** 
  93:controller/IO/sensors.c ****     if (IS_IN_RANGE(result, (pressure_t)0, FIRMWARE_LIMIT_MAX_MAP))
 430              		.loc 1 93 5 is_stmt 1 view .LVU120
 431              		.loc 1 93 8 is_stmt 0 view .LVU121
 432 0054 B4EEE70A 		vcmpe.f32	s0, s15
 433 0058 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 434 005c 06DB     		blt	.L33
 435              	.LVL46:
 436              	.L36:
 437              		.loc 1 93 9 discriminator 1 view .LVU122
 438 005e DFED0E7A 		vldr.32	s15, .L44+12
 439 0062 B4EEE70A 		vcmpe.f32	s0, s15
 440 0066 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 441 006a 09D9     		bls	.L43
 442              	.LVL47:
 443              	.L33:
  94:controller/IO/sensors.c ****     {
  95:controller/IO/sensors.c ****         log_error("map sensor out of range!");
  96:controller/IO/sensors.c ****         return SENSOR_MAP_FAIL_SAFE;
  97:controller/IO/sensors.c ****     }
  98:controller/IO/sensors.c ****     return result;
  99:controller/IO/sensors.c **** }
 444              		.loc 1 99 1 view .LVU123
 445 006c 08BD     		pop	{r3, pc}
 446              	.L42:
  82:controller/IO/sensors.c ****         return SENSOR_MAP_FAIL_SAFE;
 447              		.loc 1 82 9 is_stmt 1 view .LVU124
 448 006e 0B48     		ldr	r0, .L44+16
 449 0070 FFF7FEFF 		bl	log_error
 450              	.LVL48:
  83:controller/IO/sensors.c ****     }
 451              		.loc 1 83 9 view .LVU125
  83:controller/IO/sensors.c ****     }
 452              		.loc 1 83 16 is_stmt 0 view .LVU126
 453 0074 9FED070A 		vldr.32	s0, .L44+8
 454 0078 F8E7     		b	.L33
 455              	.LVL49:
 456              	.L39:
 457              	.LBB15:
 458              	.LBB14:
  56:controller/utils/utils.h ****     }
 459              		.loc 2 56 16 view .LVU127
 460 007a 9FED060A 		vldr.32	s0, .L44+8
 461 007e EEE7     		b	.L36
 462              	.LVL50:
 463              	.L43:
  56:controller/utils/utils.h ****     }
 464              		.loc 2 56 16 view .LVU128
 465              	.LBE14:
 466              	.LBE15:
  95:controller/IO/sensors.c ****         return SENSOR_MAP_FAIL_SAFE;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 13


 467              		.loc 1 95 9 is_stmt 1 view .LVU129
 468 0080 0748     		ldr	r0, .L44+20
 469 0082 FFF7FEFF 		bl	log_error
 470              	.LVL51:
  96:controller/IO/sensors.c ****     }
 471              		.loc 1 96 9 view .LVU130
  96:controller/IO/sensors.c ****     }
 472              		.loc 1 96 16 is_stmt 0 view .LVU131
 473 0086 9FED030A 		vldr.32	s0, .L44+8
 474 008a EFE7     		b	.L33
 475              	.L45:
 476              		.align	2
 477              	.L44:
 478 008c 00000000 		.word	map_sensor
 479 0090 0000C842 		.word	1120403456
 480 0094 00000000 		.word	0
 481 0098 0000F042 		.word	1123024896
 482 009c 00000000 		.word	.LC7
 483 00a0 14000000 		.word	.LC8
 484              		.cfi_endproc
 485              	.LFE230:
 487              		.section	.rodata.sensor_iat_init.str1.4,"aMS",%progbits,1
 488              		.align	2
 489              	.LC9:
 490 0000 69617420 		.ascii	"iat sensor type not configured!\000"
 490      73656E73 
 490      6F722074 
 490      79706520 
 490      6E6F7420 
 491              		.section	.text.sensor_iat_init,"ax",%progbits
 492              		.align	1
 493              		.global	sensor_iat_init
 494              		.syntax unified
 495              		.thumb
 496              		.thumb_func
 498              	sensor_iat_init:
 499              	.LVL52:
 500              	.LFB231:
 100:controller/IO/sensors.c **** 
 101:controller/IO/sensors.c **** void sensor_iat_init(thermistor_t *sensor, sensor_iat_type_t type)
 102:controller/IO/sensors.c **** {
 501              		.loc 1 102 1 is_stmt 1 view -0
 502              		.cfi_startproc
 503              		@ args = 0, pretend = 0, frame = 24
 504              		@ frame_needed = 0, uses_anonymous_args = 0
 505              		.loc 1 102 1 is_stmt 0 view .LVU133
 506 0000 70B5     		push	{r4, r5, r6, lr}
 507              		.cfi_def_cfa_offset 16
 508              		.cfi_offset 4, -16
 509              		.cfi_offset 5, -12
 510              		.cfi_offset 6, -8
 511              		.cfi_offset 14, -4
 512 0002 8AB0     		sub	sp, sp, #40
 513              		.cfi_def_cfa_offset 56
 514 0004 0446     		mov	r4, r0
 103:controller/IO/sensors.c ****     switch (type)
 515              		.loc 1 103 5 is_stmt 1 view .LVU134
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 14


 516 0006 E9B1     		cbz	r1, .L47
 517 0008 0129     		cmp	r1, #1
 518 000a 38D1     		bne	.L48
 519              	.LBB16:
 104:controller/IO/sensors.c ****     {
 105:controller/IO/sensors.c ****         case SENSOR_IAT_TYPE_BOSCH_816:
 106:controller/IO/sensors.c ****             resistor_init(&sensor->resistor, 10000, RESISTOR_PULL_UP, ANALOG_INPUT_SENSOR_IAT_PIN);
 520              		.loc 1 106 13 view .LVU135
 521 000c 0522     		movs	r2, #5
 522 000e 0021     		movs	r1, #0
 523              	.LVL53:
 524              		.loc 1 106 13 is_stmt 0 view .LVU136
 525 0010 9FED1D0A 		vldr.32	s0, .L51
 526 0014 FFF7FEFF 		bl	resistor_init
 527              	.LVL54:
 107:controller/IO/sensors.c ****             thermistor_conf_t bosch_816_iat_conf = 
 528              		.loc 1 107 13 is_stmt 1 view .LVU137
 529              		.loc 1 107 31 is_stmt 0 view .LVU138
 530 0018 04AD     		add	r5, sp, #16
 531 001a 1C4E     		ldr	r6, .L51+4
 532 001c 0FCE     		ldmia	r6!, {r0, r1, r2, r3}
 533 001e 0FC5     		stmia	r5!, {r0, r1, r2, r3}
 534 0020 96E80300 		ldm	r6, {r0, r1}
 535 0024 85E80300 		stm	r5, {r0, r1}
 108:controller/IO/sensors.c ****             {
 109:controller/IO/sensors.c ****                 .resistance_1 = 9395.0f,
 110:controller/IO/sensors.c ****                 .resistance_2 = 2056.0f,
 111:controller/IO/sensors.c ****                 .resistance_3 = 322.5f,
 112:controller/IO/sensors.c ****                 .tempC_1 = -10.0f,
 113:controller/IO/sensors.c ****                 .tempC_2 = 25.0f,
 114:controller/IO/sensors.c ****                 .tempC_3 = 80.0f
 115:controller/IO/sensors.c ****             };
 116:controller/IO/sensors.c ****             thermistor_init(sensor, bosch_816_iat_conf);
 536              		.loc 1 116 13 is_stmt 1 view .LVU139
 537 0028 0AAB     		add	r3, sp, #40
 538 002a 13E90700 		ldmdb	r3, {r0, r1, r2}
 539 002e 8DE80700 		stm	sp, {r0, r1, r2}
 540 0032 04AB     		add	r3, sp, #16
 541 0034 0ECB     		ldm	r3, {r1, r2, r3}
 542 0036 2046     		mov	r0, r4
 543 0038 FFF7FEFF 		bl	thermistor_init
 544              	.LVL55:
 117:controller/IO/sensors.c ****             sensor_iat = sensor;
 545              		.loc 1 117 13 view .LVU140
 546              		.loc 1 117 24 is_stmt 0 view .LVU141
 547 003c 144B     		ldr	r3, .L51+8
 548 003e 1C60     		str	r4, [r3]
 118:controller/IO/sensors.c ****             break;
 549              		.loc 1 118 13 is_stmt 1 view .LVU142
 550              	.L46:
 551              		.loc 1 118 13 is_stmt 0 view .LVU143
 552              	.LBE16:
 119:controller/IO/sensors.c ****         case SENSOR_IAT_TYPE_TEST:
 120:controller/IO/sensors.c ****             resistor_init(&sensor->resistor, 4700, RESISTOR_PULL_UP, ANALOG_INPUT_SENSOR_IAT_PIN);
 121:controller/IO/sensors.c ****             thermistor_conf_t genric_5k =
 122:controller/IO/sensors.c ****             {
 123:controller/IO/sensors.c ****                 .resistance_1 = 22.263e3f,
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 15


 124:controller/IO/sensors.c ****                 .resistance_2 = 5e3f,
 125:controller/IO/sensors.c ****                 .resistance_3 = 588.0f,
 126:controller/IO/sensors.c ****                 .tempC_1 = -10.0f,
 127:controller/IO/sensors.c ****                 .tempC_2 = 25.0f,
 128:controller/IO/sensors.c ****                 .tempC_3 = 90.0f
 129:controller/IO/sensors.c ****             };
 130:controller/IO/sensors.c ****             thermistor_init(sensor, genric_5k);
 131:controller/IO/sensors.c ****             sensor_iat = sensor;
 132:controller/IO/sensors.c ****             break;
 133:controller/IO/sensors.c ****     default:
 134:controller/IO/sensors.c ****         log_error("iat sensor type not configured!");
 135:controller/IO/sensors.c ****         break;
 136:controller/IO/sensors.c ****     }
 137:controller/IO/sensors.c **** }
 553              		.loc 1 137 1 view .LVU144
 554 0040 0AB0     		add	sp, sp, #40
 555              		.cfi_remember_state
 556              		.cfi_def_cfa_offset 16
 557              		@ sp needed
 558 0042 70BD     		pop	{r4, r5, r6, pc}
 559              	.LVL56:
 560              	.L47:
 561              		.cfi_restore_state
 562              	.LBB17:
 120:controller/IO/sensors.c ****             thermistor_conf_t genric_5k =
 563              		.loc 1 120 13 is_stmt 1 view .LVU145
 564 0044 0522     		movs	r2, #5
 565 0046 0021     		movs	r1, #0
 566              	.LVL57:
 120:controller/IO/sensors.c ****             thermistor_conf_t genric_5k =
 567              		.loc 1 120 13 is_stmt 0 view .LVU146
 568 0048 9FED120A 		vldr.32	s0, .L51+12
 569 004c FFF7FEFF 		bl	resistor_init
 570              	.LVL58:
 121:controller/IO/sensors.c ****             {
 571              		.loc 1 121 13 is_stmt 1 view .LVU147
 121:controller/IO/sensors.c ****             {
 572              		.loc 1 121 31 is_stmt 0 view .LVU148
 573 0050 0DF1100C 		add	ip, sp, #16
 574 0054 104D     		ldr	r5, .L51+16
 575 0056 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 576 0058 ACE80F00 		stmia	ip!, {r0, r1, r2, r3}
 577 005c 95E80300 		ldm	r5, {r0, r1}
 578 0060 8CE80300 		stm	ip, {r0, r1}
 130:controller/IO/sensors.c ****             sensor_iat = sensor;
 579              		.loc 1 130 13 is_stmt 1 view .LVU149
 580 0064 0AAB     		add	r3, sp, #40
 581 0066 13E90700 		ldmdb	r3, {r0, r1, r2}
 582 006a 8DE80700 		stm	sp, {r0, r1, r2}
 583 006e 04AB     		add	r3, sp, #16
 584 0070 0ECB     		ldm	r3, {r1, r2, r3}
 585 0072 2046     		mov	r0, r4
 586 0074 FFF7FEFF 		bl	thermistor_init
 587              	.LVL59:
 131:controller/IO/sensors.c ****             break;
 588              		.loc 1 131 13 view .LVU150
 131:controller/IO/sensors.c ****             break;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 16


 589              		.loc 1 131 24 is_stmt 0 view .LVU151
 590 0078 054B     		ldr	r3, .L51+8
 591 007a 1C60     		str	r4, [r3]
 132:controller/IO/sensors.c ****     default:
 592              		.loc 1 132 13 is_stmt 1 view .LVU152
 593 007c E0E7     		b	.L46
 594              	.LVL60:
 595              	.L48:
 134:controller/IO/sensors.c ****         break;
 596              		.loc 1 134 9 view .LVU153
 597 007e 0748     		ldr	r0, .L51+20
 598              	.LVL61:
 134:controller/IO/sensors.c ****         break;
 599              		.loc 1 134 9 is_stmt 0 view .LVU154
 600 0080 FFF7FEFF 		bl	log_error
 601              	.LVL62:
 135:controller/IO/sensors.c ****     }
 602              		.loc 1 135 9 is_stmt 1 view .LVU155
 603              	.LBE17:
 604              		.loc 1 137 1 is_stmt 0 view .LVU156
 605 0084 DCE7     		b	.L46
 606              	.L52:
 607 0086 00BF     		.align	2
 608              	.L51:
 609 0088 00401C46 		.word	1176256512
 610 008c 00000000 		.word	.LANCHOR0
 611 0090 00000000 		.word	sensor_iat
 612 0094 00E09245 		.word	1167253504
 613 0098 18000000 		.word	.LANCHOR0+24
 614 009c 00000000 		.word	.LC9
 615              		.cfi_endproc
 616              	.LFE231:
 618              		.section	.rodata.sensor_iat_get.str1.4,"aMS",%progbits,1
 619              		.align	2
 620              	.LC10:
 621 0000 69617420 		.ascii	"iat sensor is null\000"
 621      73656E73 
 621      6F722069 
 621      73206E75 
 621      6C6C00
 622 0013 00       		.align	2
 623              	.LC11:
 624 0014 69617420 		.ascii	"iat sensor out of range!\000"
 624      73656E73 
 624      6F72206F 
 624      7574206F 
 624      66207261 
 625              		.section	.text.sensor_iat_get,"ax",%progbits
 626              		.align	1
 627              		.global	sensor_iat_get
 628              		.syntax unified
 629              		.thumb
 630              		.thumb_func
 632              	sensor_iat_get:
 633              	.LFB232:
 138:controller/IO/sensors.c **** 
 139:controller/IO/sensors.c **** temperature_t sensor_iat_get()
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 17


 140:controller/IO/sensors.c **** {
 634              		.loc 1 140 1 is_stmt 1 view -0
 635              		.cfi_startproc
 636              		@ args = 0, pretend = 0, frame = 0
 637              		@ frame_needed = 0, uses_anonymous_args = 0
 638 0000 08B5     		push	{r3, lr}
 639              		.cfi_def_cfa_offset 8
 640              		.cfi_offset 3, -8
 641              		.cfi_offset 14, -4
 141:controller/IO/sensors.c ****     if (sensor_iat == NULL)
 642              		.loc 1 141 5 view .LVU158
 643              		.loc 1 141 20 is_stmt 0 view .LVU159
 644 0002 104B     		ldr	r3, .L61
 645 0004 1868     		ldr	r0, [r3]
 646              		.loc 1 141 8 view .LVU160
 647 0006 80B1     		cbz	r0, .L60
 142:controller/IO/sensors.c ****     {
 143:controller/IO/sensors.c ****         log_error("iat sensor is null");
 144:controller/IO/sensors.c ****         return SENSOR_IAT_FAIL_SAFE;
 145:controller/IO/sensors.c ****     }
 146:controller/IO/sensors.c ****     temperature_t temperature = thermistor_get_temp(sensor_iat);
 648              		.loc 1 146 5 is_stmt 1 view .LVU161
 649              		.loc 1 146 33 is_stmt 0 view .LVU162
 650 0008 FFF7FEFF 		bl	thermistor_get_temp
 651              	.LVL63:
 147:controller/IO/sensors.c ****     if (!IS_IN_RANGE(temperature, FIRMWARE_LIMIT_MIN_TEMP, FIRMWARE_LIMIT_MAX_TEMP))
 652              		.loc 1 147 5 is_stmt 1 view .LVU163
 653              		.loc 1 147 8 is_stmt 0 view .LVU164
 654 000c DFED0E7A 		vldr.32	s15, .L61+4
 655 0010 B4EEE70A 		vcmpe.f32	s0, s15
 656 0014 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 657 0018 0DDB     		blt	.L56
 658              		.loc 1 147 9 discriminator 1 view .LVU165
 659 001a DFED0C7A 		vldr.32	s15, .L61+8
 660 001e B4EEE70A 		vcmpe.f32	s0, s15
 661 0022 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 662 0026 06D8     		bhi	.L56
 663              	.LVL64:
 664              	.L53:
 148:controller/IO/sensors.c ****     {
 149:controller/IO/sensors.c ****         log_error("iat sensor out of range!");
 150:controller/IO/sensors.c ****         return SENSOR_IAT_FAIL_SAFE;
 151:controller/IO/sensors.c ****     }
 152:controller/IO/sensors.c ****     return temperature;
 153:controller/IO/sensors.c **** }
 665              		.loc 1 153 1 view .LVU166
 666 0028 08BD     		pop	{r3, pc}
 667              	.L60:
 143:controller/IO/sensors.c ****         return SENSOR_IAT_FAIL_SAFE;
 668              		.loc 1 143 9 is_stmt 1 view .LVU167
 669 002a 0948     		ldr	r0, .L61+12
 670 002c FFF7FEFF 		bl	log_error
 671              	.LVL65:
 144:controller/IO/sensors.c ****     }
 672              		.loc 1 144 9 view .LVU168
 144:controller/IO/sensors.c ****     }
 673              		.loc 1 144 16 is_stmt 0 view .LVU169
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 18


 674 0030 9FED080A 		vldr.32	s0, .L61+16
 675 0034 F8E7     		b	.L53
 676              	.LVL66:
 677              	.L56:
 149:controller/IO/sensors.c ****         return SENSOR_IAT_FAIL_SAFE;
 678              		.loc 1 149 9 is_stmt 1 view .LVU170
 679 0036 0848     		ldr	r0, .L61+20
 680 0038 FFF7FEFF 		bl	log_error
 681              	.LVL67:
 150:controller/IO/sensors.c ****     }
 682              		.loc 1 150 9 view .LVU171
 150:controller/IO/sensors.c ****     }
 683              		.loc 1 150 16 is_stmt 0 view .LVU172
 684 003c 9FED050A 		vldr.32	s0, .L61+16
 685 0040 F2E7     		b	.L53
 686              	.L62:
 687 0042 00BF     		.align	2
 688              	.L61:
 689 0044 00000000 		.word	sensor_iat
 690 0048 000048C2 		.word	-1035468800
 691 004c 00001643 		.word	1125515264
 692 0050 00000000 		.word	.LC10
 693 0054 00002042 		.word	1109393408
 694 0058 14000000 		.word	.LC11
 695              		.cfi_endproc
 696              	.LFE232:
 698              		.section	.rodata.sensor_clt_init.str1.4,"aMS",%progbits,1
 699              		.align	2
 700              	.LC12:
 701 0000 636C7420 		.ascii	"clt sensor is null\000"
 701      73656E73 
 701      6F722069 
 701      73206E75 
 701      6C6C00
 702 0013 00       		.align	2
 703              	.LC13:
 704 0014 636C7420 		.ascii	"clt sensor type not configured!\000"
 704      73656E73 
 704      6F722074 
 704      79706520 
 704      6E6F7420 
 705              		.section	.text.sensor_clt_init,"ax",%progbits
 706              		.align	1
 707              		.global	sensor_clt_init
 708              		.syntax unified
 709              		.thumb
 710              		.thumb_func
 712              	sensor_clt_init:
 713              	.LVL68:
 714              	.LFB233:
 154:controller/IO/sensors.c **** 
 155:controller/IO/sensors.c **** void sensor_clt_init(thermistor_t *sensor, sensor_clt_type_t type)
 156:controller/IO/sensors.c **** {
 715              		.loc 1 156 1 is_stmt 1 view -0
 716              		.cfi_startproc
 717              		@ args = 0, pretend = 0, frame = 24
 718              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 19


 719              		.loc 1 156 1 is_stmt 0 view .LVU174
 720 0000 70B5     		push	{r4, r5, r6, lr}
 721              		.cfi_def_cfa_offset 16
 722              		.cfi_offset 4, -16
 723              		.cfi_offset 5, -12
 724              		.cfi_offset 6, -8
 725              		.cfi_offset 14, -4
 726 0002 8AB0     		sub	sp, sp, #40
 727              		.cfi_def_cfa_offset 56
 157:controller/IO/sensors.c ****     if (sensor == NULL)
 728              		.loc 1 157 5 is_stmt 1 view .LVU175
 729              		.loc 1 157 8 is_stmt 0 view .LVU176
 730 0004 F8B1     		cbz	r0, .L70
 731 0006 0446     		mov	r4, r0
 158:controller/IO/sensors.c ****     {
 159:controller/IO/sensors.c ****         log_error("clt sensor is null");
 160:controller/IO/sensors.c ****         return;
 161:controller/IO/sensors.c ****     }
 162:controller/IO/sensors.c ****     switch (type)
 732              		.loc 1 162 5 is_stmt 1 view .LVU177
 733 0008 09B3     		cbz	r1, .L66
 734 000a 0129     		cmp	r1, #1
 735 000c 3CD1     		bne	.L67
 736              	.LBB18:
 163:controller/IO/sensors.c ****     {
 164:controller/IO/sensors.c ****     /* Actually make this a proper thing */
 165:controller/IO/sensors.c ****     case SENSOR_CLT_TYPE_NISSAN:
 166:controller/IO/sensors.c ****         resistor_init(&sensor->resistor, 10000, RESISTOR_PULL_UP, ANALOG_INPUT_SENSOR_CLT_PIN);
 737              		.loc 1 166 9 view .LVU178
 738 000e 0622     		movs	r2, #6
 739 0010 0021     		movs	r1, #0
 740              	.LVL69:
 741              		.loc 1 166 9 is_stmt 0 view .LVU179
 742 0012 9FED1F0A 		vldr.32	s0, .L71
 743 0016 FFF7FEFF 		bl	resistor_init
 744              	.LVL70:
 167:controller/IO/sensors.c ****         thermistor_conf_t nissan_clt_conf =
 745              		.loc 1 167 9 is_stmt 1 view .LVU180
 746              		.loc 1 167 27 is_stmt 0 view .LVU181
 747 001a 04AD     		add	r5, sp, #16
 748 001c 1D4E     		ldr	r6, .L71+4
 749 001e 0FCE     		ldmia	r6!, {r0, r1, r2, r3}
 750 0020 0FC5     		stmia	r5!, {r0, r1, r2, r3}
 751 0022 96E80300 		ldm	r6, {r0, r1}
 752 0026 85E80300 		stm	r5, {r0, r1}
 168:controller/IO/sensors.c ****         {
 169:controller/IO/sensors.c ****             .resistance_1 = 15700.0f,
 170:controller/IO/sensors.c ****             .resistance_2 = 2050.0f,
 171:controller/IO/sensors.c ****             .resistance_3 = 230.0f,
 172:controller/IO/sensors.c ****             .tempC_1 = -20.0f,
 173:controller/IO/sensors.c ****             .tempC_2 = 25.0f,
 174:controller/IO/sensors.c ****             .tempC_3 = 90.0f
 175:controller/IO/sensors.c ****         };
 176:controller/IO/sensors.c ****         thermistor_init(sensor, nissan_clt_conf);
 753              		.loc 1 176 9 is_stmt 1 view .LVU182
 754 002a 0AAB     		add	r3, sp, #40
 755 002c 13E90700 		ldmdb	r3, {r0, r1, r2}
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 20


 756 0030 8DE80700 		stm	sp, {r0, r1, r2}
 757 0034 04AB     		add	r3, sp, #16
 758 0036 0ECB     		ldm	r3, {r1, r2, r3}
 759 0038 2046     		mov	r0, r4
 760 003a FFF7FEFF 		bl	thermistor_init
 761              	.LVL71:
 177:controller/IO/sensors.c ****         sensor_clt = sensor;
 762              		.loc 1 177 9 view .LVU183
 763              		.loc 1 177 20 is_stmt 0 view .LVU184
 764 003e 164B     		ldr	r3, .L71+8
 765 0040 1C60     		str	r4, [r3]
 178:controller/IO/sensors.c ****         break;
 766              		.loc 1 178 9 is_stmt 1 view .LVU185
 767              	.LVL72:
 768              	.L63:
 769              		.loc 1 178 9 is_stmt 0 view .LVU186
 770              	.LBE18:
 179:controller/IO/sensors.c ****     case SENSOR_CLT_TYPE_TEST:
 180:controller/IO/sensors.c ****         resistor_init(&sensor->resistor, 4700, RESISTOR_PULL_UP, ANALOG_INPUT_SENSOR_CLT_PIN);
 181:controller/IO/sensors.c ****         thermistor_conf_t genric_5k =
 182:controller/IO/sensors.c ****         {
 183:controller/IO/sensors.c ****             .resistance_1 = 22.263e3f,
 184:controller/IO/sensors.c ****             .resistance_2 = 5e3f,
 185:controller/IO/sensors.c ****             .resistance_3 = 588.0f,
 186:controller/IO/sensors.c ****             .tempC_1 = -10.0f,
 187:controller/IO/sensors.c ****             .tempC_2 = 25.0f,
 188:controller/IO/sensors.c ****             .tempC_3 = 90.0f
 189:controller/IO/sensors.c ****         };
 190:controller/IO/sensors.c ****         thermistor_init(sensor, genric_5k);
 191:controller/IO/sensors.c ****         sensor_clt = sensor;
 192:controller/IO/sensors.c ****         break;
 193:controller/IO/sensors.c ****     default:
 194:controller/IO/sensors.c ****         log_error("clt sensor type not configured!");
 195:controller/IO/sensors.c ****         break;
 196:controller/IO/sensors.c ****     }
 197:controller/IO/sensors.c **** }
 771              		.loc 1 197 1 view .LVU187
 772 0042 0AB0     		add	sp, sp, #40
 773              		.cfi_remember_state
 774              		.cfi_def_cfa_offset 16
 775              		@ sp needed
 776 0044 70BD     		pop	{r4, r5, r6, pc}
 777              	.LVL73:
 778              	.L70:
 779              		.cfi_restore_state
 159:controller/IO/sensors.c ****         return;
 780              		.loc 1 159 9 is_stmt 1 view .LVU188
 781 0046 1548     		ldr	r0, .L71+12
 782              	.LVL74:
 159:controller/IO/sensors.c ****         return;
 783              		.loc 1 159 9 is_stmt 0 view .LVU189
 784 0048 FFF7FEFF 		bl	log_error
 785              	.LVL75:
 160:controller/IO/sensors.c ****     }
 786              		.loc 1 160 9 is_stmt 1 view .LVU190
 787 004c F9E7     		b	.L63
 788              	.LVL76:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 21


 789              	.L66:
 790              	.LBB19:
 180:controller/IO/sensors.c ****         thermistor_conf_t genric_5k =
 791              		.loc 1 180 9 view .LVU191
 792 004e 0622     		movs	r2, #6
 793 0050 0021     		movs	r1, #0
 794              	.LVL77:
 180:controller/IO/sensors.c ****         thermistor_conf_t genric_5k =
 795              		.loc 1 180 9 is_stmt 0 view .LVU192
 796 0052 9FED130A 		vldr.32	s0, .L71+16
 797 0056 FFF7FEFF 		bl	resistor_init
 798              	.LVL78:
 181:controller/IO/sensors.c ****         {
 799              		.loc 1 181 9 is_stmt 1 view .LVU193
 181:controller/IO/sensors.c ****         {
 800              		.loc 1 181 27 is_stmt 0 view .LVU194
 801 005a 0DF1100C 		add	ip, sp, #16
 802 005e 114D     		ldr	r5, .L71+20
 803 0060 0FCD     		ldmia	r5!, {r0, r1, r2, r3}
 804 0062 ACE80F00 		stmia	ip!, {r0, r1, r2, r3}
 805 0066 95E80300 		ldm	r5, {r0, r1}
 806 006a 8CE80300 		stm	ip, {r0, r1}
 190:controller/IO/sensors.c ****         sensor_clt = sensor;
 807              		.loc 1 190 9 is_stmt 1 view .LVU195
 808 006e 0AAB     		add	r3, sp, #40
 809 0070 13E90700 		ldmdb	r3, {r0, r1, r2}
 810 0074 8DE80700 		stm	sp, {r0, r1, r2}
 811 0078 04AB     		add	r3, sp, #16
 812 007a 0ECB     		ldm	r3, {r1, r2, r3}
 813 007c 2046     		mov	r0, r4
 814 007e FFF7FEFF 		bl	thermistor_init
 815              	.LVL79:
 191:controller/IO/sensors.c ****         break;
 816              		.loc 1 191 9 view .LVU196
 191:controller/IO/sensors.c ****         break;
 817              		.loc 1 191 20 is_stmt 0 view .LVU197
 818 0082 054B     		ldr	r3, .L71+8
 819 0084 1C60     		str	r4, [r3]
 192:controller/IO/sensors.c ****     default:
 820              		.loc 1 192 9 is_stmt 1 view .LVU198
 821 0086 DCE7     		b	.L63
 822              	.LVL80:
 823              	.L67:
 194:controller/IO/sensors.c ****         break;
 824              		.loc 1 194 9 view .LVU199
 825 0088 0748     		ldr	r0, .L71+24
 826              	.LVL81:
 194:controller/IO/sensors.c ****         break;
 827              		.loc 1 194 9 is_stmt 0 view .LVU200
 828 008a FFF7FEFF 		bl	log_error
 829              	.LVL82:
 195:controller/IO/sensors.c ****     }
 830              		.loc 1 195 9 is_stmt 1 view .LVU201
 831 008e D8E7     		b	.L63
 832              	.L72:
 833              		.align	2
 834              	.L71:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 22


 835 0090 00401C46 		.word	1176256512
 836 0094 30000000 		.word	.LANCHOR0+48
 837 0098 00000000 		.word	sensor_clt
 838 009c 00000000 		.word	.LC12
 839 00a0 00E09245 		.word	1167253504
 840 00a4 18000000 		.word	.LANCHOR0+24
 841 00a8 14000000 		.word	.LC13
 842              	.LBE19:
 843              		.cfi_endproc
 844              	.LFE233:
 846              		.section	.rodata.sensor_clt_get.str1.4,"aMS",%progbits,1
 847              		.align	2
 848              	.LC14:
 849 0000 636C7420 		.ascii	"clt sensor out of range!\000"
 849      73656E73 
 849      6F72206F 
 849      7574206F 
 849      66207261 
 850              		.section	.text.sensor_clt_get,"ax",%progbits
 851              		.align	1
 852              		.global	sensor_clt_get
 853              		.syntax unified
 854              		.thumb
 855              		.thumb_func
 857              	sensor_clt_get:
 858              	.LFB234:
 198:controller/IO/sensors.c **** 
 199:controller/IO/sensors.c **** temperature_t sensor_clt_get()
 200:controller/IO/sensors.c **** {
 859              		.loc 1 200 1 view -0
 860              		.cfi_startproc
 861              		@ args = 0, pretend = 0, frame = 0
 862              		@ frame_needed = 0, uses_anonymous_args = 0
 863 0000 08B5     		push	{r3, lr}
 864              		.cfi_def_cfa_offset 8
 865              		.cfi_offset 3, -8
 866              		.cfi_offset 14, -4
 201:controller/IO/sensors.c ****     if (sensor_clt == NULL)
 867              		.loc 1 201 5 view .LVU203
 868              		.loc 1 201 20 is_stmt 0 view .LVU204
 869 0002 104B     		ldr	r3, .L81
 870 0004 1868     		ldr	r0, [r3]
 871              		.loc 1 201 8 view .LVU205
 872 0006 80B1     		cbz	r0, .L80
 202:controller/IO/sensors.c ****     {
 203:controller/IO/sensors.c ****         log_error("clt sensor is null");
 204:controller/IO/sensors.c ****         return SENSOR_CLT_FAIL_SAFE;
 205:controller/IO/sensors.c ****     }
 206:controller/IO/sensors.c ****     temperature_t temperature = thermistor_get_temp(sensor_clt);
 873              		.loc 1 206 5 is_stmt 1 view .LVU206
 874              		.loc 1 206 33 is_stmt 0 view .LVU207
 875 0008 FFF7FEFF 		bl	thermistor_get_temp
 876              	.LVL83:
 207:controller/IO/sensors.c ****     if (!IS_IN_RANGE(temperature, FIRMWARE_LIMIT_MIN_TEMP, FIRMWARE_LIMIT_MAX_TEMP))
 877              		.loc 1 207 5 is_stmt 1 view .LVU208
 878              		.loc 1 207 8 is_stmt 0 view .LVU209
 879 000c DFED0E7A 		vldr.32	s15, .L81+4
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 23


 880 0010 B4EEE70A 		vcmpe.f32	s0, s15
 881 0014 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 882 0018 0DDB     		blt	.L76
 883              		.loc 1 207 9 discriminator 1 view .LVU210
 884 001a DFED0C7A 		vldr.32	s15, .L81+8
 885 001e B4EEE70A 		vcmpe.f32	s0, s15
 886 0022 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 887 0026 06D8     		bhi	.L76
 888              	.LVL84:
 889              	.L73:
 208:controller/IO/sensors.c ****     {
 209:controller/IO/sensors.c ****         log_error("clt sensor out of range!");
 210:controller/IO/sensors.c ****         return SENSOR_CLT_FAIL_SAFE;
 211:controller/IO/sensors.c ****     }
 212:controller/IO/sensors.c ****     return temperature;
 213:controller/IO/sensors.c **** }
 890              		.loc 1 213 1 view .LVU211
 891 0028 08BD     		pop	{r3, pc}
 892              	.L80:
 203:controller/IO/sensors.c ****         return SENSOR_CLT_FAIL_SAFE;
 893              		.loc 1 203 9 is_stmt 1 view .LVU212
 894 002a 0948     		ldr	r0, .L81+12
 895 002c FFF7FEFF 		bl	log_error
 896              	.LVL85:
 204:controller/IO/sensors.c ****     }
 897              		.loc 1 204 9 view .LVU213
 204:controller/IO/sensors.c ****     }
 898              		.loc 1 204 16 is_stmt 0 view .LVU214
 899 0030 B3EE0E0A 		vmov.f32	s0, #3.0e+1
 900 0034 F8E7     		b	.L73
 901              	.LVL86:
 902              	.L76:
 209:controller/IO/sensors.c ****         return SENSOR_CLT_FAIL_SAFE;
 903              		.loc 1 209 9 is_stmt 1 view .LVU215
 904 0036 0748     		ldr	r0, .L81+16
 905 0038 FFF7FEFF 		bl	log_error
 906              	.LVL87:
 210:controller/IO/sensors.c ****     }
 907              		.loc 1 210 9 view .LVU216
 210:controller/IO/sensors.c ****     }
 908              		.loc 1 210 16 is_stmt 0 view .LVU217
 909 003c B3EE0E0A 		vmov.f32	s0, #3.0e+1
 910 0040 F2E7     		b	.L73
 911              	.L82:
 912 0042 00BF     		.align	2
 913              	.L81:
 914 0044 00000000 		.word	sensor_clt
 915 0048 000048C2 		.word	-1035468800
 916 004c 00001643 		.word	1125515264
 917 0050 00000000 		.word	.LC12
 918 0054 00000000 		.word	.LC14
 919              		.cfi_endproc
 920              	.LFE234:
 922              		.section	.rodata.sensor_ops_init.str1.4,"aMS",%progbits,1
 923              		.align	2
 924              	.LC15:
 925 0000 6F707320 		.ascii	"ops sensor is null\000"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 24


 925      73656E73 
 925      6F722069 
 925      73206E75 
 925      6C6C00
 926              		.section	.text.sensor_ops_init,"ax",%progbits
 927              		.align	1
 928              		.global	sensor_ops_init
 929              		.syntax unified
 930              		.thumb
 931              		.thumb_func
 933              	sensor_ops_init:
 934              	.LVL88:
 935              	.LFB235:
 214:controller/IO/sensors.c **** 
 215:controller/IO/sensors.c **** void sensor_ops_init(sensor_ops_t *sensor)
 216:controller/IO/sensors.c **** {
 936              		.loc 1 216 1 is_stmt 1 view -0
 937              		.cfi_startproc
 938              		@ args = 0, pretend = 0, frame = 0
 939              		@ frame_needed = 0, uses_anonymous_args = 0
 940              		.loc 1 216 1 is_stmt 0 view .LVU219
 941 0000 08B5     		push	{r3, lr}
 942              		.cfi_def_cfa_offset 8
 943              		.cfi_offset 3, -8
 944              		.cfi_offset 14, -4
 217:controller/IO/sensors.c ****     if (sensor == NULL)
 945              		.loc 1 217 5 is_stmt 1 view .LVU220
 946              		.loc 1 217 8 is_stmt 0 view .LVU221
 947 0002 48B1     		cbz	r0, .L87
 218:controller/IO/sensors.c ****     {
 219:controller/IO/sensors.c ****         log_error("ops sensor is null");
 220:controller/IO/sensors.c ****         return;
 221:controller/IO/sensors.c ****     }
 222:controller/IO/sensors.c ****     sensor->adc_value_threshold = 4095 / 2;
 948              		.loc 1 222 5 is_stmt 1 view .LVU222
 949              		.loc 1 222 33 is_stmt 0 view .LVU223
 950 0004 40F2FF72 		movw	r2, #2047
 951 0008 0280     		strh	r2, [r0]	@ movhi
 223:controller/IO/sensors.c ****     sensor->debounce_time_ms = 200;
 952              		.loc 1 223 5 is_stmt 1 view .LVU224
 953              		.loc 1 223 30 is_stmt 0 view .LVU225
 954 000a C822     		movs	r2, #200
 955 000c 4280     		strh	r2, [r0, #2]	@ movhi
 224:controller/IO/sensors.c ****     sensor->analog_channel = ANALOG_INPUT_SENSOR_OIL_PIN;
 956              		.loc 1 224 5 is_stmt 1 view .LVU226
 957              		.loc 1 224 28 is_stmt 0 view .LVU227
 958 000e 0722     		movs	r2, #7
 959 0010 0271     		strb	r2, [r0, #4]
 225:controller/IO/sensors.c ****     sensor_ops = sensor;
 960              		.loc 1 225 5 is_stmt 1 view .LVU228
 961              		.loc 1 225 16 is_stmt 0 view .LVU229
 962 0012 034A     		ldr	r2, .L88
 963 0014 1060     		str	r0, [r2]
 964              	.LVL89:
 965              	.L83:
 226:controller/IO/sensors.c **** }
 966              		.loc 1 226 1 view .LVU230
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 25


 967 0016 08BD     		pop	{r3, pc}
 968              	.LVL90:
 969              	.L87:
 219:controller/IO/sensors.c ****         return;
 970              		.loc 1 219 9 is_stmt 1 view .LVU231
 971 0018 0248     		ldr	r0, .L88+4
 972              	.LVL91:
 219:controller/IO/sensors.c ****         return;
 973              		.loc 1 219 9 is_stmt 0 view .LVU232
 974 001a FFF7FEFF 		bl	log_error
 975              	.LVL92:
 220:controller/IO/sensors.c ****     }
 976              		.loc 1 220 9 is_stmt 1 view .LVU233
 977 001e FAE7     		b	.L83
 978              	.L89:
 979              		.align	2
 980              	.L88:
 981 0020 00000000 		.word	sensor_ops
 982 0024 00000000 		.word	.LC15
 983              		.cfi_endproc
 984              	.LFE235:
 986              		.section	.text.sensor_ops_get,"ax",%progbits
 987              		.align	1
 988              		.global	sensor_ops_get
 989              		.syntax unified
 990              		.thumb
 991              		.thumb_func
 993              	sensor_ops_get:
 994              	.LFB236:
 227:controller/IO/sensors.c **** 
 228:controller/IO/sensors.c **** bool sensor_ops_get()
 229:controller/IO/sensors.c **** {
 995              		.loc 1 229 1 view -0
 996              		.cfi_startproc
 997              		@ args = 0, pretend = 0, frame = 0
 998              		@ frame_needed = 0, uses_anonymous_args = 0
 999 0000 10B5     		push	{r4, lr}
 1000              		.cfi_def_cfa_offset 8
 1001              		.cfi_offset 4, -8
 1002              		.cfi_offset 14, -4
 230:controller/IO/sensors.c ****     static uint32_t last_change_time = 0;
 1003              		.loc 1 230 5 view .LVU235
 231:controller/IO/sensors.c ****     static bool last_state = false;
 1004              		.loc 1 231 5 view .LVU236
 232:controller/IO/sensors.c ****     static bool debounced_state = false;
 1005              		.loc 1 232 5 view .LVU237
 233:controller/IO/sensors.c **** 
 234:controller/IO/sensors.c ****     if (sensor_ops == NULL)
 1006              		.loc 1 234 5 view .LVU238
 1007              		.loc 1 234 20 is_stmt 0 view .LVU239
 1008 0002 144B     		ldr	r3, .L97
 1009 0004 1B68     		ldr	r3, [r3]
 1010              		.loc 1 234 8 view .LVU240
 1011 0006 03B3     		cbz	r3, .L96
 235:controller/IO/sensors.c ****     {
 236:controller/IO/sensors.c ****         log_error("ops sensor is null");
 237:controller/IO/sensors.c ****         return false;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 26


 238:controller/IO/sensors.c ****     }
 239:controller/IO/sensors.c **** 
 240:controller/IO/sensors.c ****     uint16_t adc_value = analog_inputs_get_data(sensor_ops->analog_channel);
 1012              		.loc 1 240 5 is_stmt 1 view .LVU241
 1013              		.loc 1 240 26 is_stmt 0 view .LVU242
 1014 0008 1879     		ldrb	r0, [r3, #4]	@ zero_extendqisi2
 1015 000a FFF7FEFF 		bl	analog_inputs_get_data
 1016              	.LVL93:
 241:controller/IO/sensors.c ****     bool current_state = adc_value > sensor_ops->adc_value_threshold;
 1017              		.loc 1 241 5 is_stmt 1 view .LVU243
 1018              		.loc 1 241 48 is_stmt 0 view .LVU244
 1019 000e 114B     		ldr	r3, .L97
 1020 0010 1B68     		ldr	r3, [r3]
 1021 0012 1C88     		ldrh	r4, [r3]
 1022              		.loc 1 241 10 view .LVU245
 1023 0014 8442     		cmp	r4, r0
 1024 0016 2CBF     		ite	cs
 1025 0018 0024     		movcs	r4, #0
 1026 001a 0124     		movcc	r4, #1
 1027              	.LVL94:
 242:controller/IO/sensors.c **** 
 243:controller/IO/sensors.c ****     uint32_t now = get_time_ms();
 1028              		.loc 1 243 5 is_stmt 1 view .LVU246
 1029              		.loc 1 243 20 is_stmt 0 view .LVU247
 1030 001c FFF7FEFF 		bl	get_time_ms
 1031              	.LVL95:
 244:controller/IO/sensors.c **** 
 245:controller/IO/sensors.c ****     if (current_state != last_state)
 1032              		.loc 1 245 5 is_stmt 1 view .LVU248
 1033              		.loc 1 245 23 is_stmt 0 view .LVU249
 1034 0020 0D4B     		ldr	r3, .L97+4
 1035 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1036              		.loc 1 245 8 view .LVU250
 1037 0024 A342     		cmp	r3, r4
 1038 0026 03D0     		beq	.L93
 246:controller/IO/sensors.c ****     {
 247:controller/IO/sensors.c ****         /* State changed, reset debounce timer */
 248:controller/IO/sensors.c ****         last_change_time = now;
 1039              		.loc 1 248 9 is_stmt 1 view .LVU251
 1040              		.loc 1 248 26 is_stmt 0 view .LVU252
 1041 0028 0C4B     		ldr	r3, .L97+8
 1042 002a 1860     		str	r0, [r3]
 249:controller/IO/sensors.c ****         last_state = current_state;
 1043              		.loc 1 249 9 is_stmt 1 view .LVU253
 1044              		.loc 1 249 20 is_stmt 0 view .LVU254
 1045 002c 0A4B     		ldr	r3, .L97+4
 1046 002e 1C70     		strb	r4, [r3]
 1047              	.L93:
 250:controller/IO/sensors.c ****     }
 251:controller/IO/sensors.c **** 
 252:controller/IO/sensors.c ****     if ((now - last_change_time) >= sensor_ops->debounce_time_ms)
 1048              		.loc 1 252 5 is_stmt 1 view .LVU255
 1049              		.loc 1 252 14 is_stmt 0 view .LVU256
 1050 0030 0A4B     		ldr	r3, .L97+8
 1051 0032 1B68     		ldr	r3, [r3]
 1052 0034 C01A     		subs	r0, r0, r3
 1053              	.LVL96:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 27


 1054              		.loc 1 252 47 view .LVU257
 1055 0036 074B     		ldr	r3, .L97
 1056 0038 1B68     		ldr	r3, [r3]
 1057 003a 5B88     		ldrh	r3, [r3, #2]
 1058              		.loc 1 252 8 view .LVU258
 1059 003c 9842     		cmp	r0, r3
 1060 003e 01D3     		bcc	.L94
 253:controller/IO/sensors.c ****     {
 254:controller/IO/sensors.c ****         /* Debounce period passed, accept new state */
 255:controller/IO/sensors.c ****         debounced_state = current_state;
 1061              		.loc 1 255 9 is_stmt 1 view .LVU259
 1062              		.loc 1 255 25 is_stmt 0 view .LVU260
 1063 0040 074B     		ldr	r3, .L97+12
 1064 0042 1C70     		strb	r4, [r3]
 1065              	.L94:
 256:controller/IO/sensors.c ****     }
 257:controller/IO/sensors.c **** 
 258:controller/IO/sensors.c ****     return debounced_state;
 1066              		.loc 1 258 5 is_stmt 1 view .LVU261
 1067              		.loc 1 258 12 is_stmt 0 view .LVU262
 1068 0044 064B     		ldr	r3, .L97+12
 1069 0046 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 1070              	.LVL97:
 1071              	.L92:
 259:controller/IO/sensors.c **** }
 1072              		.loc 1 259 1 view .LVU263
 1073 0048 10BD     		pop	{r4, pc}
 1074              	.L96:
 236:controller/IO/sensors.c ****         return false;
 1075              		.loc 1 236 9 is_stmt 1 view .LVU264
 1076 004a 0648     		ldr	r0, .L97+16
 1077 004c FFF7FEFF 		bl	log_error
 1078              	.LVL98:
 237:controller/IO/sensors.c ****     }
 1079              		.loc 1 237 9 view .LVU265
 237:controller/IO/sensors.c ****     }
 1080              		.loc 1 237 16 is_stmt 0 view .LVU266
 1081 0050 0020     		movs	r0, #0
 1082 0052 F9E7     		b	.L92
 1083              	.L98:
 1084              		.align	2
 1085              	.L97:
 1086 0054 00000000 		.word	sensor_ops
 1087 0058 00000000 		.word	last_state.2
 1088 005c 00000000 		.word	last_change_time.1
 1089 0060 00000000 		.word	debounced_state.0
 1090 0064 00000000 		.word	.LC15
 1091              		.cfi_endproc
 1092              	.LFE236:
 1094              		.section	.bss.debounced_state.0,"aw",%nobits
 1097              	debounced_state.0:
 1098 0000 00       		.space	1
 1099              		.section	.bss.last_change_time.1,"aw",%nobits
 1100              		.align	2
 1103              	last_change_time.1:
 1104 0000 00000000 		.space	4
 1105              		.section	.bss.last_state.2,"aw",%nobits
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 28


 1108              	last_state.2:
 1109 0000 00       		.space	1
 1110              		.section	.bss.sensor_ops,"aw",%nobits
 1111              		.align	2
 1114              	sensor_ops:
 1115 0000 00000000 		.space	4
 1116              		.section	.bss.sensor_clt,"aw",%nobits
 1117              		.align	2
 1120              	sensor_clt:
 1121 0000 00000000 		.space	4
 1122              		.section	.bss.sensor_iat,"aw",%nobits
 1123              		.align	2
 1126              	sensor_iat:
 1127 0000 00000000 		.space	4
 1128              		.section	.bss.map_sensor,"aw",%nobits
 1129              		.align	2
 1132              	map_sensor:
 1133 0000 00000000 		.space	4
 1134              		.section	.rodata
 1135              		.align	2
 1136              		.set	.LANCHOR0,. + 0
 1137              	.LC0:
 1138 0000 000020C1 		.word	-1054867456
 1139 0004 0000C841 		.word	1103626240
 1140 0008 0000A042 		.word	1117782016
 1141 000c 00CC1246 		.word	1175636992
 1142 0010 00800045 		.word	1157660672
 1143 0014 0040A143 		.word	1134641152
 1144              	.LC1:
 1145 0018 000020C1 		.word	-1054867456
 1146 001c 0000C841 		.word	1103626240
 1147 0020 0000B442 		.word	1119092736
 1148 0024 00EEAD46 		.word	1185803776
 1149 0028 00409C45 		.word	1167867904
 1150 002c 00001344 		.word	1142095872
 1151              	.LC2:
 1152 0030 0000A0C1 		.word	-1046478848
 1153 0034 0000C841 		.word	1103626240
 1154 0038 0000B442 		.word	1119092736
 1155 003c 00507546 		.word	1182093312
 1156 0040 00200045 		.word	1157636096
 1157 0044 00006643 		.word	1130758144
 1158              		.text
 1159              	.Letext0:
 1160              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 1161              		.file 4 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 1162              		.file 5 "controller/types.h"
 1163              		.file 6 "controller/IO/analog_inputs.h"
 1164              		.file 7 "controller/IO/resistor.h"
 1165              		.file 8 "controller/IO/thermistor.h"
 1166              		.file 9 "controller/IO/sensors.h"
 1167              		.file 10 "controller/utils/error_handling.h"
 1168              		.file 11 "controller/utils/timing.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 29


DEFINED SYMBOLS
                            *ABS*:00000000 sensors.c
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:21     .rodata.sensor_tps_get.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:28     .text.sensor_tps_get:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:34     .text.sensor_tps_get:00000000 sensor_tps_get
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:231    .text.sensor_tps_get:000000d8 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:240    .rodata.sensor_map_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:247    .text.sensor_map_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:253    .text.sensor_map_init:00000000 sensor_map_init
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:334    .text.sensor_map_init:00000040 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1132   .bss.map_sensor:00000000 map_sensor
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:341    .rodata.sensor_map_get.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:348    .text.sensor_map_get:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:354    .text.sensor_map_get:00000000 sensor_map_get
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:478    .text.sensor_map_get:0000008c $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:488    .rodata.sensor_iat_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:492    .text.sensor_iat_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:498    .text.sensor_iat_init:00000000 sensor_iat_init
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:609    .text.sensor_iat_init:00000088 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1126   .bss.sensor_iat:00000000 sensor_iat
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:619    .rodata.sensor_iat_get.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:626    .text.sensor_iat_get:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:632    .text.sensor_iat_get:00000000 sensor_iat_get
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:689    .text.sensor_iat_get:00000044 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:699    .rodata.sensor_clt_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:706    .text.sensor_clt_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:712    .text.sensor_clt_init:00000000 sensor_clt_init
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:835    .text.sensor_clt_init:00000090 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1120   .bss.sensor_clt:00000000 sensor_clt
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:847    .rodata.sensor_clt_get.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:851    .text.sensor_clt_get:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:857    .text.sensor_clt_get:00000000 sensor_clt_get
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:914    .text.sensor_clt_get:00000044 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:923    .rodata.sensor_ops_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:927    .text.sensor_ops_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:933    .text.sensor_ops_init:00000000 sensor_ops_init
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:981    .text.sensor_ops_init:00000020 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1114   .bss.sensor_ops:00000000 sensor_ops
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:987    .text.sensor_ops_get:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:993    .text.sensor_ops_get:00000000 sensor_ops_get
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1086   .text.sensor_ops_get:00000054 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1108   .bss.last_state.2:00000000 last_state.2
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1103   .bss.last_change_time.1:00000000 last_change_time.1
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1097   .bss.debounced_state.0:00000000 debounced_state.0
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1098   .bss.debounced_state.0:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1100   .bss.last_change_time.1:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1109   .bss.last_state.2:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1111   .bss.sensor_ops:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1117   .bss.sensor_clt:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1123   .bss.sensor_iat:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1129   .bss.map_sensor:00000000 $d
C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s:1135   .rodata:00000000 $d

UNDEFINED SYMBOLS
analog_inputs_get_data
log_error
resistor_init
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccdHPY1K.s 			page 30


thermistor_init
thermistor_get_temp
get_time_ms
