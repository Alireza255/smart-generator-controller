ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"fan_control.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/actuators/fan_control.c"
  20              		.section	.text.fan_control_update,"ax",%progbits
  21              		.align	1
  22              		.global	fan_control_update
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	fan_control_update:
  28              	.LFB233:
   1:controller/actuators/fan_control.c **** #include "fan_control.h"
   2:controller/actuators/fan_control.c **** 
   3:controller/actuators/fan_control.c **** static bool thermostat(temperature_t temp, temperature_t on_temp, temperature_t off_temp)
   4:controller/actuators/fan_control.c **** {
   5:controller/actuators/fan_control.c ****     if (temp > on_temp)
   6:controller/actuators/fan_control.c ****     {
   7:controller/actuators/fan_control.c ****         return true;
   8:controller/actuators/fan_control.c ****     }
   9:controller/actuators/fan_control.c ****     else if (temp < off_temp)
  10:controller/actuators/fan_control.c ****     {
  11:controller/actuators/fan_control.c ****         return false;
  12:controller/actuators/fan_control.c ****     }
  13:controller/actuators/fan_control.c **** }
  14:controller/actuators/fan_control.c **** void fan_control_update()
  15:controller/actuators/fan_control.c **** {
  29              		.loc 1 15 1 view -0
  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  33 0000 38B5     		push	{r3, r4, r5, lr}
  34              		.cfi_def_cfa_offset 16
  35              		.cfi_offset 3, -16
  36              		.cfi_offset 4, -12
  37              		.cfi_offset 5, -8
  38              		.cfi_offset 14, -4
  16:controller/actuators/fan_control.c ****     temperature_t current_temp = sensor_clt_get();
  39              		.loc 1 16 5 view .LVU1
  40              		.loc 1 16 34 is_stmt 0 view .LVU2
  41 0002 FFF7FEFF 		bl	sensor_clt_get
  42              	.LVL0:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 2


  17:controller/actuators/fan_control.c **** 
  18:controller/actuators/fan_control.c ****     bool fan1_command = false;
  43              		.loc 1 18 5 is_stmt 1 view .LVU3
  19:controller/actuators/fan_control.c ****     bool fan2_command = false;
  44              		.loc 1 19 5 view .LVU4
  20:controller/actuators/fan_control.c ****     
  21:controller/actuators/fan_control.c ****     if (config.fan1_enabled)
  45              		.loc 1 21 5 view .LVU5
  46              		.loc 1 21 15 is_stmt 0 view .LVU6
  47 0006 274B     		ldr	r3, .L21
  48 0008 93F8B132 		ldrb	r3, [r3, #689]	@ zero_extendqisi2
  49              		.loc 1 21 8 view .LVU7
  50 000c 4BB1     		cbz	r3, .L11
  22:controller/actuators/fan_control.c ****     {
  23:controller/actuators/fan_control.c ****         if (current_temp > config.fan1_on_temp)
  51              		.loc 1 23 9 is_stmt 1 view .LVU8
  52              		.loc 1 23 34 is_stmt 0 view .LVU9
  53 000e 254B     		ldr	r3, .L21
  54 0010 D3ED9F7A 		vldr.32	s15, [r3, #636]
  55              		.loc 1 23 12 view .LVU10
  56 0014 F4EEC07A 		vcmpe.f32	s15, s0
  57 0018 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  58 001c 10D5     		bpl	.L18
  24:controller/actuators/fan_control.c ****         {
  25:controller/actuators/fan_control.c ****             fan1_command = true;
  59              		.loc 1 25 26 view .LVU11
  60 001e 0122     		movs	r2, #1
  61 0020 00E0     		b	.L2
  62              	.L11:
  26:controller/actuators/fan_control.c ****         }
  27:controller/actuators/fan_control.c ****         else if (current_temp < config.fan1_off_temp)
  28:controller/actuators/fan_control.c ****         {
  29:controller/actuators/fan_control.c ****             fan1_command = false;
  30:controller/actuators/fan_control.c ****         }
  31:controller/actuators/fan_control.c ****     }
  32:controller/actuators/fan_control.c ****     else
  33:controller/actuators/fan_control.c ****     {
  34:controller/actuators/fan_control.c ****         fan1_command = false;
  63              		.loc 1 34 22 view .LVU12
  64 0022 0022     		movs	r2, #0
  65              	.L2:
  66              	.LVL1:
  35:controller/actuators/fan_control.c ****     }
  36:controller/actuators/fan_control.c ****     
  37:controller/actuators/fan_control.c ****     if (config.fan2_enabled)
  67              		.loc 1 37 5 is_stmt 1 view .LVU13
  68              		.loc 1 37 15 is_stmt 0 view .LVU14
  69 0024 1F4B     		ldr	r3, .L21
  70 0026 93F8B232 		ldrb	r3, [r3, #690]	@ zero_extendqisi2
  71              		.loc 1 37 8 view .LVU15
  72 002a 5BB1     		cbz	r3, .L13
  38:controller/actuators/fan_control.c ****     {
  39:controller/actuators/fan_control.c ****         if (current_temp > config.fan2_on_temp)
  73              		.loc 1 39 9 is_stmt 1 view .LVU16
  74              		.loc 1 39 34 is_stmt 0 view .LVU17
  75 002c 1D4B     		ldr	r3, .L21
  76 002e D3EDA17A 		vldr.32	s15, [r3, #644]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 3


  77              		.loc 1 39 12 view .LVU18
  78 0032 F4EEC07A 		vcmpe.f32	s15, s0
  79 0036 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  80 003a 22D5     		bpl	.L19
  40:controller/actuators/fan_control.c ****         {
  41:controller/actuators/fan_control.c ****             fan2_command = true;
  81              		.loc 1 41 26 view .LVU19
  82 003c 0125     		movs	r5, #1
  83 003e 02E0     		b	.L4
  84              	.LVL2:
  85              	.L18:
  18:controller/actuators/fan_control.c ****     bool fan2_command = false;
  86              		.loc 1 18 10 view .LVU20
  87 0040 0022     		movs	r2, #0
  88 0042 EFE7     		b	.L2
  89              	.LVL3:
  90              	.L13:
  42:controller/actuators/fan_control.c ****         }
  43:controller/actuators/fan_control.c ****         else if (current_temp < config.fan2_off_temp)
  44:controller/actuators/fan_control.c ****         {
  45:controller/actuators/fan_control.c ****             fan2_command = false;
  46:controller/actuators/fan_control.c ****         }
  47:controller/actuators/fan_control.c ****     }
  48:controller/actuators/fan_control.c ****     else
  49:controller/actuators/fan_control.c ****     {
  50:controller/actuators/fan_control.c ****        fan2_command = false;
  91              		.loc 1 50 21 view .LVU21
  92 0044 0025     		movs	r5, #0
  93              	.L4:
  94              	.LVL4:
  51:controller/actuators/fan_control.c ****     }
  52:controller/actuators/fan_control.c ****     if (get_bit(runtime.status, STATUS_CLT_ERROR))
  95              		.loc 1 52 5 is_stmt 1 view .LVU22
  96              	.LBB8:
  97              	.LBI8:
  98              		.file 2 "controller/utils/utils.h"
   1:controller/utils/utils.h **** /**
   2:controller/utils/utils.h ****  * @file utils.h
   3:controller/utils/utils.h ****  * @brief Header file containing utility functions and definitions for the smart generator controll
   4:controller/utils/utils.h ****  *
   5:controller/utils/utils.h ****  * This file provides declarations for utility functions and macros that are
   6:controller/utils/utils.h ****  * used throughout the firmware to support various functionalities.
   7:controller/utils/utils.h ****  *
   8:controller/utils/utils.h ****  * @note Ensure that this file is included wherever utility functions are required.
   9:controller/utils/utils.h ****  */
  10:controller/utils/utils.h **** #ifndef UTILS_H
  11:controller/utils/utils.h **** #define UTILS_H
  12:controller/utils/utils.h **** 
  13:controller/utils/utils.h **** #include "types.h"
  14:controller/utils/utils.h **** #include "math.h"
  15:controller/utils/utils.h **** #define IS_IN_RANGE(value, min, max) ((value) >= (min) && (value) <= (max))
  16:controller/utils/utils.h **** #define ABS(value) ((value) < 0 ? -(value) : (value))
  17:controller/utils/utils.h **** #define CLAMP(value, min, max) ((value) < (min) ? (min) : ((value) > (max) ? (max) : (value)))
  18:controller/utils/utils.h **** 
  19:controller/utils/utils.h **** static inline void change_bit(uint32_t *var, uint8_t bit, bool state)
  20:controller/utils/utils.h **** {
  21:controller/utils/utils.h ****     if (bit > 31)
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 4


  22:controller/utils/utils.h ****     {
  23:controller/utils/utils.h ****         return;
  24:controller/utils/utils.h ****     }
  25:controller/utils/utils.h ****     if (state)
  26:controller/utils/utils.h ****     {
  27:controller/utils/utils.h ****         *var |= (1u << bit);
  28:controller/utils/utils.h ****     }
  29:controller/utils/utils.h ****     else
  30:controller/utils/utils.h ****     {
  31:controller/utils/utils.h ****         *var &= ~(1u << bit);
  32:controller/utils/utils.h ****     }
  33:controller/utils/utils.h **** }
  34:controller/utils/utils.h **** 
  35:controller/utils/utils.h **** static inline bool get_bit(uint32_t flags, uint8_t bit)
  99              		.loc 2 35 20 view .LVU23
 100              	.LBB9:
  36:controller/utils/utils.h **** {
  37:controller/utils/utils.h ****     if (bit < 32)
 101              		.loc 2 37 5 view .LVU24
  38:controller/utils/utils.h ****     {
  39:controller/utils/utils.h ****         return (flags >> bit) & 1u;
 102              		.loc 2 39 9 view .LVU25
 103              		.loc 2 39 23 is_stmt 0 view .LVU26
 104 0046 184B     		ldr	r3, .L21+4
 105              	.LVL5:
 106              		.loc 2 39 23 view .LVU27
 107 0048 5C88     		ldrh	r4, [r3, #2]
 108              	.LVL6:
 109              		.loc 2 39 23 view .LVU28
 110              	.LBE9:
 111              	.LBE8:
 112              		.loc 1 52 8 discriminator 1 view .LVU29
 113 004a 14F00104 		ands	r4, r4, #1
 114 004e 1AD1     		bne	.L15
 115 0050 1446     		mov	r4, r2
 116              	.LVL7:
 117              	.L6:
  53:controller/actuators/fan_control.c ****     {
  54:controller/actuators/fan_control.c ****         fan1_command = true;
  55:controller/actuators/fan_control.c ****         fan2_command = true;
  56:controller/actuators/fan_control.c ****     }
  57:controller/actuators/fan_control.c ****     
  58:controller/actuators/fan_control.c ****     HAL_GPIO_WritePin(FAN_1_GPIO_Port, FAN_1_Pin, fan1_command);
 118              		.loc 1 58 5 is_stmt 1 view .LVU30
 119 0052 2246     		mov	r2, r4
 120 0054 0421     		movs	r1, #4
 121 0056 1548     		ldr	r0, .L21+8
 122 0058 FFF7FEFF 		bl	HAL_GPIO_WritePin
 123              	.LVL8:
  59:controller/actuators/fan_control.c ****     change_bit(&runtime.status, STATUS_FAN1_ON, fan1_command);
 124              		.loc 1 59 5 view .LVU31
 125              	.LBB10:
 126              	.LBI10:
  19:controller/utils/utils.h **** {
 127              		.loc 2 19 20 view .LVU32
 128              	.LBB11:
  21:controller/utils/utils.h ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 5


 129              		.loc 2 21 5 view .LVU33
  25:controller/utils/utils.h ****     {
 130              		.loc 2 25 5 view .LVU34
  25:controller/utils/utils.h ****     {
 131              		.loc 2 25 8 is_stmt 0 view .LVU35
 132 005c ACB1     		cbz	r4, .L7
  27:controller/utils/utils.h ****     }
 133              		.loc 2 27 9 is_stmt 1 view .LVU36
 134 005e 124A     		ldr	r2, .L21+4
 135 0060 1368     		ldr	r3, [r2]
  27:controller/utils/utils.h ****     }
 136              		.loc 2 27 14 is_stmt 0 view .LVU37
 137 0062 43F04003 		orr	r3, r3, #64
 138 0066 1360     		str	r3, [r2]
 139              	.L8:
 140              	.LVL9:
  27:controller/utils/utils.h ****     }
 141              		.loc 2 27 14 view .LVU38
 142              	.LBE11:
 143              	.LBE10:
  60:controller/actuators/fan_control.c ****     
  61:controller/actuators/fan_control.c ****     HAL_GPIO_WritePin(FAN_2_GPIO_Port, FAN_2_Pin, fan2_command);
 144              		.loc 1 61 5 is_stmt 1 view .LVU39
 145 0068 2A46     		mov	r2, r5
 146 006a 4FF48061 		mov	r1, #1024
 147 006e 0F48     		ldr	r0, .L21+8
 148 0070 FFF7FEFF 		bl	HAL_GPIO_WritePin
 149              	.LVL10:
  62:controller/actuators/fan_control.c ****     change_bit(&runtime.status, STATUS_FAN2_ON, fan2_command);
 150              		.loc 1 62 5 view .LVU40
 151              	.LBB13:
 152              	.LBI13:
  19:controller/utils/utils.h **** {
 153              		.loc 2 19 20 view .LVU41
 154              	.LBB14:
  21:controller/utils/utils.h ****     {
 155              		.loc 2 21 5 view .LVU42
  25:controller/utils/utils.h ****     {
 156              		.loc 2 25 5 view .LVU43
  25:controller/utils/utils.h ****     {
 157              		.loc 2 25 8 is_stmt 0 view .LVU44
 158 0074 7DB1     		cbz	r5, .L9
  27:controller/utils/utils.h ****     }
 159              		.loc 2 27 9 is_stmt 1 view .LVU45
 160 0076 0C4A     		ldr	r2, .L21+4
 161 0078 1368     		ldr	r3, [r2]
  27:controller/utils/utils.h ****     }
 162              		.loc 2 27 14 is_stmt 0 view .LVU46
 163 007a 43F08003 		orr	r3, r3, #128
 164 007e 1360     		str	r3, [r2]
 165              	.LVL11:
 166              	.L1:
  27:controller/utils/utils.h ****     }
 167              		.loc 2 27 14 view .LVU47
 168              	.LBE14:
 169              	.LBE13:
  63:controller/actuators/fan_control.c **** 
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 6


  64:controller/actuators/fan_control.c **** }...
 170              		.loc 1 64 1 view .LVU48
 171 0080 38BD     		pop	{r3, r4, r5, pc}
 172              	.LVL12:
 173              	.L19:
  19:controller/actuators/fan_control.c ****     bool fan2_command = false;
 174              		.loc 1 19 10 view .LVU49
 175 0082 0025     		movs	r5, #0
 176 0084 DFE7     		b	.L4
 177              	.LVL13:
 178              	.L15:
  55:controller/actuators/fan_control.c ****         fan2_command = true;
 179              		.loc 1 55 22 view .LVU50
 180 0086 2546     		mov	r5, r4
 181              	.LVL14:
  55:controller/actuators/fan_control.c ****         fan2_command = true;
 182              		.loc 1 55 22 view .LVU51
 183 0088 E3E7     		b	.L6
 184              	.LVL15:
 185              	.L7:
 186              	.LBB16:
 187              	.LBB12:
  31:controller/utils/utils.h ****     }
 188              		.loc 2 31 9 is_stmt 1 view .LVU52
 189 008a 074A     		ldr	r2, .L21+4
 190 008c 1368     		ldr	r3, [r2]
  31:controller/utils/utils.h ****     }
 191              		.loc 2 31 14 is_stmt 0 view .LVU53
 192 008e 23F04003 		bic	r3, r3, #64
 193 0092 1360     		str	r3, [r2]
 194 0094 E8E7     		b	.L8
 195              	.LVL16:
 196              	.L9:
  31:controller/utils/utils.h ****     }
 197              		.loc 2 31 14 view .LVU54
 198              	.LBE12:
 199              	.LBE16:
 200              	.LBB17:
 201              	.LBB15:
  31:controller/utils/utils.h ****     }
 202              		.loc 2 31 9 is_stmt 1 view .LVU55
 203 0096 044A     		ldr	r2, .L21+4
 204 0098 1368     		ldr	r3, [r2]
  31:controller/utils/utils.h ****     }
 205              		.loc 2 31 14 is_stmt 0 view .LVU56
 206 009a 23F08003 		bic	r3, r3, #128
 207 009e 1360     		str	r3, [r2]
 208              	.LVL17:
  31:controller/utils/utils.h ****     }
 209              		.loc 2 31 14 view .LVU57
 210              	.LBE15:
 211              	.LBE17:
 212              		.loc 1 64 1 view .LVU58
 213 00a0 EEE7     		b	.L1
 214              	.L22:
 215 00a2 00BF     		.align	2
 216              	.L21:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 7


 217 00a4 00100000 		.word	config+4096
 218 00a8 00000000 		.word	runtime
 219 00ac 00040240 		.word	1073873920
 220              		.cfi_endproc
 221              	.LFE233:
 223              		.text
 224              	.Letext0:
 225              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 226              		.file 4 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 227              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 228              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 229              		.file 7 "controller/types.h"
 230              		.file 8 "controller/tables.h"
 231              		.file 9 "controller/config_and_runtime.h"
 232              		.file 10 "controller/IO/sensors.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s 			page 8


DEFINED SYMBOLS
                            *ABS*:00000000 fan_control.c
C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s:21     .text.fan_control_update:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s:27     .text.fan_control_update:00000000 fan_control_update
C:\Users\alireza\AppData\Local\Temp\ccO7jVJI.s:217    .text.fan_control_update:000000a4 $d

UNDEFINED SYMBOLS
sensor_clt_get
HAL_GPIO_WritePin
config
runtime
