ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"trigger.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/engine_cycle/trigger.c"
  20              		.section	.text.set_filtering,"ax",%progbits
  21              		.align	1
  22              		.global	set_filtering
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	set_filtering:
  28              	.LVL0:
  29              	.LFB228:
   1:controller/engine_cycle/trigger.c **** #include "trigger.h"
   2:controller/engine_cycle/trigger.c **** #include "controller.h"
   3:controller/engine_cycle/trigger.c **** 
   4:controller/engine_cycle/trigger.c **** trigger_s *trigger = NULL;
   5:controller/engine_cycle/trigger.c **** 
   6:controller/engine_cycle/trigger.c **** void set_filtering(trigger_s *trigger)
   7:controller/engine_cycle/trigger.c **** {
  30              		.loc 1 7 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
   8:controller/engine_cycle/trigger.c ****   switch (configuration.trigger.filtering)
  35              		.loc 1 8 3 view .LVU1
  36              		.loc 1 8 32 is_stmt 0 view .LVU2
  37 0000 0D4B     		ldr	r3, .L9
  38 0002 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
  39              		.loc 1 8 3 view .LVU3
  40 0004 032B     		cmp	r3, #3
  41 0006 13D8     		bhi	.L2
  42 0008 DFE803F0 		tbb	[pc, r3]
  43              	.L4:
  44 000c 02       		.byte	(.L7-.L4)/2
  45 000d 05       		.byte	(.L6-.L4)/2
  46 000e 09       		.byte	(.L5-.L4)/2
  47 000f 0C       		.byte	(.L3-.L4)/2
  48              		.p2align 1
  49              	.L7:
   9:controller/engine_cycle/trigger.c ****   {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 2


  10:controller/engine_cycle/trigger.c ****     case TF_FILTERING_NONE:
  11:controller/engine_cycle/trigger.c ****       trigger->_trigger_filter_time_us = 0;
  50              		.loc 1 11 7 is_stmt 1 view .LVU4
  51              		.loc 1 11 40 is_stmt 0 view .LVU5
  52 0010 0023     		movs	r3, #0
  53 0012 4360     		str	r3, [r0, #4]
  12:controller/engine_cycle/trigger.c ****         break;
  54              		.loc 1 12 9 is_stmt 1 view .LVU6
  55 0014 7047     		bx	lr
  56              	.L6:
  13:controller/engine_cycle/trigger.c ****     case TF_FILTERING_LITE:
  14:controller/engine_cycle/trigger.c ****       trigger->_trigger_filter_time_us = trigger->_current_tooth_gap_us / 4U; 
  57              		.loc 1 14 7 view .LVU7
  58              		.loc 1 14 49 is_stmt 0 view .LVU8
  59 0016 4369     		ldr	r3, [r0, #20]
  60              		.loc 1 14 73 view .LVU9
  61 0018 9B08     		lsrs	r3, r3, #2
  62              		.loc 1 14 40 view .LVU10
  63 001a 4360     		str	r3, [r0, #4]
  15:controller/engine_cycle/trigger.c ****         break;
  64              		.loc 1 15 9 is_stmt 1 view .LVU11
  65 001c 7047     		bx	lr
  66              	.L5:
  16:controller/engine_cycle/trigger.c ****     case TF_FILTERING_MEDIUM:
  17:controller/engine_cycle/trigger.c ****       trigger->_trigger_filter_time_us = trigger->_current_tooth_gap_us / 1U;
  67              		.loc 1 17 7 view .LVU12
  68              		.loc 1 17 49 is_stmt 0 view .LVU13
  69 001e 4369     		ldr	r3, [r0, #20]
  70              		.loc 1 17 40 view .LVU14
  71 0020 4360     		str	r3, [r0, #4]
  18:controller/engine_cycle/trigger.c ****         break;
  72              		.loc 1 18 9 is_stmt 1 view .LVU15
  73 0022 7047     		bx	lr
  74              	.L3:
  19:controller/engine_cycle/trigger.c ****     case TF_FILTERING_AGGRESSIVE:
  20:controller/engine_cycle/trigger.c ****       trigger->_trigger_filter_time_us = trigger->_current_tooth_gap_us * 3 / 4;
  75              		.loc 1 20 7 view .LVU16
  76              		.loc 1 20 49 is_stmt 0 view .LVU17
  77 0024 4369     		ldr	r3, [r0, #20]
  78              		.loc 1 20 73 view .LVU18
  79 0026 03EB4303 		add	r3, r3, r3, lsl #1
  80              		.loc 1 20 77 view .LVU19
  81 002a 9B08     		lsrs	r3, r3, #2
  82              		.loc 1 20 40 view .LVU20
  83 002c 4360     		str	r3, [r0, #4]
  21:controller/engine_cycle/trigger.c ****         break;
  84              		.loc 1 21 9 is_stmt 1 view .LVU21
  85 002e 7047     		bx	lr
  86              	.L2:
  22:controller/engine_cycle/trigger.c ****     default:
  23:controller/engine_cycle/trigger.c ****         // Handle invalid filtering level
  24:controller/engine_cycle/trigger.c ****         trigger->_trigger_filter_time_us = 0;
  87              		.loc 1 24 9 view .LVU22
  88              		.loc 1 24 42 is_stmt 0 view .LVU23
  89 0030 0023     		movs	r3, #0
  90 0032 4360     		str	r3, [r0, #4]
  25:controller/engine_cycle/trigger.c ****         break;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 3


  91              		.loc 1 25 9 is_stmt 1 view .LVU24
  26:controller/engine_cycle/trigger.c ****   }
  27:controller/engine_cycle/trigger.c **** }
  92              		.loc 1 27 1 is_stmt 0 view .LVU25
  93 0034 7047     		bx	lr
  94              	.L10:
  95 0036 00BF     		.align	2
  96              	.L9:
  97 0038 00000000 		.word	configuration
  98              		.cfi_endproc
  99              	.LFE228:
 101              		.section	.text.trigger_init,"ax",%progbits
 102              		.align	1
 103              		.global	trigger_init
 104              		.syntax unified
 105              		.thumb
 106              		.thumb_func
 108              	trigger_init:
 109              	.LVL1:
 110              	.LFB229:
  28:controller/engine_cycle/trigger.c **** 
  29:controller/engine_cycle/trigger.c **** void trigger_init(trigger_s *instance)
  30:controller/engine_cycle/trigger.c **** {   
 111              		.loc 1 30 1 is_stmt 1 view -0
 112              		.cfi_startproc
 113              		@ args = 0, pretend = 0, frame = 0
 114              		@ frame_needed = 0, uses_anonymous_args = 0
  31:controller/engine_cycle/trigger.c ****   bool temp_status = true;
 115              		.loc 1 31 3 view .LVU27
  32:controller/engine_cycle/trigger.c ****   if (instance == NULL)
 116              		.loc 1 32 3 view .LVU28
 117              		.loc 1 32 6 is_stmt 0 view .LVU29
 118 0000 B8B1     		cbz	r0, .L17
  30:controller/engine_cycle/trigger.c ****   bool temp_status = true;
 119              		.loc 1 30 1 view .LVU30
 120 0002 10B5     		push	{r4, lr}
 121              		.cfi_def_cfa_offset 8
 122              		.cfi_offset 4, -8
 123              		.cfi_offset 14, -4
  33:controller/engine_cycle/trigger.c ****   {
  34:controller/engine_cycle/trigger.c ****     /**
  35:controller/engine_cycle/trigger.c ****      * @todo and maybe throw an error!
  36:controller/engine_cycle/trigger.c ****      */
  37:controller/engine_cycle/trigger.c ****     return;
  38:controller/engine_cycle/trigger.c ****   }
  39:controller/engine_cycle/trigger.c ****   trigger = instance;
 124              		.loc 1 39 3 is_stmt 1 view .LVU31
 125              		.loc 1 39 11 is_stmt 0 view .LVU32
 126 0004 0B4C     		ldr	r4, .L20
 127 0006 2060     		str	r0, [r4]
  40:controller/engine_cycle/trigger.c ****   
  41:controller/engine_cycle/trigger.c ****   trigger->sync_status = TS_NOT_SYNCED;
 128              		.loc 1 41 3 is_stmt 1 view .LVU33
 129              		.loc 1 41 24 is_stmt 0 view .LVU34
 130 0008 0022     		movs	r2, #0
 131 000a 4270     		strb	r2, [r0, #1]
  42:controller/engine_cycle/trigger.c ****   set_filtering(trigger);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 4


 132              		.loc 1 42 3 is_stmt 1 view .LVU35
 133 000c 2068     		ldr	r0, [r4]
 134              	.LVL2:
 135              		.loc 1 42 3 is_stmt 0 view .LVU36
 136 000e FFF7FEFF 		bl	set_filtering
 137              	.LVL3:
  43:controller/engine_cycle/trigger.c ****   trigger->_trigger_actual_teeth = configuration.trigger.full_teeth - configuration.trigger.missing
 138              		.loc 1 43 3 is_stmt 1 view .LVU37
 139              		.loc 1 43 57 is_stmt 0 view .LVU38
 140 0012 094B     		ldr	r3, .L20+4
 141 0014 DA79     		ldrb	r2, [r3, #7]	@ zero_extendqisi2
 142              		.loc 1 43 92 view .LVU39
 143 0016 197A     		ldrb	r1, [r3, #8]	@ zero_extendqisi2
 144              		.loc 1 43 10 view .LVU40
 145 0018 2368     		ldr	r3, [r4]
 146              		.loc 1 43 69 view .LVU41
 147 001a 501A     		subs	r0, r2, r1
 148              		.loc 1 43 34 view .LVU42
 149 001c 83F82200 		strb	r0, [r3, #34]
  44:controller/engine_cycle/trigger.c ****     
  45:controller/engine_cycle/trigger.c ****   if (configuration.trigger.full_teeth == 0 || configuration.trigger.missing_teeth == 0)
 150              		.loc 1 45 3 is_stmt 1 view .LVU43
 151              		.loc 1 45 6 is_stmt 0 view .LVU44
 152 0020 12B1     		cbz	r2, .L14
 153              		.loc 1 45 45 discriminator 1 view .LVU45
 154 0022 21B1     		cbz	r1, .L15
  31:controller/engine_cycle/trigger.c ****   if (instance == NULL)
 155              		.loc 1 31 8 view .LVU46
 156 0024 0122     		movs	r2, #1
 157 0026 00E0     		b	.L13
 158              	.L14:
  46:controller/engine_cycle/trigger.c ****   {
  47:controller/engine_cycle/trigger.c ****     temp_status = false;
 159              		.loc 1 47 17 view .LVU47
 160 0028 0022     		movs	r2, #0
 161              	.L13:
 162              	.LVL4:
  48:controller/engine_cycle/trigger.c ****   }
  49:controller/engine_cycle/trigger.c ****   trigger->initialized = temp_status;
 163              		.loc 1 49 3 is_stmt 1 view .LVU48
 164              		.loc 1 49 24 is_stmt 0 view .LVU49
 165 002a 1A70     		strb	r2, [r3]
  50:controller/engine_cycle/trigger.c ****     
  51:controller/engine_cycle/trigger.c **** }
 166              		.loc 1 51 1 view .LVU50
 167 002c 10BD     		pop	{r4, pc}
 168              	.LVL5:
 169              	.L15:
  47:controller/engine_cycle/trigger.c ****   }
 170              		.loc 1 47 17 view .LVU51
 171 002e 0022     		movs	r2, #0
 172 0030 FBE7     		b	.L13
 173              	.LVL6:
 174              	.L17:
 175              		.cfi_def_cfa_offset 0
 176              		.cfi_restore 4
 177              		.cfi_restore 14
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 5


  47:controller/engine_cycle/trigger.c ****   }
 178              		.loc 1 47 17 view .LVU52
 179 0032 7047     		bx	lr
 180              	.L21:
 181              		.align	2
 182              	.L20:
 183 0034 00000000 		.word	trigger
 184 0038 00000000 		.word	configuration
 185              		.cfi_endproc
 186              	.LFE229:
 188              		.section	.text.crankshaft_get_rpm,"ax",%progbits
 189              		.align	1
 190              		.global	crankshaft_get_rpm
 191              		.syntax unified
 192              		.thumb
 193              		.thumb_func
 195              	crankshaft_get_rpm:
 196              	.LFB231:
  52:controller/engine_cycle/trigger.c **** 
  53:controller/engine_cycle/trigger.c **** void trigger_tooth_handle()
  54:controller/engine_cycle/trigger.c **** {
  55:controller/engine_cycle/trigger.c **** 
  56:controller/engine_cycle/trigger.c ****   if (!trigger->initialized)
  57:controller/engine_cycle/trigger.c ****   {
  58:controller/engine_cycle/trigger.c ****       /**
  59:controller/engine_cycle/trigger.c ****        * @todo add an error message
  60:controller/engine_cycle/trigger.c ****        */
  61:controller/engine_cycle/trigger.c ****       return;
  62:controller/engine_cycle/trigger.c ****   }
  63:controller/engine_cycle/trigger.c **** 
  64:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[0] = get_time_us();
  65:controller/engine_cycle/trigger.c ****   trigger->_current_tooth_gap_us = trigger->_tooth_time_us[0] - trigger->_tooth_time_us[1];
  66:controller/engine_cycle/trigger.c ****   
  67:controller/engine_cycle/trigger.c ****   if (trigger->_current_tooth_gap_us < trigger->_trigger_filter_time_us) // Pulses should never be 
  68:controller/engine_cycle/trigger.c ****   {
  69:controller/engine_cycle/trigger.c ****     // Reset the filter to avoid getting stuck
  70:controller/engine_cycle/trigger.c ****     //trigger->_trigger_filter_time_us = trigger->_current_tooth_gap_us / 2U;
  71:controller/engine_cycle/trigger.c ****     return;
  72:controller/engine_cycle/trigger.c ****   }
  73:controller/engine_cycle/trigger.c ****   
  74:controller/engine_cycle/trigger.c ****   trigger->_counted_tooth++; //Increment the tooth counter
  75:controller/engine_cycle/trigger.c ****   
  76:controller/engine_cycle/trigger.c ****   bool is_missing_teeth = false;
  77:controller/engine_cycle/trigger.c ****   
  78:controller/engine_cycle/trigger.c ****   // if we had previous data calculate the tooth gap
  79:controller/engine_cycle/trigger.c ****   if (trigger->_tooth_time_us[1] == 0 || trigger->_tooth_time_us[2] == 0)
  80:controller/engine_cycle/trigger.c ****   {
  81:controller/engine_cycle/trigger.c ****     //return;
  82:controller/engine_cycle/trigger.c ****   }
  83:controller/engine_cycle/trigger.c ****     
  84:controller/engine_cycle/trigger.c ****   time_us_t previous_tooth_gap = 0;
  85:controller/engine_cycle/trigger.c **** 
  86:controller/engine_cycle/trigger.c ****   previous_tooth_gap = trigger->_tooth_time_us[1] - trigger->_tooth_time_us[2];
  87:controller/engine_cycle/trigger.c **** 
  88:controller/engine_cycle/trigger.c ****   // this selects the shorter tooth gap since that is more appropriate 
  89:controller/engine_cycle/trigger.c ****   if (previous_tooth_gap < trigger->_current_tooth_gap_us) 
  90:controller/engine_cycle/trigger.c ****   {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 6


  91:controller/engine_cycle/trigger.c ****     /**
  92:controller/engine_cycle/trigger.c ****      * We use the previous tooth gap since the current tooth gap might be long and indicate missing
  93:controller/engine_cycle/trigger.c ****      */
  94:controller/engine_cycle/trigger.c ****     trigger->_shorter_tooth_gap = previous_tooth_gap;
  95:controller/engine_cycle/trigger.c ****   }
  96:controller/engine_cycle/trigger.c ****   else
  97:controller/engine_cycle/trigger.c ****   {
  98:controller/engine_cycle/trigger.c ****     trigger->_shorter_tooth_gap = trigger->_current_tooth_gap_us;
  99:controller/engine_cycle/trigger.c ****   }
 100:controller/engine_cycle/trigger.c ****     
 101:controller/engine_cycle/trigger.c **** 
 102:controller/engine_cycle/trigger.c ****   //If the time between the current tooth and the last is greater than 1.5x the time between the la
 103:controller/engine_cycle/trigger.c ****   if(configuration.trigger.missing_teeth == 1)
 104:controller/engine_cycle/trigger.c ****   {
 105:controller/engine_cycle/trigger.c ****     trigger->_target_tooth_gap_us = (3 * trigger->_shorter_tooth_gap) >> 1; 
 106:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 107:controller/engine_cycle/trigger.c ****   else
 108:controller/engine_cycle/trigger.c ****   {
 109:controller/engine_cycle/trigger.c ****     trigger->_target_tooth_gap_us = trigger->_shorter_tooth_gap * configuration.trigger.missing_tee
 110:controller/engine_cycle/trigger.c ****   } //Multiply by 2 (Checks for a gap 2x greater than the last one    
 111:controller/engine_cycle/trigger.c ****   
 112:controller/engine_cycle/trigger.c ****   //if( (_tooth_time_us[1] == 0) || (_tooth_time_us[2] == 0) ) { _current_tooth_gap_us = 0; } 
 113:controller/engine_cycle/trigger.c **** 
 114:controller/engine_cycle/trigger.c ****     
 115:controller/engine_cycle/trigger.c ****   if ((trigger->_current_tooth_gap_us > trigger->_target_tooth_gap_us) || (trigger->_counted_tooth 
 116:controller/engine_cycle/trigger.c ****   {
 117:controller/engine_cycle/trigger.c ****     //Missing tooth detected
 118:controller/engine_cycle/trigger.c ****     is_missing_teeth = true;
 119:controller/engine_cycle/trigger.c ****     /**
 120:controller/engine_cycle/trigger.c ****      * this means that we  have missed a few teeth for some reason
 121:controller/engine_cycle/trigger.c ****      */
 122:controller/engine_cycle/trigger.c ****     if (trigger->_counted_tooth < trigger->_trigger_actual_teeth)
 123:controller/engine_cycle/trigger.c ****     {
 124:controller/engine_cycle/trigger.c ****       trigger->sync_status = TS_NOT_SYNCED;
 125:controller/engine_cycle/trigger.c ****       trigger->sync_loss_counter++;
 126:controller/engine_cycle/trigger.c ****       engine.total_revolutions = 0;
 127:controller/engine_cycle/trigger.c ****       engine.rpm = 0;
 128:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 129:controller/engine_cycle/trigger.c ****     }
 130:controller/engine_cycle/trigger.c ****     else
 131:controller/engine_cycle/trigger.c ****     {
 132:controller/engine_cycle/trigger.c ****       trigger->sync_status = TS_FULLY_SYNCED;
 133:controller/engine_cycle/trigger.c ****       engine.total_revolutions++;
 134:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 135:controller/engine_cycle/trigger.c ****      //here we can say we are at TDC!
 136:controller/engine_cycle/trigger.c ****     }
 137:controller/engine_cycle/trigger.c ****   }
 138:controller/engine_cycle/trigger.c ****   
 139:controller/engine_cycle/trigger.c ****   engine.crankshaft_angle = 360.0f / (angle_t)configuration.trigger.full_teeth * (angle_t)trigger->
 140:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 141:controller/engine_cycle/trigger.c **** 
 142:controller/engine_cycle/trigger.c **** 
 143:controller/engine_cycle/trigger.c ****   if (trigger->sync_status == TS_FULLY_SYNCED && engine.rpm >= configuration.cranking_rpm_threshold
 144:controller/engine_cycle/trigger.c ****   {
 145:controller/engine_cycle/trigger.c ****     engine.spinning_state = SS_RUNNING;
 146:controller/engine_cycle/trigger.c ****   }
 147:controller/engine_cycle/trigger.c ****   else if (trigger->sync_status == TS_FULLY_SYNCED && engine.rpm < configuration.cranking_rpm_thres
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 7


 148:controller/engine_cycle/trigger.c ****   {
 149:controller/engine_cycle/trigger.c ****     engine.spinning_state = SS_CRANKING;
 150:controller/engine_cycle/trigger.c ****   }
 151:controller/engine_cycle/trigger.c ****   else if (trigger->sync_status == TS_NOT_SYNCED)
 152:controller/engine_cycle/trigger.c ****   {
 153:controller/engine_cycle/trigger.c ****     engine.spinning_state = SS_SPINNING_UP;
 154:controller/engine_cycle/trigger.c ****   }
 155:controller/engine_cycle/trigger.c ****   else
 156:controller/engine_cycle/trigger.c ****   {
 157:controller/engine_cycle/trigger.c ****     engine.spinning_state = SS_STOPPED;
 158:controller/engine_cycle/trigger.c ****   }
 159:controller/engine_cycle/trigger.c ****   
 160:controller/engine_cycle/trigger.c **** 
 161:controller/engine_cycle/trigger.c ****   /**
 162:controller/engine_cycle/trigger.c ****    * @todo make sure the filter cannot get stuck in any condition
 163:controller/engine_cycle/trigger.c ****    */
 164:controller/engine_cycle/trigger.c ****   if(is_missing_teeth == false)
 165:controller/engine_cycle/trigger.c ****   {
 166:controller/engine_cycle/trigger.c ****     //Regular (non-missing) tooth
 167:controller/engine_cycle/trigger.c ****     set_filtering(trigger); 
 168:controller/engine_cycle/trigger.c ****   }
 169:controller/engine_cycle/trigger.c ****   
 170:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[2] = trigger->_tooth_time_us[1];
 171:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[1] = trigger->_tooth_time_us[0];
 172:controller/engine_cycle/trigger.c **** 
 173:controller/engine_cycle/trigger.c ****   /* call trigger driven events such as ignition etc... */
 174:controller/engine_cycle/trigger.c ****   ignition_trigger_event_handle(crankshaft_get_angle(), crankshaft_get_rpm(), get_time_us());
 175:controller/engine_cycle/trigger.c **** 
 176:controller/engine_cycle/trigger.c **** }
 177:controller/engine_cycle/trigger.c **** 
 178:controller/engine_cycle/trigger.c **** 
 179:controller/engine_cycle/trigger.c **** rpm_t crankshaft_get_rpm()
 180:controller/engine_cycle/trigger.c **** {
 197              		.loc 1 180 1 is_stmt 1 view -0
 198              		.cfi_startproc
 199              		@ args = 0, pretend = 0, frame = 0
 200              		@ frame_needed = 0, uses_anonymous_args = 0
 201              		@ link register save eliminated.
 181:controller/engine_cycle/trigger.c ****   return engine.rpm;
 202              		.loc 1 181 3 view .LVU54
 182:controller/engine_cycle/trigger.c **** }
 203              		.loc 1 182 1 is_stmt 0 view .LVU55
 204 0000 014B     		ldr	r3, .L23
 205 0002 93ED030A 		vldr.32	s0, [r3, #12]
 206 0006 7047     		bx	lr
 207              	.L24:
 208              		.align	2
 209              	.L23:
 210 0008 00000000 		.word	engine
 211              		.cfi_endproc
 212              	.LFE231:
 214              		.section	.text.crankshaft_get_angle,"ax",%progbits
 215              		.align	1
 216              		.global	crankshaft_get_angle
 217              		.syntax unified
 218              		.thumb
 219              		.thumb_func
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 8


 221              	crankshaft_get_angle:
 222              	.LFB232:
 183:controller/engine_cycle/trigger.c **** 
 184:controller/engine_cycle/trigger.c **** /**
 185:controller/engine_cycle/trigger.c ****  * @brief returns the instant angle of the crankshaft
 186:controller/engine_cycle/trigger.c ****  * @note angle is updated on every trigger event!
 187:controller/engine_cycle/trigger.c ****  */
 188:controller/engine_cycle/trigger.c **** angle_t crankshaft_get_angle()
 189:controller/engine_cycle/trigger.c **** {
 223              		.loc 1 189 1 is_stmt 1 view -0
 224              		.cfi_startproc
 225              		@ args = 0, pretend = 0, frame = 0
 226              		@ frame_needed = 0, uses_anonymous_args = 0
 227              		@ link register save eliminated.
 190:controller/engine_cycle/trigger.c ****   return engine.crankshaft_angle;
 228              		.loc 1 190 3 view .LVU57
 191:controller/engine_cycle/trigger.c **** }
 229              		.loc 1 191 1 is_stmt 0 view .LVU58
 230 0000 014B     		ldr	r3, .L26
 231 0002 93ED010A 		vldr.32	s0, [r3, #4]
 232 0006 7047     		bx	lr
 233              	.L27:
 234              		.align	2
 235              	.L26:
 236 0008 00000000 		.word	engine
 237              		.cfi_endproc
 238              	.LFE232:
 240              		.section	.text.trigger_tooth_handle,"ax",%progbits
 241              		.align	1
 242              		.global	trigger_tooth_handle
 243              		.syntax unified
 244              		.thumb
 245              		.thumb_func
 247              	trigger_tooth_handle:
 248              	.LFB230:
  54:controller/engine_cycle/trigger.c **** 
 249              		.loc 1 54 1 is_stmt 1 view -0
 250              		.cfi_startproc
 251              		@ args = 0, pretend = 0, frame = 0
 252              		@ frame_needed = 0, uses_anonymous_args = 0
 253 0000 38B5     		push	{r3, r4, r5, lr}
 254              		.cfi_def_cfa_offset 16
 255              		.cfi_offset 3, -16
 256              		.cfi_offset 4, -12
 257              		.cfi_offset 5, -8
 258              		.cfi_offset 14, -4
 259 0002 2DED028B 		vpush.64	{d8}
 260              		.cfi_def_cfa_offset 24
 261              		.cfi_offset 80, -24
 262              		.cfi_offset 81, -20
  56:controller/engine_cycle/trigger.c ****   {
 263              		.loc 1 56 3 view .LVU60
  56:controller/engine_cycle/trigger.c ****   {
 264              		.loc 1 56 15 is_stmt 0 view .LVU61
 265 0006 5A4B     		ldr	r3, .L53
 266 0008 1C68     		ldr	r4, [r3]
 267 000a 2578     		ldrb	r5, [r4]	@ zero_extendqisi2
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 9


  56:controller/engine_cycle/trigger.c ****   {
 268              		.loc 1 56 6 view .LVU62
 269 000c 15B9     		cbnz	r5, .L48
 270              	.L28:
 176:controller/engine_cycle/trigger.c **** 
 271              		.loc 1 176 1 view .LVU63
 272 000e BDEC028B 		vldm	sp!, {d8}
 273              		.cfi_remember_state
 274              		.cfi_restore 80
 275              		.cfi_restore 81
 276              		.cfi_def_cfa_offset 16
 277 0012 38BD     		pop	{r3, r4, r5, pc}
 278              	.L48:
 279              		.cfi_restore_state
  64:controller/engine_cycle/trigger.c ****   trigger->_current_tooth_gap_us = trigger->_tooth_time_us[0] - trigger->_tooth_time_us[1];
 280              		.loc 1 64 3 is_stmt 1 view .LVU64
  64:controller/engine_cycle/trigger.c ****   trigger->_current_tooth_gap_us = trigger->_tooth_time_us[0] - trigger->_tooth_time_us[1];
 281              		.loc 1 64 32 is_stmt 0 view .LVU65
 282 0014 FFF7FEFF 		bl	get_time_us
 283              	.LVL7:
  64:controller/engine_cycle/trigger.c ****   trigger->_current_tooth_gap_us = trigger->_tooth_time_us[0] - trigger->_tooth_time_us[1];
 284              		.loc 1 64 30 discriminator 1 view .LVU66
 285 0018 A060     		str	r0, [r4, #8]
  65:controller/engine_cycle/trigger.c ****   
 286              		.loc 1 65 3 is_stmt 1 view .LVU67
  65:controller/engine_cycle/trigger.c ****   
 287              		.loc 1 65 43 is_stmt 0 view .LVU68
 288 001a 554B     		ldr	r3, .L53
 289 001c 1B68     		ldr	r3, [r3]
  65:controller/engine_cycle/trigger.c ****   
 290              		.loc 1 65 59 view .LVU69
 291 001e 9A68     		ldr	r2, [r3, #8]
  65:controller/engine_cycle/trigger.c ****   
 292              		.loc 1 65 88 view .LVU70
 293 0020 D868     		ldr	r0, [r3, #12]
  65:controller/engine_cycle/trigger.c ****   
 294              		.loc 1 65 63 view .LVU71
 295 0022 121A     		subs	r2, r2, r0
  65:controller/engine_cycle/trigger.c ****   
 296              		.loc 1 65 34 view .LVU72
 297 0024 5A61     		str	r2, [r3, #20]
  67:controller/engine_cycle/trigger.c ****   {
 298              		.loc 1 67 3 is_stmt 1 view .LVU73
  67:controller/engine_cycle/trigger.c ****   {
 299              		.loc 1 67 47 is_stmt 0 view .LVU74
 300 0026 5968     		ldr	r1, [r3, #4]
  67:controller/engine_cycle/trigger.c ****   {
 301              		.loc 1 67 6 view .LVU75
 302 0028 8A42     		cmp	r2, r1
 303 002a F0D3     		bcc	.L28
  74:controller/engine_cycle/trigger.c ****   
 304              		.loc 1 74 3 is_stmt 1 view .LVU76
  74:controller/engine_cycle/trigger.c ****   
 305              		.loc 1 74 10 is_stmt 0 view .LVU77
 306 002c 198C     		ldrh	r1, [r3, #32]
  74:controller/engine_cycle/trigger.c ****   
 307              		.loc 1 74 26 view .LVU78
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 10


 308 002e 0131     		adds	r1, r1, #1
 309 0030 89B2     		uxth	r1, r1
 310 0032 1984     		strh	r1, [r3, #32]	@ movhi
  76:controller/engine_cycle/trigger.c ****   
 311              		.loc 1 76 3 is_stmt 1 view .LVU79
 312              	.LVL8:
  79:controller/engine_cycle/trigger.c ****   {
 313              		.loc 1 79 3 view .LVU80
  82:controller/engine_cycle/trigger.c ****     
 314              		.loc 1 82 3 view .LVU81
  84:controller/engine_cycle/trigger.c **** 
 315              		.loc 1 84 3 view .LVU82
  86:controller/engine_cycle/trigger.c **** 
 316              		.loc 1 86 3 view .LVU83
  86:controller/engine_cycle/trigger.c **** 
 317              		.loc 1 86 76 is_stmt 0 view .LVU84
 318 0034 1C69     		ldr	r4, [r3, #16]
  86:controller/engine_cycle/trigger.c **** 
 319              		.loc 1 86 22 view .LVU85
 320 0036 001B     		subs	r0, r0, r4
 321              	.LVL9:
  89:controller/engine_cycle/trigger.c ****   {
 322              		.loc 1 89 3 is_stmt 1 view .LVU86
  89:controller/engine_cycle/trigger.c ****   {
 323              		.loc 1 89 6 is_stmt 0 view .LVU87
 324 0038 8242     		cmp	r2, r0
 325 003a 65D9     		bls	.L30
  94:controller/engine_cycle/trigger.c ****   }
 326              		.loc 1 94 5 is_stmt 1 view .LVU88
  94:controller/engine_cycle/trigger.c ****   }
 327              		.loc 1 94 33 is_stmt 0 view .LVU89
 328 003c 9861     		str	r0, [r3, #24]
 329              	.L31:
 103:controller/engine_cycle/trigger.c ****   {
 330              		.loc 1 103 3 is_stmt 1 view .LVU90
 103:controller/engine_cycle/trigger.c ****   {
 331              		.loc 1 103 27 is_stmt 0 view .LVU91
 332 003e 4D48     		ldr	r0, .L53+4
 333              	.LVL10:
 103:controller/engine_cycle/trigger.c ****   {
 334              		.loc 1 103 27 view .LVU92
 335 0040 007A     		ldrb	r0, [r0, #8]	@ zero_extendqisi2
 103:controller/engine_cycle/trigger.c ****   {
 336              		.loc 1 103 5 view .LVU93
 337 0042 0128     		cmp	r0, #1
 338 0044 62D0     		beq	.L49
 109:controller/engine_cycle/trigger.c ****   } //Multiply by 2 (Checks for a gap 2x greater than the last one    
 339              		.loc 1 109 5 is_stmt 1 view .LVU94
 109:controller/engine_cycle/trigger.c ****   } //Multiply by 2 (Checks for a gap 2x greater than the last one    
 340              		.loc 1 109 44 is_stmt 0 view .LVU95
 341 0046 9C69     		ldr	r4, [r3, #24]
 342              	.LVL11:
 109:controller/engine_cycle/trigger.c ****   } //Multiply by 2 (Checks for a gap 2x greater than the last one    
 343              		.loc 1 109 65 view .LVU96
 344 0048 00FB04F4 		mul	r4, r0, r4
 109:controller/engine_cycle/trigger.c ****   } //Multiply by 2 (Checks for a gap 2x greater than the last one    
 345              		.loc 1 109 35 view .LVU97
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 11


 346 004c DC61     		str	r4, [r3, #28]
 347              	.L33:
 115:controller/engine_cycle/trigger.c ****   {
 348              		.loc 1 115 3 is_stmt 1 view .LVU98
 115:controller/engine_cycle/trigger.c ****   {
 349              		.loc 1 115 48 is_stmt 0 view .LVU99
 350 004e D869     		ldr	r0, [r3, #28]
 115:controller/engine_cycle/trigger.c ****   {
 351              		.loc 1 115 6 view .LVU100
 352 0050 8242     		cmp	r2, r0
 353 0052 03D8     		bhi	.L34
 115:controller/engine_cycle/trigger.c ****   {
 354              		.loc 1 115 109 discriminator 1 view .LVU101
 355 0054 93F82220 		ldrb	r2, [r3, #34]	@ zero_extendqisi2
 115:controller/engine_cycle/trigger.c ****   {
 356              		.loc 1 115 72 discriminator 1 view .LVU102
 357 0058 9142     		cmp	r1, r2
 358 005a 68D9     		bls	.L44
 359              	.L34:
 118:controller/engine_cycle/trigger.c ****     /**
 360              		.loc 1 118 5 is_stmt 1 view .LVU103
 361              	.LVL12:
 122:controller/engine_cycle/trigger.c ****     {
 362              		.loc 1 122 5 view .LVU104
 122:controller/engine_cycle/trigger.c ****     {
 363              		.loc 1 122 42 is_stmt 0 view .LVU105
 364 005c 93F82220 		ldrb	r2, [r3, #34]	@ zero_extendqisi2
 122:controller/engine_cycle/trigger.c ****     {
 365              		.loc 1 122 8 view .LVU106
 366 0060 9142     		cmp	r1, r2
 367 0062 59D2     		bcs	.L36
 124:controller/engine_cycle/trigger.c ****       trigger->sync_loss_counter++;
 368              		.loc 1 124 7 is_stmt 1 view .LVU107
 124:controller/engine_cycle/trigger.c ****       trigger->sync_loss_counter++;
 369              		.loc 1 124 28 is_stmt 0 view .LVU108
 370 0064 0022     		movs	r2, #0
 371 0066 5A70     		strb	r2, [r3, #1]
 125:controller/engine_cycle/trigger.c ****       engine.total_revolutions = 0;
 372              		.loc 1 125 7 is_stmt 1 view .LVU109
 125:controller/engine_cycle/trigger.c ****       engine.total_revolutions = 0;
 373              		.loc 1 125 14 is_stmt 0 view .LVU110
 374 0068 4149     		ldr	r1, .L53
 375 006a 0868     		ldr	r0, [r1]
 376 006c 4388     		ldrh	r3, [r0, #2]
 377              	.LVL13:
 125:controller/engine_cycle/trigger.c ****       engine.total_revolutions = 0;
 378              		.loc 1 125 33 view .LVU111
 379 006e 0133     		adds	r3, r3, #1
 380 0070 4380     		strh	r3, [r0, #2]	@ movhi
 126:controller/engine_cycle/trigger.c ****       engine.rpm = 0;
 381              		.loc 1 126 7 is_stmt 1 view .LVU112
 126:controller/engine_cycle/trigger.c ****       engine.rpm = 0;
 382              		.loc 1 126 32 is_stmt 0 view .LVU113
 383 0072 414B     		ldr	r3, .L53+8
 384 0074 1A60     		str	r2, [r3]
 127:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 385              		.loc 1 127 7 is_stmt 1 view .LVU114
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 12


 127:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 386              		.loc 1 127 18 is_stmt 0 view .LVU115
 387 0076 0020     		movs	r0, #0
 388 0078 D860     		str	r0, [r3, #12]	@ float
 128:controller/engine_cycle/trigger.c ****     }
 389              		.loc 1 128 7 is_stmt 1 view .LVU116
 128:controller/engine_cycle/trigger.c ****     }
 390              		.loc 1 128 14 is_stmt 0 view .LVU117
 391 007a 0B68     		ldr	r3, [r1]
 128:controller/engine_cycle/trigger.c ****     }
 392              		.loc 1 128 31 view .LVU118
 393 007c 1A84     		strh	r2, [r3, #32]	@ movhi
 394              	.LVL14:
 395              	.L35:
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 396              		.loc 1 139 3 is_stmt 1 view .LVU119
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 397              		.loc 1 139 68 is_stmt 0 view .LVU120
 398 007e 3D4B     		ldr	r3, .L53+4
 399 0080 D979     		ldrb	r1, [r3, #7]	@ zero_extendqisi2
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 400              		.loc 1 139 38 view .LVU121
 401 0082 07EE901A 		vmov	s15, r1	@ int
 402 0086 B8EE677A 		vcvt.f32.u32	s14, s15
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 403              		.loc 1 139 36 view .LVU122
 404 008a DFED3C6A 		vldr.32	s13, .L53+12
 405 008e C6EE877A 		vdiv.f32	s15, s13, s14
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 406              		.loc 1 139 98 view .LVU123
 407 0092 374B     		ldr	r3, .L53
 408 0094 1868     		ldr	r0, [r3]
 409 0096 038C     		ldrh	r3, [r0, #32]
 410 0098 07EE103A 		vmov	s14, r3	@ int
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 411              		.loc 1 139 82 view .LVU124
 412 009c B8EE477A 		vcvt.f32.u32	s14, s14
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 413              		.loc 1 139 80 view .LVU125
 414 00a0 67EE877A 		vmul.f32	s15, s15, s14
 139:controller/engine_cycle/trigger.c ****   engine.rpm = (rpm_t)(CONVERSION_FACTOR_SECONDS_TO_MICROSECONDS * CONVERSION_FACTOR_MINUTES_TO_SEC
 415              		.loc 1 139 27 view .LVU126
 416 00a4 344A     		ldr	r2, .L53+8
 417 00a6 C2ED017A 		vstr.32	s15, [r2, #4]
 140:controller/engine_cycle/trigger.c **** 
 418              		.loc 1 140 3 is_stmt 1 view .LVU127
 140:controller/engine_cycle/trigger.c **** 
 419              		.loc 1 140 114 is_stmt 0 view .LVU128
 420 00aa 8469     		ldr	r4, [r0, #24]
 140:controller/engine_cycle/trigger.c **** 
 421              		.loc 1 140 105 view .LVU129
 422 00ac 344B     		ldr	r3, .L53+16
 423 00ae B3FBF4F3 		udiv	r3, r3, r4
 140:controller/engine_cycle/trigger.c **** 
 424              		.loc 1 140 135 view .LVU130
 425 00b2 B3FBF1F3 		udiv	r3, r3, r1
 140:controller/engine_cycle/trigger.c **** 
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 13


 426              		.loc 1 140 16 view .LVU131
 427 00b6 07EE903A 		vmov	s15, r3	@ int
 428 00ba F8EE677A 		vcvt.f32.u32	s15, s15
 140:controller/engine_cycle/trigger.c **** 
 429              		.loc 1 140 14 view .LVU132
 430 00be C2ED037A 		vstr.32	s15, [r2, #12]
 143:controller/engine_cycle/trigger.c ****   {
 431              		.loc 1 143 3 is_stmt 1 view .LVU133
 143:controller/engine_cycle/trigger.c ****   {
 432              		.loc 1 143 14 is_stmt 0 view .LVU134
 433 00c2 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 143:controller/engine_cycle/trigger.c ****   {
 434              		.loc 1 143 6 view .LVU135
 435 00c4 012B     		cmp	r3, #1
 436 00c6 34D0     		beq	.L50
 437              	.L37:
 147:controller/engine_cycle/trigger.c ****   {
 438              		.loc 1 147 8 is_stmt 1 view .LVU136
 147:controller/engine_cycle/trigger.c ****   {
 439              		.loc 1 147 11 is_stmt 0 view .LVU137
 440 00c8 012B     		cmp	r3, #1
 441 00ca 3ED0     		beq	.L51
 442              	.L40:
 151:controller/engine_cycle/trigger.c ****   {
 443              		.loc 1 151 8 is_stmt 1 view .LVU138
 151:controller/engine_cycle/trigger.c ****   {
 444              		.loc 1 151 11 is_stmt 0 view .LVU139
 445 00cc 002B     		cmp	r3, #0
 446 00ce 48D1     		bne	.L42
 153:controller/engine_cycle/trigger.c ****   }
 447              		.loc 1 153 5 is_stmt 1 view .LVU140
 153:controller/engine_cycle/trigger.c ****   }
 448              		.loc 1 153 27 is_stmt 0 view .LVU141
 449 00d0 294B     		ldr	r3, .L53+8
 450 00d2 0122     		movs	r2, #1
 451 00d4 5A74     		strb	r2, [r3, #17]
 452              	.L39:
 164:controller/engine_cycle/trigger.c ****   {
 453              		.loc 1 164 3 is_stmt 1 view .LVU142
 164:controller/engine_cycle/trigger.c ****   {
 454              		.loc 1 164 5 is_stmt 0 view .LVU143
 455 00d6 002D     		cmp	r5, #0
 456 00d8 47D0     		beq	.L52
 457              	.L43:
 170:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[1] = trigger->_tooth_time_us[0];
 458              		.loc 1 170 3 is_stmt 1 view .LVU144
 170:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[1] = trigger->_tooth_time_us[0];
 459              		.loc 1 170 39 is_stmt 0 view .LVU145
 460 00da 254B     		ldr	r3, .L53
 461 00dc 1B68     		ldr	r3, [r3]
 170:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[1] = trigger->_tooth_time_us[0];
 462              		.loc 1 170 55 view .LVU146
 463 00de DA68     		ldr	r2, [r3, #12]
 170:controller/engine_cycle/trigger.c ****   trigger->_tooth_time_us[1] = trigger->_tooth_time_us[0];
 464              		.loc 1 170 30 view .LVU147
 465 00e0 1A61     		str	r2, [r3, #16]
 171:controller/engine_cycle/trigger.c **** 
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 14


 466              		.loc 1 171 3 is_stmt 1 view .LVU148
 171:controller/engine_cycle/trigger.c **** 
 467              		.loc 1 171 55 is_stmt 0 view .LVU149
 468 00e2 9A68     		ldr	r2, [r3, #8]
 171:controller/engine_cycle/trigger.c **** 
 469              		.loc 1 171 30 view .LVU150
 470 00e4 DA60     		str	r2, [r3, #12]
 174:controller/engine_cycle/trigger.c **** 
 471              		.loc 1 174 3 is_stmt 1 view .LVU151
 472 00e6 FFF7FEFF 		bl	crankshaft_get_angle
 473              	.LVL15:
 474 00ea B0EE408A 		vmov.f32	s16, s0
 174:controller/engine_cycle/trigger.c **** 
 475              		.loc 1 174 3 is_stmt 0 discriminator 1 view .LVU152
 476 00ee FFF7FEFF 		bl	crankshaft_get_rpm
 477              	.LVL16:
 478 00f2 F0EE408A 		vmov.f32	s17, s0
 174:controller/engine_cycle/trigger.c **** 
 479              		.loc 1 174 3 discriminator 2 view .LVU153
 480 00f6 FFF7FEFF 		bl	get_time_us
 481              	.LVL17:
 174:controller/engine_cycle/trigger.c **** 
 482              		.loc 1 174 3 discriminator 3 view .LVU154
 483 00fa F0EE680A 		vmov.f32	s1, s17
 484 00fe B0EE480A 		vmov.f32	s0, s16
 485 0102 FFF7FEFF 		bl	ignition_trigger_event_handle
 486              	.LVL18:
 487 0106 82E7     		b	.L28
 488              	.LVL19:
 489              	.L30:
  98:controller/engine_cycle/trigger.c ****   }
 490              		.loc 1 98 5 is_stmt 1 view .LVU155
  98:controller/engine_cycle/trigger.c ****   }
 491              		.loc 1 98 33 is_stmt 0 view .LVU156
 492 0108 9A61     		str	r2, [r3, #24]
 493 010a 98E7     		b	.L31
 494              	.LVL20:
 495              	.L49:
 105:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 496              		.loc 1 105 5 is_stmt 1 view .LVU157
 105:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 497              		.loc 1 105 49 is_stmt 0 view .LVU158
 498 010c 9869     		ldr	r0, [r3, #24]
 105:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 499              		.loc 1 105 40 view .LVU159
 500 010e 00EB4000 		add	r0, r0, r0, lsl #1
 105:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 501              		.loc 1 105 71 view .LVU160
 502 0112 4008     		lsrs	r0, r0, #1
 105:controller/engine_cycle/trigger.c ****   } //Multiply by 1.5 (Checks for a gap 1.5x greater than the last one) (Uses bitshift to multiply 
 503              		.loc 1 105 35 view .LVU161
 504 0114 D861     		str	r0, [r3, #28]
 505 0116 9AE7     		b	.L33
 506              	.LVL21:
 507              	.L36:
 132:controller/engine_cycle/trigger.c ****       engine.total_revolutions++;
 508              		.loc 1 132 7 is_stmt 1 view .LVU162
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 15


 132:controller/engine_cycle/trigger.c ****       engine.total_revolutions++;
 509              		.loc 1 132 28 is_stmt 0 view .LVU163
 510 0118 0122     		movs	r2, #1
 511 011a 5A70     		strb	r2, [r3, #1]
 133:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 512              		.loc 1 133 7 is_stmt 1 view .LVU164
 133:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 513              		.loc 1 133 13 is_stmt 0 view .LVU165
 514 011c 164A     		ldr	r2, .L53+8
 515 011e 1368     		ldr	r3, [r2]
 516              	.LVL22:
 133:controller/engine_cycle/trigger.c ****       trigger->_counted_tooth = 0;
 517              		.loc 1 133 31 view .LVU166
 518 0120 0133     		adds	r3, r3, #1
 519 0122 1360     		str	r3, [r2]
 134:controller/engine_cycle/trigger.c ****      //here we can say we are at TDC!
 520              		.loc 1 134 7 is_stmt 1 view .LVU167
 134:controller/engine_cycle/trigger.c ****      //here we can say we are at TDC!
 521              		.loc 1 134 14 is_stmt 0 view .LVU168
 522 0124 124B     		ldr	r3, .L53
 523 0126 1B68     		ldr	r3, [r3]
 134:controller/engine_cycle/trigger.c ****      //here we can say we are at TDC!
 524              		.loc 1 134 31 view .LVU169
 525 0128 0022     		movs	r2, #0
 526 012a 1A84     		strh	r2, [r3, #32]	@ movhi
 134:controller/engine_cycle/trigger.c ****      //here we can say we are at TDC!
 527              		.loc 1 134 31 view .LVU170
 528 012c A7E7     		b	.L35
 529              	.LVL23:
 530              	.L44:
  76:controller/engine_cycle/trigger.c ****   
 531              		.loc 1 76 8 view .LVU171
 532 012e 0025     		movs	r5, #0
 533 0130 A5E7     		b	.L35
 534              	.LVL24:
 535              	.L50:
 143:controller/engine_cycle/trigger.c ****   {
 536              		.loc 1 143 77 discriminator 1 view .LVU172
 537 0132 104A     		ldr	r2, .L53+4
 538 0134 92ED037A 		vldr.32	s14, [r2, #12]
 143:controller/engine_cycle/trigger.c ****   {
 539              		.loc 1 143 47 discriminator 1 view .LVU173
 540 0138 F4EEC77A 		vcmpe.f32	s15, s14
 541 013c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 542 0140 C2DB     		blt	.L37
 145:controller/engine_cycle/trigger.c ****   }
 543              		.loc 1 145 5 is_stmt 1 view .LVU174
 145:controller/engine_cycle/trigger.c ****   }
 544              		.loc 1 145 27 is_stmt 0 view .LVU175
 545 0142 0D4B     		ldr	r3, .L53+8
 546 0144 0322     		movs	r2, #3
 547 0146 5A74     		strb	r2, [r3, #17]
 548 0148 C5E7     		b	.L39
 549              	.L51:
 147:controller/engine_cycle/trigger.c ****   {
 550              		.loc 1 147 81 discriminator 1 view .LVU176
 551 014a 0A4A     		ldr	r2, .L53+4
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 16


 552 014c 92ED037A 		vldr.32	s14, [r2, #12]
 147:controller/engine_cycle/trigger.c ****   {
 553              		.loc 1 147 52 discriminator 1 view .LVU177
 554 0150 F4EEC77A 		vcmpe.f32	s15, s14
 555 0154 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 556 0158 B8D5     		bpl	.L40
 149:controller/engine_cycle/trigger.c ****   }
 557              		.loc 1 149 5 is_stmt 1 view .LVU178
 149:controller/engine_cycle/trigger.c ****   }
 558              		.loc 1 149 27 is_stmt 0 view .LVU179
 559 015a 074B     		ldr	r3, .L53+8
 560 015c 0222     		movs	r2, #2
 561 015e 5A74     		strb	r2, [r3, #17]
 562 0160 B9E7     		b	.L39
 563              	.L42:
 157:controller/engine_cycle/trigger.c ****   }
 564              		.loc 1 157 5 is_stmt 1 view .LVU180
 157:controller/engine_cycle/trigger.c ****   }
 565              		.loc 1 157 27 is_stmt 0 view .LVU181
 566 0162 054B     		ldr	r3, .L53+8
 567 0164 0022     		movs	r2, #0
 568 0166 5A74     		strb	r2, [r3, #17]
 569 0168 B5E7     		b	.L39
 570              	.L52:
 167:controller/engine_cycle/trigger.c ****   }
 571              		.loc 1 167 5 is_stmt 1 view .LVU182
 572 016a FFF7FEFF 		bl	set_filtering
 573              	.LVL25:
 574 016e B4E7     		b	.L43
 575              	.L54:
 576              		.align	2
 577              	.L53:
 578 0170 00000000 		.word	trigger
 579 0174 00000000 		.word	configuration
 580 0178 00000000 		.word	engine
 581 017c 0000B443 		.word	1135869952
 582 0180 00879303 		.word	60000000
 583              		.cfi_endproc
 584              	.LFE230:
 586              		.global	trigger
 587              		.section	.bss.trigger,"aw",%nobits
 588              		.align	2
 591              	trigger:
 592 0000 00000000 		.space	4
 593              		.text
 594              	.Letext0:
 595              		.file 2 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 596              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 597              		.file 4 "controller/types.h"
 598              		.file 5 "controller/engine_cycle/trigger.h"
 599              		.file 6 "controller/enums.h"
 600              		.file 7 "controller/IO/analog_inputs.h"
 601              		.file 8 "controller/IO/sensors/tps.h"
 602              		.file 9 "controller/IO/thermistor.h"
 603              		.file 10 "controller/utils/pid.h"
 604              		.file 11 "controller/algorithm/governer.h"
 605              		.file 12 "controller/controller.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 17


 606              		.file 13 "controller/engine_cycle/ignition.h"
 607              		.file 14 "controller/utils/timing.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s 			page 18


DEFINED SYMBOLS
                            *ABS*:00000000 trigger.c
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:21     .text.set_filtering:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:27     .text.set_filtering:00000000 set_filtering
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:44     .text.set_filtering:0000000c $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:48     .text.set_filtering:00000010 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:97     .text.set_filtering:00000038 $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:102    .text.trigger_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:108    .text.trigger_init:00000000 trigger_init
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:183    .text.trigger_init:00000034 $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:591    .bss.trigger:00000000 trigger
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:189    .text.crankshaft_get_rpm:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:195    .text.crankshaft_get_rpm:00000000 crankshaft_get_rpm
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:210    .text.crankshaft_get_rpm:00000008 $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:215    .text.crankshaft_get_angle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:221    .text.crankshaft_get_angle:00000000 crankshaft_get_angle
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:236    .text.crankshaft_get_angle:00000008 $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:241    .text.trigger_tooth_handle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:247    .text.trigger_tooth_handle:00000000 trigger_tooth_handle
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:578    .text.trigger_tooth_handle:00000170 $d
C:\Users\alireza\AppData\Local\Temp\ccFRkyum.s:588    .bss.trigger:00000000 $d

UNDEFINED SYMBOLS
configuration
engine
get_time_us
ignition_trigger_event_handle
