ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"dc_motors.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/actuators/dc_motors.c"
  20              		.section	.text.dc_motor_set,"ax",%progbits
  21              		.align	1
  22              		.global	dc_motor_set
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	dc_motor_set:
  28              	.LVL0:
  29              	.LFB221:
   1:controller/actuators/dc_motors.c **** #include "dc_motors.h"
   2:controller/actuators/dc_motors.c **** 
   3:controller/actuators/dc_motors.c **** /**
   4:controller/actuators/dc_motors.c ****  * @brief inits the dc motor
   5:controller/actuators/dc_motors.c ****  * @todo complete documentation
   6:controller/actuators/dc_motors.c ****  * @param motor pointer to the dc_motor_s
   7:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
   8:controller/actuators/dc_motors.c ****  * @param timer_channel_output_1 which timer channel is connected to the first input of the driver
   9:controller/actuators/dc_motors.c ****  * @param timer_channel_output_2 which timer channel is connected to the second input of the driver
  10:controller/actuators/dc_motors.c ****  * @param frequency the desired pwm frequency
  11:controller/actuators/dc_motors.c ****  */
  12:controller/actuators/dc_motors.c **** void dc_motor_init(dc_motor_t *motor, TIM_HandleTypeDef *timer, uint32_t timer_channel_output_1, ui
  13:controller/actuators/dc_motors.c **** {
  14:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
  15:controller/actuators/dc_motors.c ****     {
  16:controller/actuators/dc_motors.c ****         return;
  17:controller/actuators/dc_motors.c ****         /**
  18:controller/actuators/dc_motors.c ****          * @todo throw an error
  19:controller/actuators/dc_motors.c ****          */
  20:controller/actuators/dc_motors.c ****     }
  21:controller/actuators/dc_motors.c **** 
  22:controller/actuators/dc_motors.c ****     motor->timer = timer;
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
  24:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
  25:controller/actuators/dc_motors.c **** 	motor->current_direction = MOTOR_DIRECTION_FORWARD;
  26:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_NORMAL;
  27:controller/actuators/dc_motors.c **** 
  28:controller/actuators/dc_motors.c **** 	/**
  29:controller/actuators/dc_motors.c **** 	 * Enable the timer using HAL
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 2


  30:controller/actuators/dc_motors.c **** 	 */
  31:controller/actuators/dc_motors.c **** 	HAL_TIM_Base_Start((TIM_HandleTypeDef *)motor->timer);
  32:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
  33:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  35:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  36:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
  37:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
  38:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
  39:controller/actuators/dc_motors.c **** }
  40:controller/actuators/dc_motors.c **** 
  41:controller/actuators/dc_motors.c **** 
  42:controller/actuators/dc_motors.c **** /**
  43:controller/actuators/dc_motors.c ****  * @brief sets the pwm duty cycle of the motor
  44:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
  45:controller/actuators/dc_motors.c ****  * @param dir the desired direction of the motor
  46:controller/actuators/dc_motors.c ****  * @param duty_cycle a number between 0 and 255 not a percentage
  47:controller/actuators/dc_motors.c ****  */
  48:controller/actuators/dc_motors.c **** void dc_motor_set(dc_motor_t *motor, dc_motor_direction_t dir, uint8_t duty_cycle)
  49:controller/actuators/dc_motors.c **** {
  30              		.loc 1 49 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  50:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  34              		.loc 1 50 2 view .LVU1
  35              		.loc 1 50 5 is_stmt 0 view .LVU2
  36 0000 0028     		cmp	r0, #0
  37 0002 00F09B80 		beq	.L30
  49:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  38              		.loc 1 49 1 view .LVU3
  39 0006 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  40              		.cfi_def_cfa_offset 32
  41              		.cfi_offset 3, -32
  42              		.cfi_offset 4, -28
  43              		.cfi_offset 5, -24
  44              		.cfi_offset 6, -20
  45              		.cfi_offset 7, -16
  46              		.cfi_offset 8, -12
  47              		.cfi_offset 9, -8
  48              		.cfi_offset 14, -4
  49 000a 0D46     		mov	r5, r1
  50 000c 1646     		mov	r6, r2
  51 000e 0446     		mov	r4, r0
  52              		.loc 1 50 28 discriminator 1 view .LVU4
  53 0010 0768     		ldr	r7, [r0]
  54              		.loc 1 50 20 discriminator 1 view .LVU5
  55 0012 002F     		cmp	r7, #0
  56 0014 2DD0     		beq	.L1
  51:controller/actuators/dc_motors.c **** 	{
  52:controller/actuators/dc_motors.c **** 		return;
  53:controller/actuators/dc_motors.c **** 		/**
  54:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  55:controller/actuators/dc_motors.c **** 		 */
  56:controller/actuators/dc_motors.c **** 	}
  57:controller/actuators/dc_motors.c **** 
  58:controller/actuators/dc_motors.c **** 	if (duty_cycle < 0 || duty_cycle > 255)
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 3


  57              		.loc 1 58 2 is_stmt 1 view .LVU6
  59:controller/actuators/dc_motors.c **** 	{
  60:controller/actuators/dc_motors.c **** 		return;
  61:controller/actuators/dc_motors.c **** 	}
  62:controller/actuators/dc_motors.c **** 	// Map duty cycle (0-255) to timer compare value
  63:controller/actuators/dc_motors.c **** 	uint32_t compare_value = (uint32_t)((duty_cycle / 255.0) * __HAL_TIM_GET_AUTORELOAD((TIM_HandleTyp
  58              		.loc 1 63 2 view .LVU7
  59              		.loc 1 63 50 is_stmt 0 view .LVU8
  60 0016 1046     		mov	r0, r2
  61              	.LVL1:
  62              		.loc 1 63 50 view .LVU9
  63 0018 FFF7FEFF 		bl	__aeabi_i2d
  64              	.LVL2:
  65              		.loc 1 63 50 view .LVU10
  66 001c 48A3     		adr	r3, .L45
  67 001e D3E90023 		ldrd	r2, [r3]
  68 0022 FFF7FEFF 		bl	__aeabi_ddiv
  69              	.LVL3:
  70 0026 8046     		mov	r8, r0
  71 0028 8946     		mov	r9, r1
  72              		.loc 1 63 61 view .LVU11
  73 002a 3F68     		ldr	r7, [r7]
  74 002c F86A     		ldr	r0, [r7, #44]
  75              		.loc 1 63 59 view .LVU12
  76 002e FFF7FEFF 		bl	__aeabi_ui2d
  77              	.LVL4:
  78 0032 4246     		mov	r2, r8
  79 0034 4B46     		mov	r3, r9
  80 0036 FFF7FEFF 		bl	__aeabi_dmul
  81              	.LVL5:
  82              		.loc 1 63 11 view .LVU13
  83 003a FFF7FEFF 		bl	__aeabi_d2uiz
  84              	.LVL6:
  64:controller/actuators/dc_motors.c **** 	
  65:controller/actuators/dc_motors.c **** 	switch (dir)
  85              		.loc 1 65 2 is_stmt 1 view .LVU14
  86 003e 6DB1     		cbz	r5, .L3
  87 0040 012D     		cmp	r5, #1
  88 0042 35D0     		beq	.L4
  66:controller/actuators/dc_motors.c **** 	{
  67:controller/actuators/dc_motors.c **** 	case MOTOR_DIRECTION_FORWARD:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, compare_v
  69:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  70:controller/actuators/dc_motors.c **** 		break;
  71:controller/actuators/dc_motors.c **** 	case MOTOR_DIRECTION_REVERSE:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  73:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
  74:controller/actuators/dc_motors.c **** 		break;
  75:controller/actuators/dc_motors.c **** 	default:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  89              		.loc 1 76 3 view .LVU15
  90 0044 6368     		ldr	r3, [r4, #4]
  91 0046 002B     		cmp	r3, #0
  92 0048 58D1     		bne	.L21
  93              		.loc 1 76 3 is_stmt 0 discriminator 1 view .LVU16
  94 004a 7B63     		str	r3, [r7, #52]
  95              	.L22:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 4


  77:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  96              		.loc 1 77 3 is_stmt 1 view .LVU17
  97 004c A368     		ldr	r3, [r4, #8]
  98 004e 002B     		cmp	r3, #0
  99 0050 61D1     		bne	.L25
 100              		.loc 1 77 3 is_stmt 0 discriminator 1 view .LVU18
 101 0052 2368     		ldr	r3, [r4]
 102 0054 1B68     		ldr	r3, [r3]
 103 0056 0022     		movs	r2, #0
 104 0058 5A63     		str	r2, [r3, #52]
 105 005a 08E0     		b	.L11
 106              	.L3:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 107              		.loc 1 68 3 is_stmt 1 view .LVU19
 108 005c 6368     		ldr	r3, [r4, #4]
 109 005e 53B9     		cbnz	r3, .L6
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 110              		.loc 1 68 3 is_stmt 0 discriminator 1 view .LVU20
 111 0060 7863     		str	r0, [r7, #52]
 112              	.L7:
  69:controller/actuators/dc_motors.c **** 		break;
 113              		.loc 1 69 3 is_stmt 1 view .LVU21
 114 0062 A368     		ldr	r3, [r4, #8]
 115 0064 8BB9     		cbnz	r3, .L10
  69:controller/actuators/dc_motors.c **** 		break;
 116              		.loc 1 69 3 is_stmt 0 discriminator 1 view .LVU22
 117 0066 2368     		ldr	r3, [r4]
 118 0068 1B68     		ldr	r3, [r3]
 119 006a 0022     		movs	r2, #0
 120 006c 5A63     		str	r2, [r3, #52]
 121              	.L11:
  78:controller/actuators/dc_motors.c **** 		/**
  79:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  80:controller/actuators/dc_motors.c **** 		 */
  81:controller/actuators/dc_motors.c **** 		break;
  82:controller/actuators/dc_motors.c **** 	}
  83:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = duty_cycle;
 122              		.loc 1 83 2 is_stmt 1 view .LVU23
 123              		.loc 1 83 28 is_stmt 0 view .LVU24
 124 006e 6673     		strb	r6, [r4, #13]
  84:controller/actuators/dc_motors.c **** 	motor->current_direction = dir;
 125              		.loc 1 84 2 is_stmt 1 view .LVU25
 126              		.loc 1 84 27 is_stmt 0 view .LVU26
 127 0070 2573     		strb	r5, [r4, #12]
 128              	.LVL7:
 129              	.L1:
  85:controller/actuators/dc_motors.c **** }
 130              		.loc 1 85 1 view .LVU27
 131 0072 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 132              	.LVL8:
 133              	.L6:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 134              		.loc 1 68 3 discriminator 2 view .LVU28
 135 0076 042B     		cmp	r3, #4
 136 0078 03D0     		beq	.L33
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 137              		.loc 1 68 3 discriminator 4 view .LVU29
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 5


 138 007a 082B     		cmp	r3, #8
 139 007c 03D0     		beq	.L34
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 140              		.loc 1 68 3 discriminator 7 view .LVU30
 141 007e 3864     		str	r0, [r7, #64]
 142 0080 EFE7     		b	.L7
 143              	.L33:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 144              		.loc 1 68 3 discriminator 3 view .LVU31
 145 0082 B863     		str	r0, [r7, #56]
 146 0084 EDE7     		b	.L7
 147              	.L34:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 148              		.loc 1 68 3 discriminator 6 view .LVU32
 149 0086 F863     		str	r0, [r7, #60]
 150 0088 EBE7     		b	.L7
 151              	.L10:
  69:controller/actuators/dc_motors.c **** 		break;
 152              		.loc 1 69 3 discriminator 2 view .LVU33
 153 008a 042B     		cmp	r3, #4
 154 008c 06D0     		beq	.L35
  69:controller/actuators/dc_motors.c **** 		break;
 155              		.loc 1 69 3 discriminator 4 view .LVU34
 156 008e 082B     		cmp	r3, #8
 157 0090 09D0     		beq	.L36
  69:controller/actuators/dc_motors.c **** 		break;
 158              		.loc 1 69 3 discriminator 7 view .LVU35
 159 0092 2368     		ldr	r3, [r4]
 160 0094 1B68     		ldr	r3, [r3]
 161 0096 0022     		movs	r2, #0
 162 0098 1A64     		str	r2, [r3, #64]
 163 009a E8E7     		b	.L11
 164              	.L35:
  69:controller/actuators/dc_motors.c **** 		break;
 165              		.loc 1 69 3 discriminator 3 view .LVU36
 166 009c 2368     		ldr	r3, [r4]
 167 009e 1B68     		ldr	r3, [r3]
 168 00a0 0022     		movs	r2, #0
 169 00a2 9A63     		str	r2, [r3, #56]
 170 00a4 E3E7     		b	.L11
 171              	.L36:
  69:controller/actuators/dc_motors.c **** 		break;
 172              		.loc 1 69 3 discriminator 6 view .LVU37
 173 00a6 2368     		ldr	r3, [r4]
 174 00a8 1B68     		ldr	r3, [r3]
 175 00aa 0022     		movs	r2, #0
 176 00ac DA63     		str	r2, [r3, #60]
 177 00ae DEE7     		b	.L11
 178              	.L4:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 179              		.loc 1 72 3 is_stmt 1 view .LVU38
 180 00b0 6368     		ldr	r3, [r4, #4]
 181 00b2 33B9     		cbnz	r3, .L14
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 182              		.loc 1 72 3 is_stmt 0 discriminator 1 view .LVU39
 183 00b4 7B63     		str	r3, [r7, #52]
 184              	.L15:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 6


  73:controller/actuators/dc_motors.c **** 		break;
 185              		.loc 1 73 3 is_stmt 1 view .LVU40
 186 00b6 A368     		ldr	r3, [r4, #8]
 187 00b8 83B9     		cbnz	r3, .L18
  73:controller/actuators/dc_motors.c **** 		break;
 188              		.loc 1 73 3 is_stmt 0 discriminator 1 view .LVU41
 189 00ba 2368     		ldr	r3, [r4]
 190 00bc 1B68     		ldr	r3, [r3]
 191 00be 5863     		str	r0, [r3, #52]
 192 00c0 D5E7     		b	.L11
 193              	.L14:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 194              		.loc 1 72 3 discriminator 2 view .LVU42
 195 00c2 042B     		cmp	r3, #4
 196 00c4 04D0     		beq	.L37
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 197              		.loc 1 72 3 discriminator 4 view .LVU43
 198 00c6 082B     		cmp	r3, #8
 199 00c8 05D0     		beq	.L38
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 200              		.loc 1 72 3 discriminator 7 view .LVU44
 201 00ca 0023     		movs	r3, #0
 202 00cc 3B64     		str	r3, [r7, #64]
 203 00ce F2E7     		b	.L15
 204              	.L37:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 205              		.loc 1 72 3 discriminator 3 view .LVU45
 206 00d0 0023     		movs	r3, #0
 207 00d2 BB63     		str	r3, [r7, #56]
 208 00d4 EFE7     		b	.L15
 209              	.L38:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 210              		.loc 1 72 3 discriminator 6 view .LVU46
 211 00d6 0023     		movs	r3, #0
 212 00d8 FB63     		str	r3, [r7, #60]
 213 00da ECE7     		b	.L15
 214              	.L18:
  73:controller/actuators/dc_motors.c **** 		break;
 215              		.loc 1 73 3 discriminator 2 view .LVU47
 216 00dc 042B     		cmp	r3, #4
 217 00de 05D0     		beq	.L39
  73:controller/actuators/dc_motors.c **** 		break;
 218              		.loc 1 73 3 discriminator 4 view .LVU48
 219 00e0 082B     		cmp	r3, #8
 220 00e2 07D0     		beq	.L40
  73:controller/actuators/dc_motors.c **** 		break;
 221              		.loc 1 73 3 discriminator 7 view .LVU49
 222 00e4 2368     		ldr	r3, [r4]
 223 00e6 1B68     		ldr	r3, [r3]
 224 00e8 1864     		str	r0, [r3, #64]
 225 00ea C0E7     		b	.L11
 226              	.L39:
  73:controller/actuators/dc_motors.c **** 		break;
 227              		.loc 1 73 3 discriminator 3 view .LVU50
 228 00ec 2368     		ldr	r3, [r4]
 229 00ee 1B68     		ldr	r3, [r3]
 230 00f0 9863     		str	r0, [r3, #56]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 7


 231 00f2 BCE7     		b	.L11
 232              	.L40:
  73:controller/actuators/dc_motors.c **** 		break;
 233              		.loc 1 73 3 discriminator 6 view .LVU51
 234 00f4 2368     		ldr	r3, [r4]
 235 00f6 1B68     		ldr	r3, [r3]
 236 00f8 D863     		str	r0, [r3, #60]
 237 00fa B8E7     		b	.L11
 238              	.L21:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 239              		.loc 1 76 3 discriminator 2 view .LVU52
 240 00fc 042B     		cmp	r3, #4
 241 00fe 04D0     		beq	.L41
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 242              		.loc 1 76 3 discriminator 4 view .LVU53
 243 0100 082B     		cmp	r3, #8
 244 0102 05D0     		beq	.L42
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 245              		.loc 1 76 3 discriminator 7 view .LVU54
 246 0104 0023     		movs	r3, #0
 247 0106 3B64     		str	r3, [r7, #64]
 248 0108 A0E7     		b	.L22
 249              	.L41:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 250              		.loc 1 76 3 discriminator 3 view .LVU55
 251 010a 0023     		movs	r3, #0
 252 010c BB63     		str	r3, [r7, #56]
 253 010e 9DE7     		b	.L22
 254              	.L42:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 255              		.loc 1 76 3 discriminator 6 view .LVU56
 256 0110 0023     		movs	r3, #0
 257 0112 FB63     		str	r3, [r7, #60]
 258 0114 9AE7     		b	.L22
 259              	.L25:
  77:controller/actuators/dc_motors.c **** 		/**
 260              		.loc 1 77 3 discriminator 2 view .LVU57
 261 0116 042B     		cmp	r3, #4
 262 0118 06D0     		beq	.L43
  77:controller/actuators/dc_motors.c **** 		/**
 263              		.loc 1 77 3 discriminator 4 view .LVU58
 264 011a 082B     		cmp	r3, #8
 265 011c 09D0     		beq	.L44
  77:controller/actuators/dc_motors.c **** 		/**
 266              		.loc 1 77 3 discriminator 7 view .LVU59
 267 011e 2368     		ldr	r3, [r4]
 268 0120 1B68     		ldr	r3, [r3]
 269 0122 0022     		movs	r2, #0
 270 0124 1A64     		str	r2, [r3, #64]
 271 0126 A2E7     		b	.L11
 272              	.L43:
  77:controller/actuators/dc_motors.c **** 		/**
 273              		.loc 1 77 3 discriminator 3 view .LVU60
 274 0128 2368     		ldr	r3, [r4]
 275 012a 1B68     		ldr	r3, [r3]
 276 012c 0022     		movs	r2, #0
 277 012e 9A63     		str	r2, [r3, #56]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 8


 278 0130 9DE7     		b	.L11
 279              	.L44:
  77:controller/actuators/dc_motors.c **** 		/**
 280              		.loc 1 77 3 discriminator 6 view .LVU61
 281 0132 2368     		ldr	r3, [r4]
 282 0134 1B68     		ldr	r3, [r3]
 283 0136 0022     		movs	r2, #0
 284 0138 DA63     		str	r2, [r3, #60]
 285 013a 98E7     		b	.L11
 286              	.LVL9:
 287              	.L30:
 288              		.cfi_def_cfa_offset 0
 289              		.cfi_restore 3
 290              		.cfi_restore 4
 291              		.cfi_restore 5
 292              		.cfi_restore 6
 293              		.cfi_restore 7
 294              		.cfi_restore 8
 295              		.cfi_restore 9
 296              		.cfi_restore 14
  77:controller/actuators/dc_motors.c **** 		/**
 297              		.loc 1 77 3 discriminator 6 view .LVU62
 298 013c 7047     		bx	lr
 299              	.L46:
 300 013e 00BF     		.align	3
 301              	.L45:
 302 0140 00000000 		.word	0
 303 0144 00E06F40 		.word	1081073664
 304              		.cfi_endproc
 305              	.LFE221:
 307              		.section	.text.dc_motor_disable,"ax",%progbits
 308              		.align	1
 309              		.global	dc_motor_disable
 310              		.syntax unified
 311              		.thumb
 312              		.thumb_func
 314              	dc_motor_disable:
 315              	.LVL10:
 316              	.LFB223:
  86:controller/actuators/dc_motors.c **** 
  87:controller/actuators/dc_motors.c **** /**
  88:controller/actuators/dc_motors.c ****  * @brief sets the pwm frequency
  89:controller/actuators/dc_motors.c ****  * @note this changes the frequency of the entire timer, this includes all four channels
  90:controller/actuators/dc_motors.c ****  */
  91:controller/actuators/dc_motors.c **** void dc_motor_set_timer_freq(dc_motor_t *motor, pwm_freq_t frequency)
  92:controller/actuators/dc_motors.c **** {
  93:controller/actuators/dc_motors.c **** 	if (frequency == 0)
  94:controller/actuators/dc_motors.c **** 	{
  95:controller/actuators/dc_motors.c **** 		// Invalid frequency, return or handle error
  96:controller/actuators/dc_motors.c **** 		dc_motor_disable(motor);
  97:controller/actuators/dc_motors.c **** 		return;
  98:controller/actuators/dc_motors.c **** 	}
  99:controller/actuators/dc_motors.c **** 	if (frequency > DC_MOTOR_MAX_FREQUENCY)
 100:controller/actuators/dc_motors.c **** 	{
 101:controller/actuators/dc_motors.c **** 		frequency = DC_MOTOR_MAX_FREQUENCY;
 102:controller/actuators/dc_motors.c **** 	}
 103:controller/actuators/dc_motors.c **** 	
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 9


 104:controller/actuators/dc_motors.c **** 	uint32_t timer_clock = HAL_RCC_GetSysClockFreq(); // Get the timer clock frequency
 105:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 106:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 107:controller/actuators/dc_motors.c **** 
 108:controller/actuators/dc_motors.c **** 	// Calculate prescaler and auto-reload values
 109:controller/actuators/dc_motors.c **** 	for (prescaler = 0; prescaler <= 0xFFFF; prescaler++)
 110:controller/actuators/dc_motors.c **** 	{
 111:controller/actuators/dc_motors.c **** 		auto_reload = (timer_clock / ((prescaler + 1) * frequency)) - 1;
 112:controller/actuators/dc_motors.c **** 		
 113:controller/actuators/dc_motors.c **** 		if (auto_reload <= 0xFFFF)
 114:controller/actuators/dc_motors.c **** 		{
 115:controller/actuators/dc_motors.c **** 			break;
 116:controller/actuators/dc_motors.c **** 
 117:controller/actuators/dc_motors.c **** 		}
 118:controller/actuators/dc_motors.c **** 	}
 119:controller/actuators/dc_motors.c **** 
 120:controller/actuators/dc_motors.c **** 	if (prescaler > 0xFFFF || auto_reload > 0xFFFF)
 121:controller/actuators/dc_motors.c **** 	{
 122:controller/actuators/dc_motors.c **** 		// Frequency is too low, cannot configure timer
 123:controller/actuators/dc_motors.c **** 		return;
 124:controller/actuators/dc_motors.c **** 	}
 125:controller/actuators/dc_motors.c **** 	
 126:controller/actuators/dc_motors.c **** 	// Set the prescaler and auto-reload values
 127:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_PRESCALER((TIM_HandleTypeDef *)motor->timer, prescaler);
 128:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 129:controller/actuators/dc_motors.c **** 
 130:controller/actuators/dc_motors.c **** 	dc_motor_set(motor, motor->current_direction, motor->current_duty_cycle);
 131:controller/actuators/dc_motors.c **** }
 132:controller/actuators/dc_motors.c **** 
 133:controller/actuators/dc_motors.c **** /**
 134:controller/actuators/dc_motors.c ****  * @brief disables the motor.
 135:controller/actuators/dc_motors.c ****  */
 136:controller/actuators/dc_motors.c **** void dc_motor_disable(dc_motor_t *motor)
 137:controller/actuators/dc_motors.c **** {
 317              		.loc 1 137 1 is_stmt 1 view -0
 318              		.cfi_startproc
 319              		@ args = 0, pretend = 0, frame = 0
 320              		@ frame_needed = 0, uses_anonymous_args = 0
 321              		@ link register save eliminated.
 138:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
 322              		.loc 1 138 2 view .LVU64
 323              		.loc 1 138 5 is_stmt 0 view .LVU65
 324 0000 0346     		mov	r3, r0
 325 0002 78B1     		cbz	r0, .L47
 326              		.loc 1 138 28 discriminator 1 view .LVU66
 327 0004 0268     		ldr	r2, [r0]
 328              		.loc 1 138 20 discriminator 1 view .LVU67
 329 0006 6AB1     		cbz	r2, .L47
 139:controller/actuators/dc_motors.c **** 	{
 140:controller/actuators/dc_motors.c **** 		return;
 141:controller/actuators/dc_motors.c **** 		/**
 142:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 143:controller/actuators/dc_motors.c **** 		 */
 144:controller/actuators/dc_motors.c **** 	}
 145:controller/actuators/dc_motors.c **** 
 146:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 10


 330              		.loc 1 147 2 is_stmt 1 view .LVU68
 331 0008 4168     		ldr	r1, [r0, #4]
 332 000a 61B9     		cbnz	r1, .L49
 333              		.loc 1 147 2 is_stmt 0 discriminator 1 view .LVU69
 334 000c 1268     		ldr	r2, [r2]
 335 000e 5163     		str	r1, [r2, #52]
 336              	.L50:
 148:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 337              		.loc 1 148 2 is_stmt 1 view .LVU70
 338 0010 9A68     		ldr	r2, [r3, #8]
 339 0012 C2B9     		cbnz	r2, .L53
 340              		.loc 1 148 2 is_stmt 0 discriminator 1 view .LVU71
 341 0014 1A68     		ldr	r2, [r3]
 342 0016 1268     		ldr	r2, [r2]
 343 0018 0021     		movs	r1, #0
 344 001a 5163     		str	r1, [r2, #52]
 345              	.L54:
 149:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 346              		.loc 1 149 2 is_stmt 1 view .LVU72
 347              		.loc 1 149 28 is_stmt 0 view .LVU73
 348 001c 0022     		movs	r2, #0
 349 001e 5A73     		strb	r2, [r3, #13]
 150:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_DISABLED;
 350              		.loc 1 150 2 is_stmt 1 view .LVU74
 351              		.loc 1 150 16 is_stmt 0 view .LVU75
 352 0020 0222     		movs	r2, #2
 353 0022 9A73     		strb	r2, [r3, #14]
 354              	.L47:
 151:controller/actuators/dc_motors.c **** }
 355              		.loc 1 151 1 view .LVU76
 356 0024 7047     		bx	lr
 357              	.L49:
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 358              		.loc 1 147 2 discriminator 2 view .LVU77
 359 0026 0429     		cmp	r1, #4
 360 0028 05D0     		beq	.L57
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 361              		.loc 1 147 2 discriminator 4 view .LVU78
 362 002a 0829     		cmp	r1, #8
 363 002c 07D0     		beq	.L58
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 364              		.loc 1 147 2 discriminator 7 view .LVU79
 365 002e 1268     		ldr	r2, [r2]
 366 0030 0021     		movs	r1, #0
 367 0032 1164     		str	r1, [r2, #64]
 368 0034 ECE7     		b	.L50
 369              	.L57:
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 370              		.loc 1 147 2 discriminator 3 view .LVU80
 371 0036 1268     		ldr	r2, [r2]
 372 0038 0021     		movs	r1, #0
 373 003a 9163     		str	r1, [r2, #56]
 374 003c E8E7     		b	.L50
 375              	.L58:
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 376              		.loc 1 147 2 discriminator 6 view .LVU81
 377 003e 1268     		ldr	r2, [r2]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 11


 378 0040 0021     		movs	r1, #0
 379 0042 D163     		str	r1, [r2, #60]
 380 0044 E4E7     		b	.L50
 381              	.L53:
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 382              		.loc 1 148 2 discriminator 2 view .LVU82
 383 0046 042A     		cmp	r2, #4
 384 0048 06D0     		beq	.L59
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 385              		.loc 1 148 2 discriminator 4 view .LVU83
 386 004a 082A     		cmp	r2, #8
 387 004c 09D0     		beq	.L60
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 388              		.loc 1 148 2 discriminator 7 view .LVU84
 389 004e 1A68     		ldr	r2, [r3]
 390 0050 1268     		ldr	r2, [r2]
 391 0052 0021     		movs	r1, #0
 392 0054 1164     		str	r1, [r2, #64]
 393 0056 E1E7     		b	.L54
 394              	.L59:
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 395              		.loc 1 148 2 discriminator 3 view .LVU85
 396 0058 1A68     		ldr	r2, [r3]
 397 005a 1268     		ldr	r2, [r2]
 398 005c 0021     		movs	r1, #0
 399 005e 9163     		str	r1, [r2, #56]
 400 0060 DCE7     		b	.L54
 401              	.L60:
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 402              		.loc 1 148 2 discriminator 6 view .LVU86
 403 0062 1A68     		ldr	r2, [r3]
 404 0064 1268     		ldr	r2, [r2]
 405 0066 0021     		movs	r1, #0
 406 0068 D163     		str	r1, [r2, #60]
 407 006a D7E7     		b	.L54
 408              		.cfi_endproc
 409              	.LFE223:
 411              		.section	.text.dc_motor_set_timer_freq,"ax",%progbits
 412              		.align	1
 413              		.global	dc_motor_set_timer_freq
 414              		.syntax unified
 415              		.thumb
 416              		.thumb_func
 418              	dc_motor_set_timer_freq:
 419              	.LVL11:
 420              	.LFB222:
  92:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 421              		.loc 1 92 1 is_stmt 1 view -0
 422              		.cfi_startproc
 423              		@ args = 0, pretend = 0, frame = 0
 424              		@ frame_needed = 0, uses_anonymous_args = 0
  92:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 425              		.loc 1 92 1 is_stmt 0 view .LVU88
 426 0000 38B5     		push	{r3, r4, r5, lr}
 427              		.cfi_def_cfa_offset 16
 428              		.cfi_offset 3, -16
 429              		.cfi_offset 4, -12
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 12


 430              		.cfi_offset 5, -8
 431              		.cfi_offset 14, -4
 432 0002 0546     		mov	r5, r0
  93:controller/actuators/dc_motors.c **** 	{
 433              		.loc 1 93 2 is_stmt 1 view .LVU89
  93:controller/actuators/dc_motors.c **** 	{
 434              		.loc 1 93 5 is_stmt 0 view .LVU90
 435 0004 99B1     		cbz	r1, .L69
 436 0006 0C46     		mov	r4, r1
  99:controller/actuators/dc_motors.c **** 	{
 437              		.loc 1 99 2 is_stmt 1 view .LVU91
  99:controller/actuators/dc_motors.c **** 	{
 438              		.loc 1 99 5 is_stmt 0 view .LVU92
 439 0008 42F21073 		movw	r3, #10000
 440 000c 9942     		cmp	r1, r3
 441 000e 00D9     		bls	.L64
 101:controller/actuators/dc_motors.c **** 	}
 442              		.loc 1 101 13 view .LVU93
 443 0010 1C46     		mov	r4, r3
 444              	.L64:
 445              	.LVL12:
 104:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 446              		.loc 1 104 2 is_stmt 1 view .LVU94
 104:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 447              		.loc 1 104 25 is_stmt 0 view .LVU95
 448 0012 FFF7FEFF 		bl	HAL_RCC_GetSysClockFreq
 449              	.LVL13:
 105:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 450              		.loc 1 105 2 is_stmt 1 view .LVU96
 106:controller/actuators/dc_motors.c **** 
 451              		.loc 1 106 2 view .LVU97
 109:controller/actuators/dc_motors.c **** 	{
 452              		.loc 1 109 2 view .LVU98
 109:controller/actuators/dc_motors.c **** 	{
 453              		.loc 1 109 17 is_stmt 0 view .LVU99
 454 0016 0022     		movs	r2, #0
 455              	.LVL14:
 456              	.L66:
 111:controller/actuators/dc_motors.c **** 		
 457              		.loc 1 111 3 is_stmt 1 view .LVU100
 111:controller/actuators/dc_motors.c **** 		
 458              		.loc 1 111 49 is_stmt 0 view .LVU101
 459 0018 02FB0443 		mla	r3, r2, r4, r4
 111:controller/actuators/dc_motors.c **** 		
 460              		.loc 1 111 30 view .LVU102
 461 001c B0FBF3F3 		udiv	r3, r0, r3
 111:controller/actuators/dc_motors.c **** 		
 462              		.loc 1 111 15 view .LVU103
 463 0020 013B     		subs	r3, r3, #1
 464              	.LVL15:
 113:controller/actuators/dc_motors.c **** 		{
 465              		.loc 1 113 3 is_stmt 1 view .LVU104
 113:controller/actuators/dc_motors.c **** 		{
 466              		.loc 1 113 6 is_stmt 0 view .LVU105
 467 0022 B3F5803F 		cmp	r3, #65536
 468 0026 05D3     		bcc	.L65
 109:controller/actuators/dc_motors.c **** 	{
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 13


 469              		.loc 1 109 52 is_stmt 1 view .LVU106
 470 0028 0132     		adds	r2, r2, #1
 471              	.LVL16:
 109:controller/actuators/dc_motors.c **** 	{
 472              		.loc 1 109 52 is_stmt 0 view .LVU107
 473 002a 92B2     		uxth	r2, r2
 474              	.LVL17:
 109:controller/actuators/dc_motors.c **** 	{
 475              		.loc 1 109 2 is_stmt 1 view .LVU108
 111:controller/actuators/dc_motors.c **** 		
 476              		.loc 1 111 15 is_stmt 0 view .LVU109
 477 002c F4E7     		b	.L66
 478              	.LVL18:
 479              	.L69:
  96:controller/actuators/dc_motors.c **** 		return;
 480              		.loc 1 96 3 is_stmt 1 view .LVU110
 481 002e FFF7FEFF 		bl	dc_motor_disable
 482              	.LVL19:
  97:controller/actuators/dc_motors.c **** 	}
 483              		.loc 1 97 3 view .LVU111
 484 0032 0CE0     		b	.L61
 485              	.LVL20:
 486              	.L65:
 120:controller/actuators/dc_motors.c **** 	{
 487              		.loc 1 120 2 view .LVU112
 127:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 488              		.loc 1 127 2 view .LVU113
 489 0034 2968     		ldr	r1, [r5]
 490 0036 0968     		ldr	r1, [r1]
 491 0038 8A62     		str	r2, [r1, #40]
 128:controller/actuators/dc_motors.c **** 
 492              		.loc 1 128 2 view .LVU114
 128:controller/actuators/dc_motors.c **** 
 493              		.loc 1 128 2 view .LVU115
 494 003a 2A68     		ldr	r2, [r5]
 495              	.LVL21:
 128:controller/actuators/dc_motors.c **** 
 496              		.loc 1 128 2 is_stmt 0 view .LVU116
 497 003c 1268     		ldr	r2, [r2]
 498 003e D362     		str	r3, [r2, #44]
 499              	.LVL22:
 128:controller/actuators/dc_motors.c **** 
 500              		.loc 1 128 2 is_stmt 1 view .LVU117
 501 0040 2A68     		ldr	r2, [r5]
 502 0042 D360     		str	r3, [r2, #12]
 128:controller/actuators/dc_motors.c **** 
 503              		.loc 1 128 2 view .LVU118
 130:controller/actuators/dc_motors.c **** }
 504              		.loc 1 130 2 view .LVU119
 505 0044 6A7B     		ldrb	r2, [r5, #13]	@ zero_extendqisi2
 506 0046 297B     		ldrb	r1, [r5, #12]	@ zero_extendqisi2
 507 0048 2846     		mov	r0, r5
 508              	.LVL23:
 130:controller/actuators/dc_motors.c **** }
 509              		.loc 1 130 2 is_stmt 0 view .LVU120
 510 004a FFF7FEFF 		bl	dc_motor_set
 511              	.LVL24:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 14


 512              	.L61:
 131:controller/actuators/dc_motors.c **** 
 513              		.loc 1 131 1 view .LVU121
 514 004e 38BD     		pop	{r3, r4, r5, pc}
 131:controller/actuators/dc_motors.c **** 
 515              		.loc 1 131 1 view .LVU122
 516              		.cfi_endproc
 517              	.LFE222:
 519              		.section	.text.dc_motor_init,"ax",%progbits
 520              		.align	1
 521              		.global	dc_motor_init
 522              		.syntax unified
 523              		.thumb
 524              		.thumb_func
 526              	dc_motor_init:
 527              	.LVL25:
 528              	.LFB220:
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 529              		.loc 1 13 1 is_stmt 1 view -0
 530              		.cfi_startproc
 531              		@ args = 4, pretend = 0, frame = 0
 532              		@ frame_needed = 0, uses_anonymous_args = 0
  14:controller/actuators/dc_motors.c ****     {
 533              		.loc 1 14 5 view .LVU124
  14:controller/actuators/dc_motors.c ****     {
 534              		.loc 1 14 8 is_stmt 0 view .LVU125
 535 0000 0028     		cmp	r0, #0
 536 0002 4DD0     		beq	.L81
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 537              		.loc 1 13 1 view .LVU126
 538 0004 10B5     		push	{r4, lr}
 539              		.cfi_def_cfa_offset 8
 540              		.cfi_offset 4, -8
 541              		.cfi_offset 14, -4
 542 0006 0446     		mov	r4, r0
  14:controller/actuators/dc_motors.c ****     {
 543              		.loc 1 14 23 discriminator 1 view .LVU127
 544 0008 19B3     		cbz	r1, .L70
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 545              		.loc 1 22 5 is_stmt 1 view .LVU128
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 546              		.loc 1 22 18 is_stmt 0 view .LVU129
 547 000a 0160     		str	r1, [r0]
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 548              		.loc 1 23 5 is_stmt 1 view .LVU130
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 549              		.loc 1 23 35 is_stmt 0 view .LVU131
 550 000c 4260     		str	r2, [r0, #4]
  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MOTOR_DIRECTION_FORWARD;
 551              		.loc 1 24 5 is_stmt 1 view .LVU132
  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MOTOR_DIRECTION_FORWARD;
 552              		.loc 1 24 35 is_stmt 0 view .LVU133
 553 000e 8360     		str	r3, [r0, #8]
  25:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_NORMAL;
 554              		.loc 1 25 2 is_stmt 1 view .LVU134
  25:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_NORMAL;
 555              		.loc 1 25 27 is_stmt 0 view .LVU135
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 15


 556 0010 0023     		movs	r3, #0
 557              	.LVL26:
  25:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_NORMAL;
 558              		.loc 1 25 27 view .LVU136
 559 0012 0373     		strb	r3, [r0, #12]
  26:controller/actuators/dc_motors.c **** 
 560              		.loc 1 26 2 is_stmt 1 view .LVU137
  26:controller/actuators/dc_motors.c **** 
 561              		.loc 1 26 16 is_stmt 0 view .LVU138
 562 0014 8373     		strb	r3, [r0, #14]
  31:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 563              		.loc 1 31 2 is_stmt 1 view .LVU139
 564 0016 0846     		mov	r0, r1
 565              	.LVL27:
  31:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 566              		.loc 1 31 2 is_stmt 0 view .LVU140
 567 0018 FFF7FEFF 		bl	HAL_TIM_Base_Start
 568              	.LVL28:
  32:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
 569              		.loc 1 32 2 is_stmt 1 view .LVU141
 570 001c BDF80810 		ldrh	r1, [sp, #8]
 571 0020 2046     		mov	r0, r4
 572 0022 FFF7FEFF 		bl	dc_motor_set_timer_freq
 573              	.LVL29:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 574              		.loc 1 34 2 view .LVU142
 575 0026 6368     		ldr	r3, [r4, #4]
 576 0028 A3B9     		cbnz	r3, .L72
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 577              		.loc 1 34 2 is_stmt 0 discriminator 1 view .LVU143
 578 002a 2368     		ldr	r3, [r4]
 579 002c 1B68     		ldr	r3, [r3]
 580 002e 0022     		movs	r2, #0
 581 0030 5A63     		str	r2, [r3, #52]
 582              	.L73:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 583              		.loc 1 35 2 is_stmt 1 view .LVU144
 584 0032 A368     		ldr	r3, [r4, #8]
 585 0034 0BBB     		cbnz	r3, .L76
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 586              		.loc 1 35 2 is_stmt 0 discriminator 1 view .LVU145
 587 0036 2368     		ldr	r3, [r4]
 588 0038 1B68     		ldr	r3, [r3]
 589 003a 0022     		movs	r2, #0
 590 003c 5A63     		str	r2, [r3, #52]
 591              	.L77:
  36:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
 592              		.loc 1 36 2 is_stmt 1 view .LVU146
 593 003e 6168     		ldr	r1, [r4, #4]
 594 0040 2068     		ldr	r0, [r4]
 595 0042 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 596              	.LVL30:
  37:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 597              		.loc 1 37 2 view .LVU147
 598 0046 A168     		ldr	r1, [r4, #8]
 599 0048 2068     		ldr	r0, [r4]
 600 004a FFF7FEFF 		bl	HAL_TIM_PWM_Start
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 16


 601              	.LVL31:
  38:controller/actuators/dc_motors.c **** }
 602              		.loc 1 38 2 view .LVU148
  38:controller/actuators/dc_motors.c **** }
 603              		.loc 1 38 28 is_stmt 0 view .LVU149
 604 004e 0023     		movs	r3, #0
 605 0050 6373     		strb	r3, [r4, #13]
 606              	.L70:
  39:controller/actuators/dc_motors.c **** 
 607              		.loc 1 39 1 view .LVU150
 608 0052 10BD     		pop	{r4, pc}
 609              	.LVL32:
 610              	.L72:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 611              		.loc 1 34 2 discriminator 2 view .LVU151
 612 0054 042B     		cmp	r3, #4
 613 0056 06D0     		beq	.L84
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 614              		.loc 1 34 2 discriminator 4 view .LVU152
 615 0058 082B     		cmp	r3, #8
 616 005a 09D0     		beq	.L85
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 617              		.loc 1 34 2 discriminator 7 view .LVU153
 618 005c 2368     		ldr	r3, [r4]
 619 005e 1B68     		ldr	r3, [r3]
 620 0060 0022     		movs	r2, #0
 621 0062 1A64     		str	r2, [r3, #64]
 622 0064 E5E7     		b	.L73
 623              	.L84:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 624              		.loc 1 34 2 discriminator 3 view .LVU154
 625 0066 2368     		ldr	r3, [r4]
 626 0068 1B68     		ldr	r3, [r3]
 627 006a 0022     		movs	r2, #0
 628 006c 9A63     		str	r2, [r3, #56]
 629 006e E0E7     		b	.L73
 630              	.L85:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 631              		.loc 1 34 2 discriminator 6 view .LVU155
 632 0070 2368     		ldr	r3, [r4]
 633 0072 1B68     		ldr	r3, [r3]
 634 0074 0022     		movs	r2, #0
 635 0076 DA63     		str	r2, [r3, #60]
 636 0078 DBE7     		b	.L73
 637              	.L76:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 638              		.loc 1 35 2 discriminator 2 view .LVU156
 639 007a 042B     		cmp	r3, #4
 640 007c 06D0     		beq	.L86
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 641              		.loc 1 35 2 discriminator 4 view .LVU157
 642 007e 082B     		cmp	r3, #8
 643 0080 09D0     		beq	.L87
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 644              		.loc 1 35 2 discriminator 7 view .LVU158
 645 0082 2368     		ldr	r3, [r4]
 646 0084 1B68     		ldr	r3, [r3]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 17


 647 0086 0022     		movs	r2, #0
 648 0088 1A64     		str	r2, [r3, #64]
 649 008a D8E7     		b	.L77
 650              	.L86:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 651              		.loc 1 35 2 discriminator 3 view .LVU159
 652 008c 2368     		ldr	r3, [r4]
 653 008e 1B68     		ldr	r3, [r3]
 654 0090 0022     		movs	r2, #0
 655 0092 9A63     		str	r2, [r3, #56]
 656 0094 D3E7     		b	.L77
 657              	.L87:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 658              		.loc 1 35 2 discriminator 6 view .LVU160
 659 0096 2368     		ldr	r3, [r4]
 660 0098 1B68     		ldr	r3, [r3]
 661 009a 0022     		movs	r2, #0
 662 009c DA63     		str	r2, [r3, #60]
 663 009e CEE7     		b	.L77
 664              	.LVL33:
 665              	.L81:
 666              		.cfi_def_cfa_offset 0
 667              		.cfi_restore 4
 668              		.cfi_restore 14
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 669              		.loc 1 35 2 discriminator 6 view .LVU161
 670 00a0 7047     		bx	lr
 671              		.cfi_endproc
 672              	.LFE220:
 674              		.section	.text.dc_motor_enable,"ax",%progbits
 675              		.align	1
 676              		.global	dc_motor_enable
 677              		.syntax unified
 678              		.thumb
 679              		.thumb_func
 681              	dc_motor_enable:
 682              	.LVL34:
 683              	.LFB224:
 152:controller/actuators/dc_motors.c **** 
 153:controller/actuators/dc_motors.c **** /**
 154:controller/actuators/dc_motors.c ****  * @brief enables the motor.
 155:controller/actuators/dc_motors.c ****  * @note sets the duty cycle to 0 for safety
 156:controller/actuators/dc_motors.c ****  */
 157:controller/actuators/dc_motors.c **** void dc_motor_enable(dc_motor_t *motor)
 158:controller/actuators/dc_motors.c **** {
 684              		.loc 1 158 1 is_stmt 1 view -0
 685              		.cfi_startproc
 686              		@ args = 0, pretend = 0, frame = 0
 687              		@ frame_needed = 0, uses_anonymous_args = 0
 688              		@ link register save eliminated.
 159:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
 689              		.loc 1 159 2 view .LVU163
 690              		.loc 1 159 5 is_stmt 0 view .LVU164
 691 0000 0346     		mov	r3, r0
 692 0002 88B1     		cbz	r0, .L88
 693              		.loc 1 159 28 discriminator 1 view .LVU165
 694 0004 0268     		ldr	r2, [r0]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 18


 695              		.loc 1 159 20 discriminator 1 view .LVU166
 696 0006 7AB1     		cbz	r2, .L88
 160:controller/actuators/dc_motors.c **** 	{
 161:controller/actuators/dc_motors.c **** 		return;
 162:controller/actuators/dc_motors.c **** 		/**
 163:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 164:controller/actuators/dc_motors.c **** 		 */
 165:controller/actuators/dc_motors.c **** 	}
 166:controller/actuators/dc_motors.c **** 	if (motor->status == MOTOR_STATE_NORMAL || motor->status == MOTOR_STATE_FAULT || motor == NULL)
 697              		.loc 1 166 2 is_stmt 1 view .LVU167
 698              		.loc 1 166 11 is_stmt 0 view .LVU168
 699 0008 817B     		ldrb	r1, [r0, #14]	@ zero_extendqisi2
 700              		.loc 1 166 5 view .LVU169
 701 000a 0129     		cmp	r1, #1
 702 000c 0CD9     		bls	.L88
 167:controller/actuators/dc_motors.c **** 	{
 168:controller/actuators/dc_motors.c **** 		return;
 169:controller/actuators/dc_motors.c **** 		/**
 170:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 171:controller/actuators/dc_motors.c **** 		 */
 172:controller/actuators/dc_motors.c **** 	}
 173:controller/actuators/dc_motors.c **** 
 174:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
 703              		.loc 1 175 2 is_stmt 1 view .LVU170
 704 000e 4168     		ldr	r1, [r0, #4]
 705 0010 59B9     		cbnz	r1, .L90
 706              		.loc 1 175 2 is_stmt 0 discriminator 1 view .LVU171
 707 0012 1268     		ldr	r2, [r2]
 708 0014 5163     		str	r1, [r2, #52]
 709              	.L91:
 176:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 710              		.loc 1 176 2 is_stmt 1 view .LVU172
 711 0016 9A68     		ldr	r2, [r3, #8]
 712 0018 BAB9     		cbnz	r2, .L94
 713              		.loc 1 176 2 is_stmt 0 discriminator 1 view .LVU173
 714 001a 1A68     		ldr	r2, [r3]
 715 001c 1268     		ldr	r2, [r2]
 716 001e 0021     		movs	r1, #0
 717 0020 5163     		str	r1, [r2, #52]
 718              	.L95:
 177:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 719              		.loc 1 177 2 is_stmt 1 view .LVU174
 720              		.loc 1 177 28 is_stmt 0 view .LVU175
 721 0022 0022     		movs	r2, #0
 722 0024 5A73     		strb	r2, [r3, #13]
 178:controller/actuators/dc_motors.c **** 	motor->status = MOTOR_STATE_NORMAL;
 723              		.loc 1 178 2 is_stmt 1 view .LVU176
 724              		.loc 1 178 16 is_stmt 0 view .LVU177
 725 0026 9A73     		strb	r2, [r3, #14]
 726              	.L88:
 179:controller/actuators/dc_motors.c **** }
 727              		.loc 1 179 1 view .LVU178
 728 0028 7047     		bx	lr
 729              	.L90:
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 730              		.loc 1 175 2 discriminator 2 view .LVU179
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 19


 731 002a 0429     		cmp	r1, #4
 732 002c 05D0     		beq	.L98
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 733              		.loc 1 175 2 discriminator 4 view .LVU180
 734 002e 0829     		cmp	r1, #8
 735 0030 07D0     		beq	.L99
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 736              		.loc 1 175 2 discriminator 7 view .LVU181
 737 0032 1268     		ldr	r2, [r2]
 738 0034 0021     		movs	r1, #0
 739 0036 1164     		str	r1, [r2, #64]
 740 0038 EDE7     		b	.L91
 741              	.L98:
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 742              		.loc 1 175 2 discriminator 3 view .LVU182
 743 003a 1268     		ldr	r2, [r2]
 744 003c 0021     		movs	r1, #0
 745 003e 9163     		str	r1, [r2, #56]
 746 0040 E9E7     		b	.L91
 747              	.L99:
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 748              		.loc 1 175 2 discriminator 6 view .LVU183
 749 0042 1268     		ldr	r2, [r2]
 750 0044 0021     		movs	r1, #0
 751 0046 D163     		str	r1, [r2, #60]
 752 0048 E5E7     		b	.L91
 753              	.L94:
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 754              		.loc 1 176 2 discriminator 2 view .LVU184
 755 004a 042A     		cmp	r2, #4
 756 004c 06D0     		beq	.L100
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 757              		.loc 1 176 2 discriminator 4 view .LVU185
 758 004e 082A     		cmp	r2, #8
 759 0050 09D0     		beq	.L101
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 760              		.loc 1 176 2 discriminator 7 view .LVU186
 761 0052 1A68     		ldr	r2, [r3]
 762 0054 1268     		ldr	r2, [r2]
 763 0056 0021     		movs	r1, #0
 764 0058 1164     		str	r1, [r2, #64]
 765 005a E2E7     		b	.L95
 766              	.L100:
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 767              		.loc 1 176 2 discriminator 3 view .LVU187
 768 005c 1A68     		ldr	r2, [r3]
 769 005e 1268     		ldr	r2, [r2]
 770 0060 0021     		movs	r1, #0
 771 0062 9163     		str	r1, [r2, #56]
 772 0064 DDE7     		b	.L95
 773              	.L101:
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 774              		.loc 1 176 2 discriminator 6 view .LVU188
 775 0066 1A68     		ldr	r2, [r3]
 776 0068 1268     		ldr	r2, [r2]
 777 006a 0021     		movs	r1, #0
 778 006c D163     		str	r1, [r2, #60]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 20


 779 006e D8E7     		b	.L95
 780              		.cfi_endproc
 781              	.LFE224:
 783              		.text
 784              	.Letext0:
 785              		.file 2 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 786              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 787              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 788              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 789              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 790              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 791              		.file 8 "controller/types.h"
 792              		.file 9 "controller/actuators/dc_motors.h"
 793              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_rcc.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s 			page 21


DEFINED SYMBOLS
                            *ABS*:00000000 dc_motors.c
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:21     .text.dc_motor_set:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:27     .text.dc_motor_set:00000000 dc_motor_set
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:302    .text.dc_motor_set:00000140 $d
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:308    .text.dc_motor_disable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:314    .text.dc_motor_disable:00000000 dc_motor_disable
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:412    .text.dc_motor_set_timer_freq:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:418    .text.dc_motor_set_timer_freq:00000000 dc_motor_set_timer_freq
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:520    .text.dc_motor_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:526    .text.dc_motor_init:00000000 dc_motor_init
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:675    .text.dc_motor_enable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccBTqppv.s:681    .text.dc_motor_enable:00000000 dc_motor_enable

UNDEFINED SYMBOLS
__aeabi_i2d
__aeabi_ddiv
__aeabi_ui2d
__aeabi_dmul
__aeabi_d2uiz
HAL_RCC_GetSysClockFreq
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
