ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"dc_motors.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/actuators/dc_motors.c"
  20              		.section	.text.dc_motor_set,"ax",%progbits
  21              		.align	1
  22              		.global	dc_motor_set
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	dc_motor_set:
  28              	.LVL0:
  29              	.LFB221:
   1:controller/actuators/dc_motors.c **** #include "dc_motors.h"
   2:controller/actuators/dc_motors.c **** 
   3:controller/actuators/dc_motors.c **** /**
   4:controller/actuators/dc_motors.c ****  * @brief inits the dc motor
   5:controller/actuators/dc_motors.c ****  * @todo complete documentation
   6:controller/actuators/dc_motors.c ****  * @param motor pointer to the dc_motor_s
   7:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
   8:controller/actuators/dc_motors.c ****  * @param timer_channel_output_1 which timer channel is connected to the first input of the driver
   9:controller/actuators/dc_motors.c ****  * @param timer_channel_output_2 which timer channel is connected to the second input of the driver
  10:controller/actuators/dc_motors.c ****  * @param frequency the desired pwm frequency
  11:controller/actuators/dc_motors.c ****  */
  12:controller/actuators/dc_motors.c **** void dc_motor_init(dc_motor_s *motor, TIM_HandleTypeDef *timer, uint32_t timer_channel_output_1, ui
  13:controller/actuators/dc_motors.c **** {
  14:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
  15:controller/actuators/dc_motors.c ****     {
  16:controller/actuators/dc_motors.c ****         return;
  17:controller/actuators/dc_motors.c ****         /**
  18:controller/actuators/dc_motors.c ****          * @todo throw an error
  19:controller/actuators/dc_motors.c ****          */
  20:controller/actuators/dc_motors.c ****     }
  21:controller/actuators/dc_motors.c **** 
  22:controller/actuators/dc_motors.c ****     motor->timer = timer;
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
  24:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
  25:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
  26:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
  27:controller/actuators/dc_motors.c **** 
  28:controller/actuators/dc_motors.c **** 	/**
  29:controller/actuators/dc_motors.c **** 	 * Enable the timer using HAL
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 2


  30:controller/actuators/dc_motors.c **** 	 */
  31:controller/actuators/dc_motors.c **** 	HAL_TIM_Base_Start((TIM_HandleTypeDef *)motor->timer);
  32:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
  33:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  35:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  36:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
  37:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
  38:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
  39:controller/actuators/dc_motors.c **** }
  40:controller/actuators/dc_motors.c **** 
  41:controller/actuators/dc_motors.c **** 
  42:controller/actuators/dc_motors.c **** /**
  43:controller/actuators/dc_motors.c ****  * @brief sets the pwm duty cycle of the motor
  44:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
  45:controller/actuators/dc_motors.c ****  * @param dir the desired direction of the motor
  46:controller/actuators/dc_motors.c ****  * @param duty_cycle a number between 0 and 255 not a percentage
  47:controller/actuators/dc_motors.c ****  */
  48:controller/actuators/dc_motors.c **** void dc_motor_set(dc_motor_s *motor, dc_motor_direction_e dir, uint8_t duty_cycle)
  49:controller/actuators/dc_motors.c **** {
  30              		.loc 1 49 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  50:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  34              		.loc 1 50 2 view .LVU1
  35              		.loc 1 50 5 is_stmt 0 view .LVU2
  36 0000 0028     		cmp	r0, #0
  37 0002 00F09980 		beq	.L30
  49:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  38              		.loc 1 49 1 view .LVU3
  39 0006 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  40              		.cfi_def_cfa_offset 32
  41              		.cfi_offset 3, -32
  42              		.cfi_offset 4, -28
  43              		.cfi_offset 5, -24
  44              		.cfi_offset 6, -20
  45              		.cfi_offset 7, -16
  46              		.cfi_offset 8, -12
  47              		.cfi_offset 9, -8
  48              		.cfi_offset 14, -4
  49 000a 0F46     		mov	r7, r1
  50 000c 1546     		mov	r5, r2
  51 000e 0446     		mov	r4, r0
  52              		.loc 1 50 28 discriminator 1 view .LVU4
  53 0010 0668     		ldr	r6, [r0]
  54              		.loc 1 50 20 discriminator 1 view .LVU5
  55 0012 66B3     		cbz	r6, .L1
  51:controller/actuators/dc_motors.c **** 	{
  52:controller/actuators/dc_motors.c **** 		return;
  53:controller/actuators/dc_motors.c **** 		/**
  54:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  55:controller/actuators/dc_motors.c **** 		 */
  56:controller/actuators/dc_motors.c **** 	}
  57:controller/actuators/dc_motors.c **** 
  58:controller/actuators/dc_motors.c **** 	if (duty_cycle < 0 || duty_cycle > 255)
  56              		.loc 1 58 2 is_stmt 1 view .LVU6
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 3


  59:controller/actuators/dc_motors.c **** 	{
  60:controller/actuators/dc_motors.c **** 		return;
  61:controller/actuators/dc_motors.c **** 	}
  62:controller/actuators/dc_motors.c **** 	// Map duty cycle (0-255) to timer compare value
  63:controller/actuators/dc_motors.c **** 	uint32_t compare_value = (uint32_t)((duty_cycle / 255.0) * __HAL_TIM_GET_AUTORELOAD((TIM_HandleTyp
  57              		.loc 1 63 2 view .LVU7
  58              		.loc 1 63 50 is_stmt 0 view .LVU8
  59 0014 1046     		mov	r0, r2
  60              	.LVL1:
  61              		.loc 1 63 50 view .LVU9
  62 0016 FFF7FEFF 		bl	__aeabi_i2d
  63              	.LVL2:
  64              		.loc 1 63 50 view .LVU10
  65 001a 49A3     		adr	r3, .L45
  66 001c D3E90023 		ldrd	r2, [r3]
  67 0020 FFF7FEFF 		bl	__aeabi_ddiv
  68              	.LVL3:
  69 0024 8046     		mov	r8, r0
  70 0026 8946     		mov	r9, r1
  71              		.loc 1 63 61 view .LVU11
  72 0028 3668     		ldr	r6, [r6]
  73 002a F06A     		ldr	r0, [r6, #44]
  74              		.loc 1 63 59 view .LVU12
  75 002c FFF7FEFF 		bl	__aeabi_ui2d
  76              	.LVL4:
  77 0030 4246     		mov	r2, r8
  78 0032 4B46     		mov	r3, r9
  79 0034 FFF7FEFF 		bl	__aeabi_dmul
  80              	.LVL5:
  81              		.loc 1 63 11 view .LVU13
  82 0038 FFF7FEFF 		bl	__aeabi_d2uiz
  83              	.LVL6:
  64:controller/actuators/dc_motors.c **** 	
  65:controller/actuators/dc_motors.c **** 	switch (dir)
  84              		.loc 1 65 2 is_stmt 1 view .LVU14
  85 003c 6FB1     		cbz	r7, .L3
  86 003e 012F     		cmp	r7, #1
  87 0040 34D0     		beq	.L4
  66:controller/actuators/dc_motors.c **** 	{
  67:controller/actuators/dc_motors.c **** 	case MD_FORWARD:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, compare_v
  69:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  70:controller/actuators/dc_motors.c **** 		break;
  71:controller/actuators/dc_motors.c **** 	case MD_REVERSE:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  73:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
  74:controller/actuators/dc_motors.c **** 		break;
  75:controller/actuators/dc_motors.c **** 	default:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  88              		.loc 1 76 3 view .LVU15
  89 0042 6368     		ldr	r3, [r4, #4]
  90 0044 002B     		cmp	r3, #0
  91 0046 57D1     		bne	.L21
  92              		.loc 1 76 3 is_stmt 0 discriminator 1 view .LVU16
  93 0048 7363     		str	r3, [r6, #52]
  94              	.L22:
  77:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 4


  95              		.loc 1 77 3 is_stmt 1 view .LVU17
  96 004a A368     		ldr	r3, [r4, #8]
  97 004c 002B     		cmp	r3, #0
  98 004e 60D1     		bne	.L25
  99              		.loc 1 77 3 is_stmt 0 discriminator 1 view .LVU18
 100 0050 2368     		ldr	r3, [r4]
 101 0052 1B68     		ldr	r3, [r3]
 102 0054 0022     		movs	r2, #0
 103 0056 5A63     		str	r2, [r3, #52]
 104 0058 08E0     		b	.L11
 105              	.L3:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 106              		.loc 1 68 3 is_stmt 1 view .LVU19
 107 005a 6368     		ldr	r3, [r4, #4]
 108 005c 4BB9     		cbnz	r3, .L6
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 109              		.loc 1 68 3 is_stmt 0 discriminator 1 view .LVU20
 110 005e 7063     		str	r0, [r6, #52]
 111              	.L7:
  69:controller/actuators/dc_motors.c **** 		break;
 112              		.loc 1 69 3 is_stmt 1 view .LVU21
 113 0060 A368     		ldr	r3, [r4, #8]
 114 0062 83B9     		cbnz	r3, .L10
  69:controller/actuators/dc_motors.c **** 		break;
 115              		.loc 1 69 3 is_stmt 0 discriminator 1 view .LVU22
 116 0064 2368     		ldr	r3, [r4]
 117 0066 1B68     		ldr	r3, [r3]
 118 0068 0022     		movs	r2, #0
 119 006a 5A63     		str	r2, [r3, #52]
 120              	.L11:
  78:controller/actuators/dc_motors.c **** 		/**
  79:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  80:controller/actuators/dc_motors.c **** 		 */
  81:controller/actuators/dc_motors.c **** 		break;
  82:controller/actuators/dc_motors.c **** 	}
  83:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = duty_cycle;
 121              		.loc 1 83 2 is_stmt 1 view .LVU23
 122              		.loc 1 83 28 is_stmt 0 view .LVU24
 123 006c 6573     		strb	r5, [r4, #13]
 124              	.LVL7:
 125              	.L1:
  84:controller/actuators/dc_motors.c **** }
 126              		.loc 1 84 1 view .LVU25
 127 006e BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 128              	.LVL8:
 129              	.L6:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 130              		.loc 1 68 3 discriminator 2 view .LVU26
 131 0072 042B     		cmp	r3, #4
 132 0074 03D0     		beq	.L33
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 133              		.loc 1 68 3 discriminator 4 view .LVU27
 134 0076 082B     		cmp	r3, #8
 135 0078 03D0     		beq	.L34
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 136              		.loc 1 68 3 discriminator 7 view .LVU28
 137 007a 3064     		str	r0, [r6, #64]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 5


 138 007c F0E7     		b	.L7
 139              	.L33:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 140              		.loc 1 68 3 discriminator 3 view .LVU29
 141 007e B063     		str	r0, [r6, #56]
 142 0080 EEE7     		b	.L7
 143              	.L34:
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 144              		.loc 1 68 3 discriminator 6 view .LVU30
 145 0082 F063     		str	r0, [r6, #60]
 146 0084 ECE7     		b	.L7
 147              	.L10:
  69:controller/actuators/dc_motors.c **** 		break;
 148              		.loc 1 69 3 discriminator 2 view .LVU31
 149 0086 042B     		cmp	r3, #4
 150 0088 06D0     		beq	.L35
  69:controller/actuators/dc_motors.c **** 		break;
 151              		.loc 1 69 3 discriminator 4 view .LVU32
 152 008a 082B     		cmp	r3, #8
 153 008c 09D0     		beq	.L36
  69:controller/actuators/dc_motors.c **** 		break;
 154              		.loc 1 69 3 discriminator 7 view .LVU33
 155 008e 2368     		ldr	r3, [r4]
 156 0090 1B68     		ldr	r3, [r3]
 157 0092 0022     		movs	r2, #0
 158 0094 1A64     		str	r2, [r3, #64]
 159 0096 E9E7     		b	.L11
 160              	.L35:
  69:controller/actuators/dc_motors.c **** 		break;
 161              		.loc 1 69 3 discriminator 3 view .LVU34
 162 0098 2368     		ldr	r3, [r4]
 163 009a 1B68     		ldr	r3, [r3]
 164 009c 0022     		movs	r2, #0
 165 009e 9A63     		str	r2, [r3, #56]
 166 00a0 E4E7     		b	.L11
 167              	.L36:
  69:controller/actuators/dc_motors.c **** 		break;
 168              		.loc 1 69 3 discriminator 6 view .LVU35
 169 00a2 2368     		ldr	r3, [r4]
 170 00a4 1B68     		ldr	r3, [r3]
 171 00a6 0022     		movs	r2, #0
 172 00a8 DA63     		str	r2, [r3, #60]
 173 00aa DFE7     		b	.L11
 174              	.L4:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 175              		.loc 1 72 3 is_stmt 1 view .LVU36
 176 00ac 6368     		ldr	r3, [r4, #4]
 177 00ae 33B9     		cbnz	r3, .L14
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 178              		.loc 1 72 3 is_stmt 0 discriminator 1 view .LVU37
 179 00b0 7363     		str	r3, [r6, #52]
 180              	.L15:
  73:controller/actuators/dc_motors.c **** 		break;
 181              		.loc 1 73 3 is_stmt 1 view .LVU38
 182 00b2 A368     		ldr	r3, [r4, #8]
 183 00b4 83B9     		cbnz	r3, .L18
  73:controller/actuators/dc_motors.c **** 		break;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 6


 184              		.loc 1 73 3 is_stmt 0 discriminator 1 view .LVU39
 185 00b6 2368     		ldr	r3, [r4]
 186 00b8 1B68     		ldr	r3, [r3]
 187 00ba 5863     		str	r0, [r3, #52]
 188 00bc D6E7     		b	.L11
 189              	.L14:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 190              		.loc 1 72 3 discriminator 2 view .LVU40
 191 00be 042B     		cmp	r3, #4
 192 00c0 04D0     		beq	.L37
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 193              		.loc 1 72 3 discriminator 4 view .LVU41
 194 00c2 082B     		cmp	r3, #8
 195 00c4 05D0     		beq	.L38
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 196              		.loc 1 72 3 discriminator 7 view .LVU42
 197 00c6 0023     		movs	r3, #0
 198 00c8 3364     		str	r3, [r6, #64]
 199 00ca F2E7     		b	.L15
 200              	.L37:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 201              		.loc 1 72 3 discriminator 3 view .LVU43
 202 00cc 0023     		movs	r3, #0
 203 00ce B363     		str	r3, [r6, #56]
 204 00d0 EFE7     		b	.L15
 205              	.L38:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 206              		.loc 1 72 3 discriminator 6 view .LVU44
 207 00d2 0023     		movs	r3, #0
 208 00d4 F363     		str	r3, [r6, #60]
 209 00d6 ECE7     		b	.L15
 210              	.L18:
  73:controller/actuators/dc_motors.c **** 		break;
 211              		.loc 1 73 3 discriminator 2 view .LVU45
 212 00d8 042B     		cmp	r3, #4
 213 00da 05D0     		beq	.L39
  73:controller/actuators/dc_motors.c **** 		break;
 214              		.loc 1 73 3 discriminator 4 view .LVU46
 215 00dc 082B     		cmp	r3, #8
 216 00de 07D0     		beq	.L40
  73:controller/actuators/dc_motors.c **** 		break;
 217              		.loc 1 73 3 discriminator 7 view .LVU47
 218 00e0 2368     		ldr	r3, [r4]
 219 00e2 1B68     		ldr	r3, [r3]
 220 00e4 1864     		str	r0, [r3, #64]
 221 00e6 C1E7     		b	.L11
 222              	.L39:
  73:controller/actuators/dc_motors.c **** 		break;
 223              		.loc 1 73 3 discriminator 3 view .LVU48
 224 00e8 2368     		ldr	r3, [r4]
 225 00ea 1B68     		ldr	r3, [r3]
 226 00ec 9863     		str	r0, [r3, #56]
 227 00ee BDE7     		b	.L11
 228              	.L40:
  73:controller/actuators/dc_motors.c **** 		break;
 229              		.loc 1 73 3 discriminator 6 view .LVU49
 230 00f0 2368     		ldr	r3, [r4]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 7


 231 00f2 1B68     		ldr	r3, [r3]
 232 00f4 D863     		str	r0, [r3, #60]
 233 00f6 B9E7     		b	.L11
 234              	.L21:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 235              		.loc 1 76 3 discriminator 2 view .LVU50
 236 00f8 042B     		cmp	r3, #4
 237 00fa 04D0     		beq	.L41
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 238              		.loc 1 76 3 discriminator 4 view .LVU51
 239 00fc 082B     		cmp	r3, #8
 240 00fe 05D0     		beq	.L42
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 241              		.loc 1 76 3 discriminator 7 view .LVU52
 242 0100 0023     		movs	r3, #0
 243 0102 3364     		str	r3, [r6, #64]
 244 0104 A1E7     		b	.L22
 245              	.L41:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 246              		.loc 1 76 3 discriminator 3 view .LVU53
 247 0106 0023     		movs	r3, #0
 248 0108 B363     		str	r3, [r6, #56]
 249 010a 9EE7     		b	.L22
 250              	.L42:
  76:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 251              		.loc 1 76 3 discriminator 6 view .LVU54
 252 010c 0023     		movs	r3, #0
 253 010e F363     		str	r3, [r6, #60]
 254 0110 9BE7     		b	.L22
 255              	.L25:
  77:controller/actuators/dc_motors.c **** 		/**
 256              		.loc 1 77 3 discriminator 2 view .LVU55
 257 0112 042B     		cmp	r3, #4
 258 0114 06D0     		beq	.L43
  77:controller/actuators/dc_motors.c **** 		/**
 259              		.loc 1 77 3 discriminator 4 view .LVU56
 260 0116 082B     		cmp	r3, #8
 261 0118 09D0     		beq	.L44
  77:controller/actuators/dc_motors.c **** 		/**
 262              		.loc 1 77 3 discriminator 7 view .LVU57
 263 011a 2368     		ldr	r3, [r4]
 264 011c 1B68     		ldr	r3, [r3]
 265 011e 0022     		movs	r2, #0
 266 0120 1A64     		str	r2, [r3, #64]
 267 0122 A3E7     		b	.L11
 268              	.L43:
  77:controller/actuators/dc_motors.c **** 		/**
 269              		.loc 1 77 3 discriminator 3 view .LVU58
 270 0124 2368     		ldr	r3, [r4]
 271 0126 1B68     		ldr	r3, [r3]
 272 0128 0022     		movs	r2, #0
 273 012a 9A63     		str	r2, [r3, #56]
 274 012c 9EE7     		b	.L11
 275              	.L44:
  77:controller/actuators/dc_motors.c **** 		/**
 276              		.loc 1 77 3 discriminator 6 view .LVU59
 277 012e 2368     		ldr	r3, [r4]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 8


 278 0130 1B68     		ldr	r3, [r3]
 279 0132 0022     		movs	r2, #0
 280 0134 DA63     		str	r2, [r3, #60]
 281 0136 99E7     		b	.L11
 282              	.LVL9:
 283              	.L30:
 284              		.cfi_def_cfa_offset 0
 285              		.cfi_restore 3
 286              		.cfi_restore 4
 287              		.cfi_restore 5
 288              		.cfi_restore 6
 289              		.cfi_restore 7
 290              		.cfi_restore 8
 291              		.cfi_restore 9
 292              		.cfi_restore 14
  77:controller/actuators/dc_motors.c **** 		/**
 293              		.loc 1 77 3 discriminator 6 view .LVU60
 294 0138 7047     		bx	lr
 295              	.L46:
 296 013a 00BFAFF3 		.align	3
 296      0080
 297              	.L45:
 298 0140 00000000 		.word	0
 299 0144 00E06F40 		.word	1081073664
 300              		.cfi_endproc
 301              	.LFE221:
 303              		.section	.text.dc_motor_disable,"ax",%progbits
 304              		.align	1
 305              		.global	dc_motor_disable
 306              		.syntax unified
 307              		.thumb
 308              		.thumb_func
 310              	dc_motor_disable:
 311              	.LVL10:
 312              	.LFB223:
  85:controller/actuators/dc_motors.c **** 
  86:controller/actuators/dc_motors.c **** /**
  87:controller/actuators/dc_motors.c ****  * @brief sets the pwm frequency
  88:controller/actuators/dc_motors.c ****  * @note this changes the frequency of the entire timer, this includes all four channels
  89:controller/actuators/dc_motors.c ****  */
  90:controller/actuators/dc_motors.c **** void dc_motor_set_timer_freq(dc_motor_s *motor, pwm_freq_t frequency)
  91:controller/actuators/dc_motors.c **** {
  92:controller/actuators/dc_motors.c **** 	if (frequency == 0)
  93:controller/actuators/dc_motors.c **** 	{
  94:controller/actuators/dc_motors.c **** 		// Invalid frequency, return or handle error
  95:controller/actuators/dc_motors.c **** 		dc_motor_disable(motor);
  96:controller/actuators/dc_motors.c **** 		return;
  97:controller/actuators/dc_motors.c **** 	}
  98:controller/actuators/dc_motors.c **** 	if (frequency > DC_MOTOR_MAX_FREQUENCY)
  99:controller/actuators/dc_motors.c **** 	{
 100:controller/actuators/dc_motors.c **** 		frequency = DC_MOTOR_MAX_FREQUENCY;
 101:controller/actuators/dc_motors.c **** 	}
 102:controller/actuators/dc_motors.c **** 	
 103:controller/actuators/dc_motors.c **** 	uint32_t timer_clock = HAL_RCC_GetSysClockFreq(); // Get the timer clock frequency
 104:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 105:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 106:controller/actuators/dc_motors.c **** 
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 9


 107:controller/actuators/dc_motors.c **** 	// Calculate prescaler and auto-reload values
 108:controller/actuators/dc_motors.c **** 	for (prescaler = 0; prescaler <= 0xFFFF; prescaler++)
 109:controller/actuators/dc_motors.c **** 	{
 110:controller/actuators/dc_motors.c **** 		auto_reload = (timer_clock / ((prescaler + 1) * frequency)) - 1;
 111:controller/actuators/dc_motors.c **** 		
 112:controller/actuators/dc_motors.c **** 		if (auto_reload <= 0xFFFF)
 113:controller/actuators/dc_motors.c **** 		{
 114:controller/actuators/dc_motors.c **** 			break;
 115:controller/actuators/dc_motors.c **** 
 116:controller/actuators/dc_motors.c **** 		}
 117:controller/actuators/dc_motors.c **** 	}
 118:controller/actuators/dc_motors.c **** 
 119:controller/actuators/dc_motors.c **** 	if (prescaler > 0xFFFF || auto_reload > 0xFFFF)
 120:controller/actuators/dc_motors.c **** 	{
 121:controller/actuators/dc_motors.c **** 		// Frequency is too low, cannot configure timer
 122:controller/actuators/dc_motors.c **** 		return;
 123:controller/actuators/dc_motors.c **** 	}
 124:controller/actuators/dc_motors.c **** 	
 125:controller/actuators/dc_motors.c **** 	// Set the prescaler and auto-reload values
 126:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_PRESCALER((TIM_HandleTypeDef *)motor->timer, prescaler);
 127:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 128:controller/actuators/dc_motors.c **** 
 129:controller/actuators/dc_motors.c **** 	dc_motor_set(motor, motor->current_direction, motor->current_duty_cycle);
 130:controller/actuators/dc_motors.c **** }
 131:controller/actuators/dc_motors.c **** 
 132:controller/actuators/dc_motors.c **** /**
 133:controller/actuators/dc_motors.c ****  * @brief disables the motor.
 134:controller/actuators/dc_motors.c ****  */
 135:controller/actuators/dc_motors.c **** void dc_motor_disable(dc_motor_s *motor)
 136:controller/actuators/dc_motors.c **** {
 313              		.loc 1 136 1 is_stmt 1 view -0
 314              		.cfi_startproc
 315              		@ args = 0, pretend = 0, frame = 0
 316              		@ frame_needed = 0, uses_anonymous_args = 0
 317              		@ link register save eliminated.
 137:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
 318              		.loc 1 137 2 view .LVU62
 319              		.loc 1 137 5 is_stmt 0 view .LVU63
 320 0000 0346     		mov	r3, r0
 321 0002 78B1     		cbz	r0, .L47
 322              		.loc 1 137 28 discriminator 1 view .LVU64
 323 0004 0268     		ldr	r2, [r0]
 324              		.loc 1 137 20 discriminator 1 view .LVU65
 325 0006 6AB1     		cbz	r2, .L47
 138:controller/actuators/dc_motors.c **** 	{
 139:controller/actuators/dc_motors.c **** 		return;
 140:controller/actuators/dc_motors.c **** 		/**
 141:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 142:controller/actuators/dc_motors.c **** 		 */
 143:controller/actuators/dc_motors.c **** 	}
 144:controller/actuators/dc_motors.c **** 
 145:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
 326              		.loc 1 146 2 is_stmt 1 view .LVU66
 327 0008 4168     		ldr	r1, [r0, #4]
 328 000a 61B9     		cbnz	r1, .L49
 329              		.loc 1 146 2 is_stmt 0 discriminator 1 view .LVU67
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 10


 330 000c 1268     		ldr	r2, [r2]
 331 000e 5163     		str	r1, [r2, #52]
 332              	.L50:
 147:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 333              		.loc 1 147 2 is_stmt 1 view .LVU68
 334 0010 9A68     		ldr	r2, [r3, #8]
 335 0012 C2B9     		cbnz	r2, .L53
 336              		.loc 1 147 2 is_stmt 0 discriminator 1 view .LVU69
 337 0014 1A68     		ldr	r2, [r3]
 338 0016 1268     		ldr	r2, [r2]
 339 0018 0021     		movs	r1, #0
 340 001a 5163     		str	r1, [r2, #52]
 341              	.L54:
 148:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 342              		.loc 1 148 2 is_stmt 1 view .LVU70
 343              		.loc 1 148 28 is_stmt 0 view .LVU71
 344 001c 0022     		movs	r2, #0
 345 001e 5A73     		strb	r2, [r3, #13]
 149:controller/actuators/dc_motors.c **** 	motor->status = MS_DISABLED;
 346              		.loc 1 149 2 is_stmt 1 view .LVU72
 347              		.loc 1 149 16 is_stmt 0 view .LVU73
 348 0020 0222     		movs	r2, #2
 349 0022 9A73     		strb	r2, [r3, #14]
 350              	.L47:
 150:controller/actuators/dc_motors.c **** }
 351              		.loc 1 150 1 view .LVU74
 352 0024 7047     		bx	lr
 353              	.L49:
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 354              		.loc 1 146 2 discriminator 2 view .LVU75
 355 0026 0429     		cmp	r1, #4
 356 0028 05D0     		beq	.L57
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 357              		.loc 1 146 2 discriminator 4 view .LVU76
 358 002a 0829     		cmp	r1, #8
 359 002c 07D0     		beq	.L58
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 360              		.loc 1 146 2 discriminator 7 view .LVU77
 361 002e 1268     		ldr	r2, [r2]
 362 0030 0021     		movs	r1, #0
 363 0032 1164     		str	r1, [r2, #64]
 364 0034 ECE7     		b	.L50
 365              	.L57:
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 366              		.loc 1 146 2 discriminator 3 view .LVU78
 367 0036 1268     		ldr	r2, [r2]
 368 0038 0021     		movs	r1, #0
 369 003a 9163     		str	r1, [r2, #56]
 370 003c E8E7     		b	.L50
 371              	.L58:
 146:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 372              		.loc 1 146 2 discriminator 6 view .LVU79
 373 003e 1268     		ldr	r2, [r2]
 374 0040 0021     		movs	r1, #0
 375 0042 D163     		str	r1, [r2, #60]
 376 0044 E4E7     		b	.L50
 377              	.L53:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 11


 147:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 378              		.loc 1 147 2 discriminator 2 view .LVU80
 379 0046 042A     		cmp	r2, #4
 380 0048 06D0     		beq	.L59
 147:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 381              		.loc 1 147 2 discriminator 4 view .LVU81
 382 004a 082A     		cmp	r2, #8
 383 004c 09D0     		beq	.L60
 147:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 384              		.loc 1 147 2 discriminator 7 view .LVU82
 385 004e 1A68     		ldr	r2, [r3]
 386 0050 1268     		ldr	r2, [r2]
 387 0052 0021     		movs	r1, #0
 388 0054 1164     		str	r1, [r2, #64]
 389 0056 E1E7     		b	.L54
 390              	.L59:
 147:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 391              		.loc 1 147 2 discriminator 3 view .LVU83
 392 0058 1A68     		ldr	r2, [r3]
 393 005a 1268     		ldr	r2, [r2]
 394 005c 0021     		movs	r1, #0
 395 005e 9163     		str	r1, [r2, #56]
 396 0060 DCE7     		b	.L54
 397              	.L60:
 147:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 398              		.loc 1 147 2 discriminator 6 view .LVU84
 399 0062 1A68     		ldr	r2, [r3]
 400 0064 1268     		ldr	r2, [r2]
 401 0066 0021     		movs	r1, #0
 402 0068 D163     		str	r1, [r2, #60]
 403 006a D7E7     		b	.L54
 404              		.cfi_endproc
 405              	.LFE223:
 407              		.section	.text.dc_motor_set_timer_freq,"ax",%progbits
 408              		.align	1
 409              		.global	dc_motor_set_timer_freq
 410              		.syntax unified
 411              		.thumb
 412              		.thumb_func
 414              	dc_motor_set_timer_freq:
 415              	.LVL11:
 416              	.LFB222:
  91:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 417              		.loc 1 91 1 is_stmt 1 view -0
 418              		.cfi_startproc
 419              		@ args = 0, pretend = 0, frame = 0
 420              		@ frame_needed = 0, uses_anonymous_args = 0
  91:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 421              		.loc 1 91 1 is_stmt 0 view .LVU86
 422 0000 38B5     		push	{r3, r4, r5, lr}
 423              		.cfi_def_cfa_offset 16
 424              		.cfi_offset 3, -16
 425              		.cfi_offset 4, -12
 426              		.cfi_offset 5, -8
 427              		.cfi_offset 14, -4
 428 0002 0546     		mov	r5, r0
  92:controller/actuators/dc_motors.c **** 	{
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 12


 429              		.loc 1 92 2 is_stmt 1 view .LVU87
  92:controller/actuators/dc_motors.c **** 	{
 430              		.loc 1 92 5 is_stmt 0 view .LVU88
 431 0004 99B1     		cbz	r1, .L69
 432 0006 0C46     		mov	r4, r1
  98:controller/actuators/dc_motors.c **** 	{
 433              		.loc 1 98 2 is_stmt 1 view .LVU89
  98:controller/actuators/dc_motors.c **** 	{
 434              		.loc 1 98 5 is_stmt 0 view .LVU90
 435 0008 42F21073 		movw	r3, #10000
 436 000c 9942     		cmp	r1, r3
 437 000e 00D9     		bls	.L64
 100:controller/actuators/dc_motors.c **** 	}
 438              		.loc 1 100 13 view .LVU91
 439 0010 1C46     		mov	r4, r3
 440              	.L64:
 441              	.LVL12:
 103:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 442              		.loc 1 103 2 is_stmt 1 view .LVU92
 103:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 443              		.loc 1 103 25 is_stmt 0 view .LVU93
 444 0012 FFF7FEFF 		bl	HAL_RCC_GetSysClockFreq
 445              	.LVL13:
 104:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 446              		.loc 1 104 2 is_stmt 1 view .LVU94
 105:controller/actuators/dc_motors.c **** 
 447              		.loc 1 105 2 view .LVU95
 108:controller/actuators/dc_motors.c **** 	{
 448              		.loc 1 108 2 view .LVU96
 108:controller/actuators/dc_motors.c **** 	{
 449              		.loc 1 108 17 is_stmt 0 view .LVU97
 450 0016 0022     		movs	r2, #0
 451              	.LVL14:
 452              	.L66:
 110:controller/actuators/dc_motors.c **** 		
 453              		.loc 1 110 3 is_stmt 1 view .LVU98
 110:controller/actuators/dc_motors.c **** 		
 454              		.loc 1 110 49 is_stmt 0 view .LVU99
 455 0018 02FB0443 		mla	r3, r2, r4, r4
 110:controller/actuators/dc_motors.c **** 		
 456              		.loc 1 110 30 view .LVU100
 457 001c B0FBF3F3 		udiv	r3, r0, r3
 110:controller/actuators/dc_motors.c **** 		
 458              		.loc 1 110 15 view .LVU101
 459 0020 013B     		subs	r3, r3, #1
 460              	.LVL15:
 112:controller/actuators/dc_motors.c **** 		{
 461              		.loc 1 112 3 is_stmt 1 view .LVU102
 112:controller/actuators/dc_motors.c **** 		{
 462              		.loc 1 112 6 is_stmt 0 view .LVU103
 463 0022 B3F5803F 		cmp	r3, #65536
 464 0026 05D3     		bcc	.L65
 108:controller/actuators/dc_motors.c **** 	{
 465              		.loc 1 108 52 is_stmt 1 view .LVU104
 466 0028 0132     		adds	r2, r2, #1
 467              	.LVL16:
 108:controller/actuators/dc_motors.c **** 	{
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 13


 468              		.loc 1 108 52 is_stmt 0 view .LVU105
 469 002a 92B2     		uxth	r2, r2
 470              	.LVL17:
 108:controller/actuators/dc_motors.c **** 	{
 471              		.loc 1 108 2 is_stmt 1 view .LVU106
 110:controller/actuators/dc_motors.c **** 		
 472              		.loc 1 110 15 is_stmt 0 view .LVU107
 473 002c F4E7     		b	.L66
 474              	.LVL18:
 475              	.L69:
  95:controller/actuators/dc_motors.c **** 		return;
 476              		.loc 1 95 3 is_stmt 1 view .LVU108
 477 002e FFF7FEFF 		bl	dc_motor_disable
 478              	.LVL19:
  96:controller/actuators/dc_motors.c **** 	}
 479              		.loc 1 96 3 view .LVU109
 480 0032 0CE0     		b	.L61
 481              	.LVL20:
 482              	.L65:
 119:controller/actuators/dc_motors.c **** 	{
 483              		.loc 1 119 2 view .LVU110
 126:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 484              		.loc 1 126 2 view .LVU111
 485 0034 2968     		ldr	r1, [r5]
 486 0036 0968     		ldr	r1, [r1]
 487 0038 8A62     		str	r2, [r1, #40]
 127:controller/actuators/dc_motors.c **** 
 488              		.loc 1 127 2 view .LVU112
 127:controller/actuators/dc_motors.c **** 
 489              		.loc 1 127 2 view .LVU113
 490 003a 2A68     		ldr	r2, [r5]
 491              	.LVL21:
 127:controller/actuators/dc_motors.c **** 
 492              		.loc 1 127 2 is_stmt 0 view .LVU114
 493 003c 1268     		ldr	r2, [r2]
 494 003e D362     		str	r3, [r2, #44]
 495              	.LVL22:
 127:controller/actuators/dc_motors.c **** 
 496              		.loc 1 127 2 is_stmt 1 view .LVU115
 497 0040 2A68     		ldr	r2, [r5]
 498 0042 D360     		str	r3, [r2, #12]
 127:controller/actuators/dc_motors.c **** 
 499              		.loc 1 127 2 view .LVU116
 129:controller/actuators/dc_motors.c **** }
 500              		.loc 1 129 2 view .LVU117
 501 0044 6A7B     		ldrb	r2, [r5, #13]	@ zero_extendqisi2
 502 0046 297B     		ldrb	r1, [r5, #12]	@ zero_extendqisi2
 503 0048 2846     		mov	r0, r5
 504              	.LVL23:
 129:controller/actuators/dc_motors.c **** }
 505              		.loc 1 129 2 is_stmt 0 view .LVU118
 506 004a FFF7FEFF 		bl	dc_motor_set
 507              	.LVL24:
 508              	.L61:
 130:controller/actuators/dc_motors.c **** 
 509              		.loc 1 130 1 view .LVU119
 510 004e 38BD     		pop	{r3, r4, r5, pc}
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 14


 130:controller/actuators/dc_motors.c **** 
 511              		.loc 1 130 1 view .LVU120
 512              		.cfi_endproc
 513              	.LFE222:
 515              		.section	.text.dc_motor_init,"ax",%progbits
 516              		.align	1
 517              		.global	dc_motor_init
 518              		.syntax unified
 519              		.thumb
 520              		.thumb_func
 522              	dc_motor_init:
 523              	.LVL25:
 524              	.LFB220:
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 525              		.loc 1 13 1 is_stmt 1 view -0
 526              		.cfi_startproc
 527              		@ args = 4, pretend = 0, frame = 0
 528              		@ frame_needed = 0, uses_anonymous_args = 0
  14:controller/actuators/dc_motors.c ****     {
 529              		.loc 1 14 5 view .LVU122
  14:controller/actuators/dc_motors.c ****     {
 530              		.loc 1 14 8 is_stmt 0 view .LVU123
 531 0000 0028     		cmp	r0, #0
 532 0002 4DD0     		beq	.L81
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 533              		.loc 1 13 1 view .LVU124
 534 0004 10B5     		push	{r4, lr}
 535              		.cfi_def_cfa_offset 8
 536              		.cfi_offset 4, -8
 537              		.cfi_offset 14, -4
 538 0006 0446     		mov	r4, r0
  14:controller/actuators/dc_motors.c ****     {
 539              		.loc 1 14 23 discriminator 1 view .LVU125
 540 0008 19B3     		cbz	r1, .L70
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 541              		.loc 1 22 5 is_stmt 1 view .LVU126
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 542              		.loc 1 22 18 is_stmt 0 view .LVU127
 543 000a 0160     		str	r1, [r0]
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 544              		.loc 1 23 5 is_stmt 1 view .LVU128
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 545              		.loc 1 23 35 is_stmt 0 view .LVU129
 546 000c 4260     		str	r2, [r0, #4]
  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
 547              		.loc 1 24 5 is_stmt 1 view .LVU130
  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
 548              		.loc 1 24 35 is_stmt 0 view .LVU131
 549 000e 8360     		str	r3, [r0, #8]
  25:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
 550              		.loc 1 25 2 is_stmt 1 view .LVU132
  25:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
 551              		.loc 1 25 27 is_stmt 0 view .LVU133
 552 0010 0023     		movs	r3, #0
 553              	.LVL26:
  25:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
 554              		.loc 1 25 27 view .LVU134
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 15


 555 0012 0373     		strb	r3, [r0, #12]
  26:controller/actuators/dc_motors.c **** 
 556              		.loc 1 26 2 is_stmt 1 view .LVU135
  26:controller/actuators/dc_motors.c **** 
 557              		.loc 1 26 16 is_stmt 0 view .LVU136
 558 0014 8373     		strb	r3, [r0, #14]
  31:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 559              		.loc 1 31 2 is_stmt 1 view .LVU137
 560 0016 0846     		mov	r0, r1
 561              	.LVL27:
  31:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 562              		.loc 1 31 2 is_stmt 0 view .LVU138
 563 0018 FFF7FEFF 		bl	HAL_TIM_Base_Start
 564              	.LVL28:
  32:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
 565              		.loc 1 32 2 is_stmt 1 view .LVU139
 566 001c BDF80810 		ldrh	r1, [sp, #8]
 567 0020 2046     		mov	r0, r4
 568 0022 FFF7FEFF 		bl	dc_motor_set_timer_freq
 569              	.LVL29:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 570              		.loc 1 34 2 view .LVU140
 571 0026 6368     		ldr	r3, [r4, #4]
 572 0028 A3B9     		cbnz	r3, .L72
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 573              		.loc 1 34 2 is_stmt 0 discriminator 1 view .LVU141
 574 002a 2368     		ldr	r3, [r4]
 575 002c 1B68     		ldr	r3, [r3]
 576 002e 0022     		movs	r2, #0
 577 0030 5A63     		str	r2, [r3, #52]
 578              	.L73:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 579              		.loc 1 35 2 is_stmt 1 view .LVU142
 580 0032 A368     		ldr	r3, [r4, #8]
 581 0034 0BBB     		cbnz	r3, .L76
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 582              		.loc 1 35 2 is_stmt 0 discriminator 1 view .LVU143
 583 0036 2368     		ldr	r3, [r4]
 584 0038 1B68     		ldr	r3, [r3]
 585 003a 0022     		movs	r2, #0
 586 003c 5A63     		str	r2, [r3, #52]
 587              	.L77:
  36:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
 588              		.loc 1 36 2 is_stmt 1 view .LVU144
 589 003e 6168     		ldr	r1, [r4, #4]
 590 0040 2068     		ldr	r0, [r4]
 591 0042 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 592              	.LVL30:
  37:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 593              		.loc 1 37 2 view .LVU145
 594 0046 A168     		ldr	r1, [r4, #8]
 595 0048 2068     		ldr	r0, [r4]
 596 004a FFF7FEFF 		bl	HAL_TIM_PWM_Start
 597              	.LVL31:
  38:controller/actuators/dc_motors.c **** }
 598              		.loc 1 38 2 view .LVU146
  38:controller/actuators/dc_motors.c **** }
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 16


 599              		.loc 1 38 28 is_stmt 0 view .LVU147
 600 004e 0023     		movs	r3, #0
 601 0050 6373     		strb	r3, [r4, #13]
 602              	.L70:
  39:controller/actuators/dc_motors.c **** 
 603              		.loc 1 39 1 view .LVU148
 604 0052 10BD     		pop	{r4, pc}
 605              	.LVL32:
 606              	.L72:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 607              		.loc 1 34 2 discriminator 2 view .LVU149
 608 0054 042B     		cmp	r3, #4
 609 0056 06D0     		beq	.L84
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 610              		.loc 1 34 2 discriminator 4 view .LVU150
 611 0058 082B     		cmp	r3, #8
 612 005a 09D0     		beq	.L85
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 613              		.loc 1 34 2 discriminator 7 view .LVU151
 614 005c 2368     		ldr	r3, [r4]
 615 005e 1B68     		ldr	r3, [r3]
 616 0060 0022     		movs	r2, #0
 617 0062 1A64     		str	r2, [r3, #64]
 618 0064 E5E7     		b	.L73
 619              	.L84:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 620              		.loc 1 34 2 discriminator 3 view .LVU152
 621 0066 2368     		ldr	r3, [r4]
 622 0068 1B68     		ldr	r3, [r3]
 623 006a 0022     		movs	r2, #0
 624 006c 9A63     		str	r2, [r3, #56]
 625 006e E0E7     		b	.L73
 626              	.L85:
  34:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 627              		.loc 1 34 2 discriminator 6 view .LVU153
 628 0070 2368     		ldr	r3, [r4]
 629 0072 1B68     		ldr	r3, [r3]
 630 0074 0022     		movs	r2, #0
 631 0076 DA63     		str	r2, [r3, #60]
 632 0078 DBE7     		b	.L73
 633              	.L76:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 634              		.loc 1 35 2 discriminator 2 view .LVU154
 635 007a 042B     		cmp	r3, #4
 636 007c 06D0     		beq	.L86
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 637              		.loc 1 35 2 discriminator 4 view .LVU155
 638 007e 082B     		cmp	r3, #8
 639 0080 09D0     		beq	.L87
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 640              		.loc 1 35 2 discriminator 7 view .LVU156
 641 0082 2368     		ldr	r3, [r4]
 642 0084 1B68     		ldr	r3, [r3]
 643 0086 0022     		movs	r2, #0
 644 0088 1A64     		str	r2, [r3, #64]
 645 008a D8E7     		b	.L77
 646              	.L86:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 17


  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 647              		.loc 1 35 2 discriminator 3 view .LVU157
 648 008c 2368     		ldr	r3, [r4]
 649 008e 1B68     		ldr	r3, [r3]
 650 0090 0022     		movs	r2, #0
 651 0092 9A63     		str	r2, [r3, #56]
 652 0094 D3E7     		b	.L77
 653              	.L87:
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 654              		.loc 1 35 2 discriminator 6 view .LVU158
 655 0096 2368     		ldr	r3, [r4]
 656 0098 1B68     		ldr	r3, [r3]
 657 009a 0022     		movs	r2, #0
 658 009c DA63     		str	r2, [r3, #60]
 659 009e CEE7     		b	.L77
 660              	.LVL33:
 661              	.L81:
 662              		.cfi_def_cfa_offset 0
 663              		.cfi_restore 4
 664              		.cfi_restore 14
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 665              		.loc 1 35 2 discriminator 6 view .LVU159
 666 00a0 7047     		bx	lr
 667              		.cfi_endproc
 668              	.LFE220:
 670              		.section	.text.dc_motor_enable,"ax",%progbits
 671              		.align	1
 672              		.global	dc_motor_enable
 673              		.syntax unified
 674              		.thumb
 675              		.thumb_func
 677              	dc_motor_enable:
 678              	.LVL34:
 679              	.LFB224:
 151:controller/actuators/dc_motors.c **** 
 152:controller/actuators/dc_motors.c **** /**
 153:controller/actuators/dc_motors.c ****  * @brief enables the motor.
 154:controller/actuators/dc_motors.c ****  * @note sets the duty cycle to 0 for safety
 155:controller/actuators/dc_motors.c ****  */
 156:controller/actuators/dc_motors.c **** void dc_motor_enable(dc_motor_s *motor)
 157:controller/actuators/dc_motors.c **** {
 680              		.loc 1 157 1 is_stmt 1 view -0
 681              		.cfi_startproc
 682              		@ args = 0, pretend = 0, frame = 0
 683              		@ frame_needed = 0, uses_anonymous_args = 0
 684              		@ link register save eliminated.
 158:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
 685              		.loc 1 158 2 view .LVU161
 686              		.loc 1 158 5 is_stmt 0 view .LVU162
 687 0000 0346     		mov	r3, r0
 688 0002 88B1     		cbz	r0, .L88
 689              		.loc 1 158 28 discriminator 1 view .LVU163
 690 0004 0268     		ldr	r2, [r0]
 691              		.loc 1 158 20 discriminator 1 view .LVU164
 692 0006 7AB1     		cbz	r2, .L88
 159:controller/actuators/dc_motors.c **** 	{
 160:controller/actuators/dc_motors.c **** 		return;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 18


 161:controller/actuators/dc_motors.c **** 		/**
 162:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 163:controller/actuators/dc_motors.c **** 		 */
 164:controller/actuators/dc_motors.c **** 	}
 165:controller/actuators/dc_motors.c **** 	if (motor->status == MS_NORMAL || motor->status == MS_FAULT || motor == NULL)
 693              		.loc 1 165 2 is_stmt 1 view .LVU165
 694              		.loc 1 165 11 is_stmt 0 view .LVU166
 695 0008 817B     		ldrb	r1, [r0, #14]	@ zero_extendqisi2
 696              		.loc 1 165 5 view .LVU167
 697 000a 0129     		cmp	r1, #1
 698 000c 0CD9     		bls	.L88
 166:controller/actuators/dc_motors.c **** 	{
 167:controller/actuators/dc_motors.c **** 		return;
 168:controller/actuators/dc_motors.c **** 		/**
 169:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 170:controller/actuators/dc_motors.c **** 		 */
 171:controller/actuators/dc_motors.c **** 	}
 172:controller/actuators/dc_motors.c **** 
 173:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
 699              		.loc 1 174 2 is_stmt 1 view .LVU168
 700 000e 4168     		ldr	r1, [r0, #4]
 701 0010 59B9     		cbnz	r1, .L90
 702              		.loc 1 174 2 is_stmt 0 discriminator 1 view .LVU169
 703 0012 1268     		ldr	r2, [r2]
 704 0014 5163     		str	r1, [r2, #52]
 705              	.L91:
 175:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 706              		.loc 1 175 2 is_stmt 1 view .LVU170
 707 0016 9A68     		ldr	r2, [r3, #8]
 708 0018 BAB9     		cbnz	r2, .L94
 709              		.loc 1 175 2 is_stmt 0 discriminator 1 view .LVU171
 710 001a 1A68     		ldr	r2, [r3]
 711 001c 1268     		ldr	r2, [r2]
 712 001e 0021     		movs	r1, #0
 713 0020 5163     		str	r1, [r2, #52]
 714              	.L95:
 176:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 715              		.loc 1 176 2 is_stmt 1 view .LVU172
 716              		.loc 1 176 28 is_stmt 0 view .LVU173
 717 0022 0022     		movs	r2, #0
 718 0024 5A73     		strb	r2, [r3, #13]
 177:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
 719              		.loc 1 177 2 is_stmt 1 view .LVU174
 720              		.loc 1 177 16 is_stmt 0 view .LVU175
 721 0026 9A73     		strb	r2, [r3, #14]
 722              	.L88:
 178:controller/actuators/dc_motors.c **** }
 723              		.loc 1 178 1 view .LVU176
 724 0028 7047     		bx	lr
 725              	.L90:
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 726              		.loc 1 174 2 discriminator 2 view .LVU177
 727 002a 0429     		cmp	r1, #4
 728 002c 05D0     		beq	.L98
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 729              		.loc 1 174 2 discriminator 4 view .LVU178
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 19


 730 002e 0829     		cmp	r1, #8
 731 0030 07D0     		beq	.L99
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 732              		.loc 1 174 2 discriminator 7 view .LVU179
 733 0032 1268     		ldr	r2, [r2]
 734 0034 0021     		movs	r1, #0
 735 0036 1164     		str	r1, [r2, #64]
 736 0038 EDE7     		b	.L91
 737              	.L98:
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 738              		.loc 1 174 2 discriminator 3 view .LVU180
 739 003a 1268     		ldr	r2, [r2]
 740 003c 0021     		movs	r1, #0
 741 003e 9163     		str	r1, [r2, #56]
 742 0040 E9E7     		b	.L91
 743              	.L99:
 174:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 744              		.loc 1 174 2 discriminator 6 view .LVU181
 745 0042 1268     		ldr	r2, [r2]
 746 0044 0021     		movs	r1, #0
 747 0046 D163     		str	r1, [r2, #60]
 748 0048 E5E7     		b	.L91
 749              	.L94:
 175:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 750              		.loc 1 175 2 discriminator 2 view .LVU182
 751 004a 042A     		cmp	r2, #4
 752 004c 06D0     		beq	.L100
 175:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 753              		.loc 1 175 2 discriminator 4 view .LVU183
 754 004e 082A     		cmp	r2, #8
 755 0050 09D0     		beq	.L101
 175:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 756              		.loc 1 175 2 discriminator 7 view .LVU184
 757 0052 1A68     		ldr	r2, [r3]
 758 0054 1268     		ldr	r2, [r2]
 759 0056 0021     		movs	r1, #0
 760 0058 1164     		str	r1, [r2, #64]
 761 005a E2E7     		b	.L95
 762              	.L100:
 175:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 763              		.loc 1 175 2 discriminator 3 view .LVU185
 764 005c 1A68     		ldr	r2, [r3]
 765 005e 1268     		ldr	r2, [r2]
 766 0060 0021     		movs	r1, #0
 767 0062 9163     		str	r1, [r2, #56]
 768 0064 DDE7     		b	.L95
 769              	.L101:
 175:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 770              		.loc 1 175 2 discriminator 6 view .LVU186
 771 0066 1A68     		ldr	r2, [r3]
 772 0068 1268     		ldr	r2, [r2]
 773 006a 0021     		movs	r1, #0
 774 006c D163     		str	r1, [r2, #60]
 775 006e D8E7     		b	.L95
 776              		.cfi_endproc
 777              	.LFE224:
 779              		.text
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 20


 780              	.Letext0:
 781              		.file 2 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 782              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 783              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 784              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 785              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 786              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 787              		.file 8 "controller/types.h"
 788              		.file 9 "controller/actuators/dc_motors.h"
 789              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_rcc.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s 			page 21


DEFINED SYMBOLS
                            *ABS*:00000000 dc_motors.c
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:21     .text.dc_motor_set:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:27     .text.dc_motor_set:00000000 dc_motor_set
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:298    .text.dc_motor_set:00000140 $d
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:304    .text.dc_motor_disable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:310    .text.dc_motor_disable:00000000 dc_motor_disable
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:408    .text.dc_motor_set_timer_freq:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:414    .text.dc_motor_set_timer_freq:00000000 dc_motor_set_timer_freq
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:516    .text.dc_motor_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:522    .text.dc_motor_init:00000000 dc_motor_init
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:671    .text.dc_motor_enable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc6qd7Fy.s:677    .text.dc_motor_enable:00000000 dc_motor_enable

UNDEFINED SYMBOLS
__aeabi_i2d
__aeabi_ddiv
__aeabi_ui2d
__aeabi_dmul
__aeabi_d2uiz
HAL_RCC_GetSysClockFreq
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
