ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"dc_motors.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/actuators/dc_motors.c"
  20              		.section	.text.dc_motor_set,"ax",%progbits
  21              		.align	1
  22              		.global	dc_motor_set
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	dc_motor_set:
  28              	.LVL0:
  29              	.LFB135:
   1:controller/actuators/dc_motors.c **** #include "dc_motors.h"
   2:controller/actuators/dc_motors.c **** 
   3:controller/actuators/dc_motors.c **** /**
   4:controller/actuators/dc_motors.c ****  * @brief inits the dc motor
   5:controller/actuators/dc_motors.c ****  * @todo complete documentation
   6:controller/actuators/dc_motors.c ****  * @param motor pointer to the dc_motor_s
   7:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
   8:controller/actuators/dc_motors.c ****  * @param timer_channel_output_1 which timer channel is connected to the first input of the driver
   9:controller/actuators/dc_motors.c ****  * @param timer_channel_output_2 which timer channel is connected to the second input of the driver
  10:controller/actuators/dc_motors.c ****  * @param frequency the desired pwm frequency
  11:controller/actuators/dc_motors.c ****  */
  12:controller/actuators/dc_motors.c **** void dc_motor_init(dc_motor_s *motor, TIM_HandleTypeDef *timer, uint32_t timer_channel_output_1, ui
  13:controller/actuators/dc_motors.c **** {
  14:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
  15:controller/actuators/dc_motors.c ****     {
  16:controller/actuators/dc_motors.c ****         return;
  17:controller/actuators/dc_motors.c ****         /**
  18:controller/actuators/dc_motors.c ****          * @todo throw an error
  19:controller/actuators/dc_motors.c ****          */
  20:controller/actuators/dc_motors.c ****     }
  21:controller/actuators/dc_motors.c **** 
  22:controller/actuators/dc_motors.c ****     motor->timer = timer;
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
  24:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
  25:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
  26:controller/actuators/dc_motors.c **** 	/**
  27:controller/actuators/dc_motors.c **** 	 * Enable the timer using HAL
  28:controller/actuators/dc_motors.c **** 	 */
  29:controller/actuators/dc_motors.c **** 	HAL_TIM_Base_Start((TIM_HandleTypeDef *)motor->timer);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 2


  30:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
  31:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  33:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  34:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
  35:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
  36:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
  37:controller/actuators/dc_motors.c **** }
  38:controller/actuators/dc_motors.c **** 
  39:controller/actuators/dc_motors.c **** 
  40:controller/actuators/dc_motors.c **** /**
  41:controller/actuators/dc_motors.c ****  * @brief sets the pwm duty cycle of the motor
  42:controller/actuators/dc_motors.c ****  * @param timer pointer to timer handle - the timer connected to the motor
  43:controller/actuators/dc_motors.c ****  * @param dir the desired direction of the motor
  44:controller/actuators/dc_motors.c ****  * @param duty_cycle a number between 0 and 255 not a percentage
  45:controller/actuators/dc_motors.c ****  */
  46:controller/actuators/dc_motors.c **** void dc_motor_set(dc_motor_s *motor, dc_motor_direction_e dir, uint8_t duty_cycle)
  47:controller/actuators/dc_motors.c **** {
  30              		.loc 1 47 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  48:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  34              		.loc 1 48 2 view .LVU1
  35              		.loc 1 48 5 is_stmt 0 view .LVU2
  36 0000 0028     		cmp	r0, #0
  37 0002 00F0A980 		beq	.L30
  47:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
  38              		.loc 1 47 1 view .LVU3
  39 0006 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
  40              		.cfi_def_cfa_offset 32
  41              		.cfi_offset 3, -32
  42              		.cfi_offset 4, -28
  43              		.cfi_offset 5, -24
  44              		.cfi_offset 6, -20
  45              		.cfi_offset 7, -16
  46              		.cfi_offset 8, -12
  47              		.cfi_offset 9, -8
  48              		.cfi_offset 14, -4
  49 000a 0E46     		mov	r6, r1
  50 000c 1546     		mov	r5, r2
  51 000e 0446     		mov	r4, r0
  52              		.loc 1 48 28 discriminator 1 view .LVU4
  53 0010 0768     		ldr	r7, [r0]
  54              		.loc 1 48 20 discriminator 1 view .LVU5
  55 0012 002F     		cmp	r7, #0
  56 0014 30D0     		beq	.L1
  49:controller/actuators/dc_motors.c **** 	{
  50:controller/actuators/dc_motors.c **** 		return;
  51:controller/actuators/dc_motors.c **** 		/**
  52:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  53:controller/actuators/dc_motors.c **** 		 */
  54:controller/actuators/dc_motors.c **** 	}
  55:controller/actuators/dc_motors.c **** 
  56:controller/actuators/dc_motors.c **** 	// Map duty cycle (0-255) to timer compare value
  57:controller/actuators/dc_motors.c **** 	uint32_t compare_value = (uint32_t)((duty_cycle / 255.0) * __HAL_TIM_GET_AUTORELOAD((TIM_HandleTyp
  57              		.loc 1 57 2 is_stmt 1 view .LVU6
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 3


  58              		.loc 1 57 50 is_stmt 0 view .LVU7
  59 0016 1046     		mov	r0, r2
  60              	.LVL1:
  61              		.loc 1 57 50 view .LVU8
  62 0018 FFF7FEFF 		bl	__aeabi_i2d
  63              	.LVL2:
  64              		.loc 1 57 50 view .LVU9
  65 001c 50A3     		adr	r3, .L45
  66 001e D3E90023 		ldrd	r2, [r3]
  67 0022 FFF7FEFF 		bl	__aeabi_ddiv
  68              	.LVL3:
  69 0026 8046     		mov	r8, r0
  70 0028 8946     		mov	r9, r1
  71              		.loc 1 57 61 view .LVU10
  72 002a 3B68     		ldr	r3, [r7]
  73 002c D86A     		ldr	r0, [r3, #44]
  74              		.loc 1 57 59 view .LVU11
  75 002e FFF7FEFF 		bl	__aeabi_ui2d
  76              	.LVL4:
  77 0032 4246     		mov	r2, r8
  78 0034 4B46     		mov	r3, r9
  79 0036 FFF7FEFF 		bl	__aeabi_dmul
  80              	.LVL5:
  81              		.loc 1 57 11 view .LVU12
  82 003a FFF7FEFF 		bl	__aeabi_d2uiz
  83              	.LVL6:
  58:controller/actuators/dc_motors.c **** 	motor->_last_compare_value = compare_value;
  84              		.loc 1 58 2 is_stmt 1 view .LVU13
  85              		.loc 1 58 29 is_stmt 0 view .LVU14
  86 003e 2061     		str	r0, [r4, #16]
  59:controller/actuators/dc_motors.c **** 	
  60:controller/actuators/dc_motors.c **** 	switch (dir)
  87              		.loc 1 60 2 is_stmt 1 view .LVU15
  88 0040 7EB1     		cbz	r6, .L3
  89 0042 012E     		cmp	r6, #1
  90 0044 3AD0     		beq	.L4
  61:controller/actuators/dc_motors.c **** 	{
  62:controller/actuators/dc_motors.c **** 	case MD_FORWARD:
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, compare_v
  64:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
  65:controller/actuators/dc_motors.c **** 		break;
  66:controller/actuators/dc_motors.c **** 	case MD_REVERSE:
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  68:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
  69:controller/actuators/dc_motors.c **** 		break;
  70:controller/actuators/dc_motors.c **** 	default:
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
  91              		.loc 1 71 3 view .LVU16
  92 0046 6368     		ldr	r3, [r4, #4]
  93 0048 002B     		cmp	r3, #0
  94 004a 62D1     		bne	.L21
  95              		.loc 1 71 3 is_stmt 0 discriminator 1 view .LVU17
  96 004c 3B68     		ldr	r3, [r7]
  97 004e 0022     		movs	r2, #0
  98 0050 5A63     		str	r2, [r3, #52]
  99              	.L22:
  72:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 4


 100              		.loc 1 72 3 is_stmt 1 view .LVU18
 101 0052 A368     		ldr	r3, [r4, #8]
 102 0054 002B     		cmp	r3, #0
 103 0056 6CD1     		bne	.L25
 104              		.loc 1 72 3 is_stmt 0 discriminator 1 view .LVU19
 105 0058 2368     		ldr	r3, [r4]
 106 005a 1B68     		ldr	r3, [r3]
 107 005c 0022     		movs	r2, #0
 108 005e 5A63     		str	r2, [r3, #52]
 109 0060 09E0     		b	.L11
 110              	.L3:
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 111              		.loc 1 63 3 is_stmt 1 view .LVU20
 112 0062 6368     		ldr	r3, [r4, #4]
 113 0064 53B9     		cbnz	r3, .L6
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 114              		.loc 1 63 3 is_stmt 0 discriminator 1 view .LVU21
 115 0066 3B68     		ldr	r3, [r7]
 116 0068 5863     		str	r0, [r3, #52]
 117              	.L7:
  64:controller/actuators/dc_motors.c **** 		break;
 118              		.loc 1 64 3 is_stmt 1 view .LVU22
 119 006a A368     		ldr	r3, [r4, #8]
 120 006c 9BB9     		cbnz	r3, .L10
  64:controller/actuators/dc_motors.c **** 		break;
 121              		.loc 1 64 3 is_stmt 0 discriminator 1 view .LVU23
 122 006e 2368     		ldr	r3, [r4]
 123 0070 1B68     		ldr	r3, [r3]
 124 0072 0022     		movs	r2, #0
 125 0074 5A63     		str	r2, [r3, #52]
 126              	.L11:
  73:controller/actuators/dc_motors.c **** 		/**
  74:controller/actuators/dc_motors.c **** 		 * @todo throw an error
  75:controller/actuators/dc_motors.c **** 		 */
  76:controller/actuators/dc_motors.c **** 		break;
  77:controller/actuators/dc_motors.c **** 	}
  78:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = duty_cycle;
 127              		.loc 1 78 2 is_stmt 1 view .LVU24
 128              		.loc 1 78 28 is_stmt 0 view .LVU25
 129 0076 6573     		strb	r5, [r4, #13]
 130              	.LVL7:
 131              	.L1:
  79:controller/actuators/dc_motors.c **** }
 132              		.loc 1 79 1 view .LVU26
 133 0078 BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 134              	.LVL8:
 135              	.L6:
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 136              		.loc 1 63 3 discriminator 2 view .LVU27
 137 007c 042B     		cmp	r3, #4
 138 007e 04D0     		beq	.L33
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 139              		.loc 1 63 3 discriminator 4 view .LVU28
 140 0080 082B     		cmp	r3, #8
 141 0082 05D0     		beq	.L34
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 142              		.loc 1 63 3 discriminator 7 view .LVU29
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 5


 143 0084 3B68     		ldr	r3, [r7]
 144 0086 1864     		str	r0, [r3, #64]
 145 0088 EFE7     		b	.L7
 146              	.L33:
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 147              		.loc 1 63 3 discriminator 3 view .LVU30
 148 008a 3B68     		ldr	r3, [r7]
 149 008c 9863     		str	r0, [r3, #56]
 150 008e ECE7     		b	.L7
 151              	.L34:
  63:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 152              		.loc 1 63 3 discriminator 6 view .LVU31
 153 0090 3B68     		ldr	r3, [r7]
 154 0092 D863     		str	r0, [r3, #60]
 155 0094 E9E7     		b	.L7
 156              	.L10:
  64:controller/actuators/dc_motors.c **** 		break;
 157              		.loc 1 64 3 discriminator 2 view .LVU32
 158 0096 042B     		cmp	r3, #4
 159 0098 06D0     		beq	.L35
  64:controller/actuators/dc_motors.c **** 		break;
 160              		.loc 1 64 3 discriminator 4 view .LVU33
 161 009a 082B     		cmp	r3, #8
 162 009c 09D0     		beq	.L36
  64:controller/actuators/dc_motors.c **** 		break;
 163              		.loc 1 64 3 discriminator 7 view .LVU34
 164 009e 2368     		ldr	r3, [r4]
 165 00a0 1B68     		ldr	r3, [r3]
 166 00a2 0022     		movs	r2, #0
 167 00a4 1A64     		str	r2, [r3, #64]
 168 00a6 E6E7     		b	.L11
 169              	.L35:
  64:controller/actuators/dc_motors.c **** 		break;
 170              		.loc 1 64 3 discriminator 3 view .LVU35
 171 00a8 2368     		ldr	r3, [r4]
 172 00aa 1B68     		ldr	r3, [r3]
 173 00ac 0022     		movs	r2, #0
 174 00ae 9A63     		str	r2, [r3, #56]
 175 00b0 E1E7     		b	.L11
 176              	.L36:
  64:controller/actuators/dc_motors.c **** 		break;
 177              		.loc 1 64 3 discriminator 6 view .LVU36
 178 00b2 2368     		ldr	r3, [r4]
 179 00b4 1B68     		ldr	r3, [r3]
 180 00b6 0022     		movs	r2, #0
 181 00b8 DA63     		str	r2, [r3, #60]
 182 00ba DCE7     		b	.L11
 183              	.L4:
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 184              		.loc 1 67 3 is_stmt 1 view .LVU37
 185 00bc 6368     		ldr	r3, [r4, #4]
 186 00be 43B9     		cbnz	r3, .L14
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 187              		.loc 1 67 3 is_stmt 0 discriminator 1 view .LVU38
 188 00c0 3B68     		ldr	r3, [r7]
 189 00c2 0022     		movs	r2, #0
 190 00c4 5A63     		str	r2, [r3, #52]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 6


 191              	.L15:
  68:controller/actuators/dc_motors.c **** 		break;
 192              		.loc 1 68 3 is_stmt 1 view .LVU39
 193 00c6 A368     		ldr	r3, [r4, #8]
 194 00c8 9BB9     		cbnz	r3, .L18
  68:controller/actuators/dc_motors.c **** 		break;
 195              		.loc 1 68 3 is_stmt 0 discriminator 1 view .LVU40
 196 00ca 2368     		ldr	r3, [r4]
 197 00cc 1B68     		ldr	r3, [r3]
 198 00ce 5863     		str	r0, [r3, #52]
 199 00d0 D1E7     		b	.L11
 200              	.L14:
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 201              		.loc 1 67 3 discriminator 2 view .LVU41
 202 00d2 042B     		cmp	r3, #4
 203 00d4 05D0     		beq	.L37
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 204              		.loc 1 67 3 discriminator 4 view .LVU42
 205 00d6 082B     		cmp	r3, #8
 206 00d8 07D0     		beq	.L38
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 207              		.loc 1 67 3 discriminator 7 view .LVU43
 208 00da 3B68     		ldr	r3, [r7]
 209 00dc 0022     		movs	r2, #0
 210 00de 1A64     		str	r2, [r3, #64]
 211 00e0 F1E7     		b	.L15
 212              	.L37:
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 213              		.loc 1 67 3 discriminator 3 view .LVU44
 214 00e2 3B68     		ldr	r3, [r7]
 215 00e4 0022     		movs	r2, #0
 216 00e6 9A63     		str	r2, [r3, #56]
 217 00e8 EDE7     		b	.L15
 218              	.L38:
  67:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, compare_v
 219              		.loc 1 67 3 discriminator 6 view .LVU45
 220 00ea 3B68     		ldr	r3, [r7]
 221 00ec 0022     		movs	r2, #0
 222 00ee DA63     		str	r2, [r3, #60]
 223 00f0 E9E7     		b	.L15
 224              	.L18:
  68:controller/actuators/dc_motors.c **** 		break;
 225              		.loc 1 68 3 discriminator 2 view .LVU46
 226 00f2 042B     		cmp	r3, #4
 227 00f4 05D0     		beq	.L39
  68:controller/actuators/dc_motors.c **** 		break;
 228              		.loc 1 68 3 discriminator 4 view .LVU47
 229 00f6 082B     		cmp	r3, #8
 230 00f8 07D0     		beq	.L40
  68:controller/actuators/dc_motors.c **** 		break;
 231              		.loc 1 68 3 discriminator 7 view .LVU48
 232 00fa 2368     		ldr	r3, [r4]
 233 00fc 1B68     		ldr	r3, [r3]
 234 00fe 1864     		str	r0, [r3, #64]
 235 0100 B9E7     		b	.L11
 236              	.L39:
  68:controller/actuators/dc_motors.c **** 		break;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 7


 237              		.loc 1 68 3 discriminator 3 view .LVU49
 238 0102 2368     		ldr	r3, [r4]
 239 0104 1B68     		ldr	r3, [r3]
 240 0106 9863     		str	r0, [r3, #56]
 241 0108 B5E7     		b	.L11
 242              	.L40:
  68:controller/actuators/dc_motors.c **** 		break;
 243              		.loc 1 68 3 discriminator 6 view .LVU50
 244 010a 2368     		ldr	r3, [r4]
 245 010c 1B68     		ldr	r3, [r3]
 246 010e D863     		str	r0, [r3, #60]
 247 0110 B1E7     		b	.L11
 248              	.L21:
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 249              		.loc 1 71 3 discriminator 2 view .LVU51
 250 0112 042B     		cmp	r3, #4
 251 0114 05D0     		beq	.L41
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 252              		.loc 1 71 3 discriminator 4 view .LVU52
 253 0116 082B     		cmp	r3, #8
 254 0118 07D0     		beq	.L42
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 255              		.loc 1 71 3 discriminator 7 view .LVU53
 256 011a 3B68     		ldr	r3, [r7]
 257 011c 0022     		movs	r2, #0
 258 011e 1A64     		str	r2, [r3, #64]
 259 0120 97E7     		b	.L22
 260              	.L41:
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 261              		.loc 1 71 3 discriminator 3 view .LVU54
 262 0122 3B68     		ldr	r3, [r7]
 263 0124 0022     		movs	r2, #0
 264 0126 9A63     		str	r2, [r3, #56]
 265 0128 93E7     		b	.L22
 266              	.L42:
  71:controller/actuators/dc_motors.c **** 		__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 267              		.loc 1 71 3 discriminator 6 view .LVU55
 268 012a 3B68     		ldr	r3, [r7]
 269 012c 0022     		movs	r2, #0
 270 012e DA63     		str	r2, [r3, #60]
 271 0130 8FE7     		b	.L22
 272              	.L25:
  72:controller/actuators/dc_motors.c **** 		/**
 273              		.loc 1 72 3 discriminator 2 view .LVU56
 274 0132 042B     		cmp	r3, #4
 275 0134 06D0     		beq	.L43
  72:controller/actuators/dc_motors.c **** 		/**
 276              		.loc 1 72 3 discriminator 4 view .LVU57
 277 0136 082B     		cmp	r3, #8
 278 0138 09D0     		beq	.L44
  72:controller/actuators/dc_motors.c **** 		/**
 279              		.loc 1 72 3 discriminator 7 view .LVU58
 280 013a 2368     		ldr	r3, [r4]
 281 013c 1B68     		ldr	r3, [r3]
 282 013e 0022     		movs	r2, #0
 283 0140 1A64     		str	r2, [r3, #64]
 284 0142 98E7     		b	.L11
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 8


 285              	.L43:
  72:controller/actuators/dc_motors.c **** 		/**
 286              		.loc 1 72 3 discriminator 3 view .LVU59
 287 0144 2368     		ldr	r3, [r4]
 288 0146 1B68     		ldr	r3, [r3]
 289 0148 0022     		movs	r2, #0
 290 014a 9A63     		str	r2, [r3, #56]
 291 014c 93E7     		b	.L11
 292              	.L44:
  72:controller/actuators/dc_motors.c **** 		/**
 293              		.loc 1 72 3 discriminator 6 view .LVU60
 294 014e 2368     		ldr	r3, [r4]
 295 0150 1B68     		ldr	r3, [r3]
 296 0152 0022     		movs	r2, #0
 297 0154 DA63     		str	r2, [r3, #60]
 298 0156 8EE7     		b	.L11
 299              	.LVL9:
 300              	.L30:
 301              		.cfi_def_cfa_offset 0
 302              		.cfi_restore 3
 303              		.cfi_restore 4
 304              		.cfi_restore 5
 305              		.cfi_restore 6
 306              		.cfi_restore 7
 307              		.cfi_restore 8
 308              		.cfi_restore 9
 309              		.cfi_restore 14
  72:controller/actuators/dc_motors.c **** 		/**
 310              		.loc 1 72 3 discriminator 6 view .LVU61
 311 0158 7047     		bx	lr
 312              	.L46:
 313 015a 00BFAFF3 		.align	3
 313      0080
 314              	.L45:
 315 0160 00000000 		.word	0
 316 0164 00E06F40 		.word	1081073664
 317              		.cfi_endproc
 318              	.LFE135:
 320              		.section	.text.dc_motor_disable,"ax",%progbits
 321              		.align	1
 322              		.global	dc_motor_disable
 323              		.syntax unified
 324              		.thumb
 325              		.thumb_func
 327              	dc_motor_disable:
 328              	.LVL10:
 329              	.LFB137:
  80:controller/actuators/dc_motors.c **** 
  81:controller/actuators/dc_motors.c **** /**
  82:controller/actuators/dc_motors.c ****  * @brief sets the pwm frequency
  83:controller/actuators/dc_motors.c ****  * @note this changes the frequency of the entire timer, this includes all four channels
  84:controller/actuators/dc_motors.c ****  */
  85:controller/actuators/dc_motors.c **** void dc_motor_set_timer_freq(dc_motor_s *motor, pwm_freq_t frequency)
  86:controller/actuators/dc_motors.c **** {
  87:controller/actuators/dc_motors.c **** 	if (frequency == 0)
  88:controller/actuators/dc_motors.c **** 	{
  89:controller/actuators/dc_motors.c **** 		// Invalid frequency, return or handle error
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 9


  90:controller/actuators/dc_motors.c **** 		dc_motor_disable(motor);
  91:controller/actuators/dc_motors.c **** 		return;
  92:controller/actuators/dc_motors.c **** 	}
  93:controller/actuators/dc_motors.c **** 	if (frequency > DC_MOTOR_MAX_FREQUENCY)
  94:controller/actuators/dc_motors.c **** 	{
  95:controller/actuators/dc_motors.c **** 		frequency = DC_MOTOR_MAX_FREQUENCY;
  96:controller/actuators/dc_motors.c **** 	}
  97:controller/actuators/dc_motors.c **** 	
  98:controller/actuators/dc_motors.c **** 	uint32_t timer_clock = HAL_RCC_GetSysClockFreq(); // Get the timer clock frequency
  99:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 100:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 101:controller/actuators/dc_motors.c **** 
 102:controller/actuators/dc_motors.c **** 	// Calculate prescaler and auto-reload values
 103:controller/actuators/dc_motors.c **** 	for (prescaler = 0; prescaler <= 0xFFFF; prescaler++)
 104:controller/actuators/dc_motors.c **** 	{
 105:controller/actuators/dc_motors.c **** 		auto_reload = (timer_clock / ((prescaler + 1) * frequency)) - 1;
 106:controller/actuators/dc_motors.c **** 		
 107:controller/actuators/dc_motors.c **** 		if (auto_reload <= 0xFFFF)
 108:controller/actuators/dc_motors.c **** 		{
 109:controller/actuators/dc_motors.c **** 			break;
 110:controller/actuators/dc_motors.c **** 
 111:controller/actuators/dc_motors.c **** 		}
 112:controller/actuators/dc_motors.c **** 	}
 113:controller/actuators/dc_motors.c **** 
 114:controller/actuators/dc_motors.c **** 	if (prescaler > 0xFFFF || auto_reload > 0xFFFF)
 115:controller/actuators/dc_motors.c **** 	{
 116:controller/actuators/dc_motors.c **** 		// Frequency is too low, cannot configure timer
 117:controller/actuators/dc_motors.c **** 		return;
 118:controller/actuators/dc_motors.c **** 	}
 119:controller/actuators/dc_motors.c **** 	
 120:controller/actuators/dc_motors.c **** 	// Set the prescaler and auto-reload values
 121:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_PRESCALER((TIM_HandleTypeDef *)motor->timer, prescaler);
 122:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 123:controller/actuators/dc_motors.c **** 
 124:controller/actuators/dc_motors.c **** 	dc_motor_set(motor, motor->current_direction, motor->current_duty_cycle);
 125:controller/actuators/dc_motors.c **** }
 126:controller/actuators/dc_motors.c **** 
 127:controller/actuators/dc_motors.c **** /**
 128:controller/actuators/dc_motors.c ****  * @brief disables the motor.
 129:controller/actuators/dc_motors.c ****  */
 130:controller/actuators/dc_motors.c **** void dc_motor_disable(dc_motor_s *motor)
 131:controller/actuators/dc_motors.c **** {
 330              		.loc 1 131 1 is_stmt 1 view -0
 331              		.cfi_startproc
 332              		@ args = 0, pretend = 0, frame = 0
 333              		@ frame_needed = 0, uses_anonymous_args = 0
 334              		@ link register save eliminated.
 132:controller/actuators/dc_motors.c **** 	if (motor == NULL || motor->timer == NULL)
 335              		.loc 1 132 2 view .LVU63
 336              		.loc 1 132 5 is_stmt 0 view .LVU64
 337 0000 0346     		mov	r3, r0
 338 0002 78B1     		cbz	r0, .L47
 339              		.loc 1 132 28 discriminator 1 view .LVU65
 340 0004 0268     		ldr	r2, [r0]
 341              		.loc 1 132 20 discriminator 1 view .LVU66
 342 0006 6AB1     		cbz	r2, .L47
 133:controller/actuators/dc_motors.c **** 	{
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 10


 134:controller/actuators/dc_motors.c **** 		return;
 135:controller/actuators/dc_motors.c **** 		/**
 136:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 137:controller/actuators/dc_motors.c **** 		 */
 138:controller/actuators/dc_motors.c **** 	}
 139:controller/actuators/dc_motors.c **** 
 140:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
 343              		.loc 1 141 2 is_stmt 1 view .LVU67
 344 0008 4168     		ldr	r1, [r0, #4]
 345 000a 61B9     		cbnz	r1, .L49
 346              		.loc 1 141 2 is_stmt 0 discriminator 1 view .LVU68
 347 000c 1268     		ldr	r2, [r2]
 348 000e 5163     		str	r1, [r2, #52]
 349              	.L50:
 142:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 350              		.loc 1 142 2 is_stmt 1 view .LVU69
 351 0010 9A68     		ldr	r2, [r3, #8]
 352 0012 C2B9     		cbnz	r2, .L53
 353              		.loc 1 142 2 is_stmt 0 discriminator 1 view .LVU70
 354 0014 1A68     		ldr	r2, [r3]
 355 0016 1268     		ldr	r2, [r2]
 356 0018 0021     		movs	r1, #0
 357 001a 5163     		str	r1, [r2, #52]
 358              	.L54:
 143:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 359              		.loc 1 143 2 is_stmt 1 view .LVU71
 360              		.loc 1 143 28 is_stmt 0 view .LVU72
 361 001c 0022     		movs	r2, #0
 362 001e 5A73     		strb	r2, [r3, #13]
 144:controller/actuators/dc_motors.c **** 
 145:controller/actuators/dc_motors.c **** 	motor->status = MS_DISABLED;
 363              		.loc 1 145 2 is_stmt 1 view .LVU73
 364              		.loc 1 145 16 is_stmt 0 view .LVU74
 365 0020 0222     		movs	r2, #2
 366 0022 9A73     		strb	r2, [r3, #14]
 367              	.L47:
 146:controller/actuators/dc_motors.c **** }
 368              		.loc 1 146 1 view .LVU75
 369 0024 7047     		bx	lr
 370              	.L49:
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 371              		.loc 1 141 2 discriminator 2 view .LVU76
 372 0026 0429     		cmp	r1, #4
 373 0028 05D0     		beq	.L57
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 374              		.loc 1 141 2 discriminator 4 view .LVU77
 375 002a 0829     		cmp	r1, #8
 376 002c 07D0     		beq	.L58
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 377              		.loc 1 141 2 discriminator 7 view .LVU78
 378 002e 1268     		ldr	r2, [r2]
 379 0030 0021     		movs	r1, #0
 380 0032 1164     		str	r1, [r2, #64]
 381 0034 ECE7     		b	.L50
 382              	.L57:
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 11


 383              		.loc 1 141 2 discriminator 3 view .LVU79
 384 0036 1268     		ldr	r2, [r2]
 385 0038 0021     		movs	r1, #0
 386 003a 9163     		str	r1, [r2, #56]
 387 003c E8E7     		b	.L50
 388              	.L58:
 141:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 389              		.loc 1 141 2 discriminator 6 view .LVU80
 390 003e 1268     		ldr	r2, [r2]
 391 0040 0021     		movs	r1, #0
 392 0042 D163     		str	r1, [r2, #60]
 393 0044 E4E7     		b	.L50
 394              	.L53:
 142:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 395              		.loc 1 142 2 discriminator 2 view .LVU81
 396 0046 042A     		cmp	r2, #4
 397 0048 06D0     		beq	.L59
 142:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 398              		.loc 1 142 2 discriminator 4 view .LVU82
 399 004a 082A     		cmp	r2, #8
 400 004c 09D0     		beq	.L60
 142:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 401              		.loc 1 142 2 discriminator 7 view .LVU83
 402 004e 1A68     		ldr	r2, [r3]
 403 0050 1268     		ldr	r2, [r2]
 404 0052 0021     		movs	r1, #0
 405 0054 1164     		str	r1, [r2, #64]
 406 0056 E1E7     		b	.L54
 407              	.L59:
 142:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 408              		.loc 1 142 2 discriminator 3 view .LVU84
 409 0058 1A68     		ldr	r2, [r3]
 410 005a 1268     		ldr	r2, [r2]
 411 005c 0021     		movs	r1, #0
 412 005e 9163     		str	r1, [r2, #56]
 413 0060 DCE7     		b	.L54
 414              	.L60:
 142:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 415              		.loc 1 142 2 discriminator 6 view .LVU85
 416 0062 1A68     		ldr	r2, [r3]
 417 0064 1268     		ldr	r2, [r2]
 418 0066 0021     		movs	r1, #0
 419 0068 D163     		str	r1, [r2, #60]
 420 006a D7E7     		b	.L54
 421              		.cfi_endproc
 422              	.LFE137:
 424              		.section	.text.dc_motor_set_timer_freq,"ax",%progbits
 425              		.align	1
 426              		.global	dc_motor_set_timer_freq
 427              		.syntax unified
 428              		.thumb
 429              		.thumb_func
 431              	dc_motor_set_timer_freq:
 432              	.LVL11:
 433              	.LFB136:
  86:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 434              		.loc 1 86 1 is_stmt 1 view -0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 12


 435              		.cfi_startproc
 436              		@ args = 0, pretend = 0, frame = 0
 437              		@ frame_needed = 0, uses_anonymous_args = 0
  86:controller/actuators/dc_motors.c **** 	if (frequency == 0)
 438              		.loc 1 86 1 is_stmt 0 view .LVU87
 439 0000 38B5     		push	{r3, r4, r5, lr}
 440              		.cfi_def_cfa_offset 16
 441              		.cfi_offset 3, -16
 442              		.cfi_offset 4, -12
 443              		.cfi_offset 5, -8
 444              		.cfi_offset 14, -4
 445 0002 0546     		mov	r5, r0
  87:controller/actuators/dc_motors.c **** 	{
 446              		.loc 1 87 2 is_stmt 1 view .LVU88
  87:controller/actuators/dc_motors.c **** 	{
 447              		.loc 1 87 5 is_stmt 0 view .LVU89
 448 0004 99B1     		cbz	r1, .L69
 449 0006 0C46     		mov	r4, r1
  93:controller/actuators/dc_motors.c **** 	{
 450              		.loc 1 93 2 is_stmt 1 view .LVU90
  93:controller/actuators/dc_motors.c **** 	{
 451              		.loc 1 93 5 is_stmt 0 view .LVU91
 452 0008 42F21073 		movw	r3, #10000
 453 000c 9942     		cmp	r1, r3
 454 000e 00D9     		bls	.L64
  95:controller/actuators/dc_motors.c **** 	}
 455              		.loc 1 95 13 view .LVU92
 456 0010 1C46     		mov	r4, r3
 457              	.L64:
 458              	.LVL12:
  98:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 459              		.loc 1 98 2 is_stmt 1 view .LVU93
  98:controller/actuators/dc_motors.c **** 	uint16_t prescaler = 0;
 460              		.loc 1 98 25 is_stmt 0 view .LVU94
 461 0012 FFF7FEFF 		bl	HAL_RCC_GetSysClockFreq
 462              	.LVL13:
  99:controller/actuators/dc_motors.c **** 	uint32_t auto_reload = 0;
 463              		.loc 1 99 2 is_stmt 1 view .LVU95
 100:controller/actuators/dc_motors.c **** 
 464              		.loc 1 100 2 view .LVU96
 103:controller/actuators/dc_motors.c **** 	{
 465              		.loc 1 103 2 view .LVU97
 103:controller/actuators/dc_motors.c **** 	{
 466              		.loc 1 103 17 is_stmt 0 view .LVU98
 467 0016 0022     		movs	r2, #0
 468              	.LVL14:
 469              	.L66:
 105:controller/actuators/dc_motors.c **** 		
 470              		.loc 1 105 3 is_stmt 1 view .LVU99
 105:controller/actuators/dc_motors.c **** 		
 471              		.loc 1 105 49 is_stmt 0 view .LVU100
 472 0018 02FB0443 		mla	r3, r2, r4, r4
 105:controller/actuators/dc_motors.c **** 		
 473              		.loc 1 105 30 view .LVU101
 474 001c B0FBF3F3 		udiv	r3, r0, r3
 105:controller/actuators/dc_motors.c **** 		
 475              		.loc 1 105 15 view .LVU102
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 13


 476 0020 013B     		subs	r3, r3, #1
 477              	.LVL15:
 107:controller/actuators/dc_motors.c **** 		{
 478              		.loc 1 107 3 is_stmt 1 view .LVU103
 107:controller/actuators/dc_motors.c **** 		{
 479              		.loc 1 107 6 is_stmt 0 view .LVU104
 480 0022 B3F5803F 		cmp	r3, #65536
 481 0026 05D3     		bcc	.L65
 103:controller/actuators/dc_motors.c **** 	{
 482              		.loc 1 103 52 is_stmt 1 view .LVU105
 483 0028 0132     		adds	r2, r2, #1
 484              	.LVL16:
 103:controller/actuators/dc_motors.c **** 	{
 485              		.loc 1 103 52 is_stmt 0 view .LVU106
 486 002a 92B2     		uxth	r2, r2
 487              	.LVL17:
 103:controller/actuators/dc_motors.c **** 	{
 488              		.loc 1 103 2 is_stmt 1 view .LVU107
 105:controller/actuators/dc_motors.c **** 		
 489              		.loc 1 105 15 is_stmt 0 view .LVU108
 490 002c F4E7     		b	.L66
 491              	.LVL18:
 492              	.L69:
  90:controller/actuators/dc_motors.c **** 		return;
 493              		.loc 1 90 3 is_stmt 1 view .LVU109
 494 002e FFF7FEFF 		bl	dc_motor_disable
 495              	.LVL19:
  91:controller/actuators/dc_motors.c **** 	}
 496              		.loc 1 91 3 view .LVU110
 497 0032 0CE0     		b	.L61
 498              	.LVL20:
 499              	.L65:
 114:controller/actuators/dc_motors.c **** 	{
 500              		.loc 1 114 2 view .LVU111
 121:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_AUTORELOAD((TIM_HandleTypeDef *)motor->timer, auto_reload);
 501              		.loc 1 121 2 view .LVU112
 502 0034 2968     		ldr	r1, [r5]
 503 0036 0968     		ldr	r1, [r1]
 504 0038 8A62     		str	r2, [r1, #40]
 122:controller/actuators/dc_motors.c **** 
 505              		.loc 1 122 2 view .LVU113
 122:controller/actuators/dc_motors.c **** 
 506              		.loc 1 122 2 view .LVU114
 507 003a 2A68     		ldr	r2, [r5]
 508              	.LVL21:
 122:controller/actuators/dc_motors.c **** 
 509              		.loc 1 122 2 is_stmt 0 view .LVU115
 510 003c 1268     		ldr	r2, [r2]
 511 003e D362     		str	r3, [r2, #44]
 512              	.LVL22:
 122:controller/actuators/dc_motors.c **** 
 513              		.loc 1 122 2 is_stmt 1 view .LVU116
 514 0040 2A68     		ldr	r2, [r5]
 515 0042 D360     		str	r3, [r2, #12]
 122:controller/actuators/dc_motors.c **** 
 516              		.loc 1 122 2 view .LVU117
 124:controller/actuators/dc_motors.c **** }
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 14


 517              		.loc 1 124 2 view .LVU118
 518 0044 6A7B     		ldrb	r2, [r5, #13]	@ zero_extendqisi2
 519 0046 297B     		ldrb	r1, [r5, #12]	@ zero_extendqisi2
 520 0048 2846     		mov	r0, r5
 521              	.LVL23:
 124:controller/actuators/dc_motors.c **** }
 522              		.loc 1 124 2 is_stmt 0 view .LVU119
 523 004a FFF7FEFF 		bl	dc_motor_set
 524              	.LVL24:
 525              	.L61:
 125:controller/actuators/dc_motors.c **** 
 526              		.loc 1 125 1 view .LVU120
 527 004e 38BD     		pop	{r3, r4, r5, pc}
 125:controller/actuators/dc_motors.c **** 
 528              		.loc 1 125 1 view .LVU121
 529              		.cfi_endproc
 530              	.LFE136:
 532              		.section	.text.dc_motor_init,"ax",%progbits
 533              		.align	1
 534              		.global	dc_motor_init
 535              		.syntax unified
 536              		.thumb
 537              		.thumb_func
 539              	dc_motor_init:
 540              	.LVL25:
 541              	.LFB134:
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 542              		.loc 1 13 1 is_stmt 1 view -0
 543              		.cfi_startproc
 544              		@ args = 4, pretend = 0, frame = 0
 545              		@ frame_needed = 0, uses_anonymous_args = 0
  14:controller/actuators/dc_motors.c ****     {
 546              		.loc 1 14 5 view .LVU123
  14:controller/actuators/dc_motors.c ****     {
 547              		.loc 1 14 8 is_stmt 0 view .LVU124
 548 0000 0028     		cmp	r0, #0
 549 0002 4CD0     		beq	.L81
  13:controller/actuators/dc_motors.c ****     if (motor == NULL || timer == NULL)
 550              		.loc 1 13 1 view .LVU125
 551 0004 10B5     		push	{r4, lr}
 552              		.cfi_def_cfa_offset 8
 553              		.cfi_offset 4, -8
 554              		.cfi_offset 14, -4
 555 0006 0446     		mov	r4, r0
  14:controller/actuators/dc_motors.c ****     {
 556              		.loc 1 14 23 discriminator 1 view .LVU126
 557 0008 11B3     		cbz	r1, .L70
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 558              		.loc 1 22 5 is_stmt 1 view .LVU127
  22:controller/actuators/dc_motors.c ****     motor->timer_channel_output_1 = timer_channel_output_1;
 559              		.loc 1 22 18 is_stmt 0 view .LVU128
 560 000a 0160     		str	r1, [r0]
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 561              		.loc 1 23 5 is_stmt 1 view .LVU129
  23:controller/actuators/dc_motors.c ****     motor->timer_channel_output_2 = timer_channel_output_2;
 562              		.loc 1 23 35 is_stmt 0 view .LVU130
 563 000c 4260     		str	r2, [r0, #4]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 15


  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
 564              		.loc 1 24 5 is_stmt 1 view .LVU131
  24:controller/actuators/dc_motors.c **** 	motor->current_direction = MD_FORWARD;
 565              		.loc 1 24 35 is_stmt 0 view .LVU132
 566 000e 8360     		str	r3, [r0, #8]
  25:controller/actuators/dc_motors.c **** 	/**
 567              		.loc 1 25 2 is_stmt 1 view .LVU133
  25:controller/actuators/dc_motors.c **** 	/**
 568              		.loc 1 25 27 is_stmt 0 view .LVU134
 569 0010 0023     		movs	r3, #0
 570              	.LVL26:
  25:controller/actuators/dc_motors.c **** 	/**
 571              		.loc 1 25 27 view .LVU135
 572 0012 0373     		strb	r3, [r0, #12]
  29:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 573              		.loc 1 29 2 is_stmt 1 view .LVU136
 574 0014 0846     		mov	r0, r1
 575              	.LVL27:
  29:controller/actuators/dc_motors.c **** 	dc_motor_set_timer_freq(motor, frequency);
 576              		.loc 1 29 2 is_stmt 0 view .LVU137
 577 0016 FFF7FEFF 		bl	HAL_TIM_Base_Start
 578              	.LVL28:
  30:controller/actuators/dc_motors.c **** 	// Set initial duty cycle to 0 for both channels
 579              		.loc 1 30 2 is_stmt 1 view .LVU138
 580 001a BDF80810 		ldrh	r1, [sp, #8]
 581 001e 2046     		mov	r0, r4
 582 0020 FFF7FEFF 		bl	dc_motor_set_timer_freq
 583              	.LVL29:
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 584              		.loc 1 32 2 view .LVU139
 585 0024 6368     		ldr	r3, [r4, #4]
 586 0026 A3B9     		cbnz	r3, .L72
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 587              		.loc 1 32 2 is_stmt 0 discriminator 1 view .LVU140
 588 0028 2368     		ldr	r3, [r4]
 589 002a 1B68     		ldr	r3, [r3]
 590 002c 0022     		movs	r2, #0
 591 002e 5A63     		str	r2, [r3, #52]
 592              	.L73:
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 593              		.loc 1 33 2 is_stmt 1 view .LVU141
 594 0030 A368     		ldr	r3, [r4, #8]
 595 0032 0BBB     		cbnz	r3, .L76
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 596              		.loc 1 33 2 is_stmt 0 discriminator 1 view .LVU142
 597 0034 2368     		ldr	r3, [r4]
 598 0036 1B68     		ldr	r3, [r3]
 599 0038 0022     		movs	r2, #0
 600 003a 5A63     		str	r2, [r3, #52]
 601              	.L77:
  34:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2);
 602              		.loc 1 34 2 is_stmt 1 view .LVU143
 603 003c 6168     		ldr	r1, [r4, #4]
 604 003e 2068     		ldr	r0, [r4]
 605 0040 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 606              	.LVL30:
  35:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 16


 607              		.loc 1 35 2 view .LVU144
 608 0044 A168     		ldr	r1, [r4, #8]
 609 0046 2068     		ldr	r0, [r4]
 610 0048 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 611              	.LVL31:
  36:controller/actuators/dc_motors.c **** }
 612              		.loc 1 36 2 view .LVU145
  36:controller/actuators/dc_motors.c **** }
 613              		.loc 1 36 28 is_stmt 0 view .LVU146
 614 004c 0023     		movs	r3, #0
 615 004e 6373     		strb	r3, [r4, #13]
 616              	.L70:
  37:controller/actuators/dc_motors.c **** 
 617              		.loc 1 37 1 view .LVU147
 618 0050 10BD     		pop	{r4, pc}
 619              	.LVL32:
 620              	.L72:
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 621              		.loc 1 32 2 discriminator 2 view .LVU148
 622 0052 042B     		cmp	r3, #4
 623 0054 06D0     		beq	.L84
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 624              		.loc 1 32 2 discriminator 4 view .LVU149
 625 0056 082B     		cmp	r3, #8
 626 0058 09D0     		beq	.L85
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 627              		.loc 1 32 2 discriminator 7 view .LVU150
 628 005a 2368     		ldr	r3, [r4]
 629 005c 1B68     		ldr	r3, [r3]
 630 005e 0022     		movs	r2, #0
 631 0060 1A64     		str	r2, [r3, #64]
 632 0062 E5E7     		b	.L73
 633              	.L84:
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 634              		.loc 1 32 2 discriminator 3 view .LVU151
 635 0064 2368     		ldr	r3, [r4]
 636 0066 1B68     		ldr	r3, [r3]
 637 0068 0022     		movs	r2, #0
 638 006a 9A63     		str	r2, [r3, #56]
 639 006c E0E7     		b	.L73
 640              	.L85:
  32:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 641              		.loc 1 32 2 discriminator 6 view .LVU152
 642 006e 2368     		ldr	r3, [r4]
 643 0070 1B68     		ldr	r3, [r3]
 644 0072 0022     		movs	r2, #0
 645 0074 DA63     		str	r2, [r3, #60]
 646 0076 DBE7     		b	.L73
 647              	.L76:
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 648              		.loc 1 33 2 discriminator 2 view .LVU153
 649 0078 042B     		cmp	r3, #4
 650 007a 06D0     		beq	.L86
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 651              		.loc 1 33 2 discriminator 4 view .LVU154
 652 007c 082B     		cmp	r3, #8
 653 007e 09D0     		beq	.L87
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 17


  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 654              		.loc 1 33 2 discriminator 7 view .LVU155
 655 0080 2368     		ldr	r3, [r4]
 656 0082 1B68     		ldr	r3, [r3]
 657 0084 0022     		movs	r2, #0
 658 0086 1A64     		str	r2, [r3, #64]
 659 0088 D8E7     		b	.L77
 660              	.L86:
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 661              		.loc 1 33 2 discriminator 3 view .LVU156
 662 008a 2368     		ldr	r3, [r4]
 663 008c 1B68     		ldr	r3, [r3]
 664 008e 0022     		movs	r2, #0
 665 0090 9A63     		str	r2, [r3, #56]
 666 0092 D3E7     		b	.L77
 667              	.L87:
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 668              		.loc 1 33 2 discriminator 6 view .LVU157
 669 0094 2368     		ldr	r3, [r4]
 670 0096 1B68     		ldr	r3, [r3]
 671 0098 0022     		movs	r2, #0
 672 009a DA63     		str	r2, [r3, #60]
 673 009c CEE7     		b	.L77
 674              	.LVL33:
 675              	.L81:
 676              		.cfi_def_cfa_offset 0
 677              		.cfi_restore 4
 678              		.cfi_restore 14
  33:controller/actuators/dc_motors.c **** 	HAL_TIM_PWM_Start((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1);
 679              		.loc 1 33 2 discriminator 6 view .LVU158
 680 009e 7047     		bx	lr
 681              		.cfi_endproc
 682              	.LFE134:
 684              		.section	.text.dc_motor_enable,"ax",%progbits
 685              		.align	1
 686              		.global	dc_motor_enable
 687              		.syntax unified
 688              		.thumb
 689              		.thumb_func
 691              	dc_motor_enable:
 692              	.LVL34:
 693              	.LFB138:
 147:controller/actuators/dc_motors.c **** 
 148:controller/actuators/dc_motors.c **** /**
 149:controller/actuators/dc_motors.c ****  * @brief enables the motor.
 150:controller/actuators/dc_motors.c ****  * @note sets the duty cycle to 0 for safety
 151:controller/actuators/dc_motors.c ****  */
 152:controller/actuators/dc_motors.c **** void dc_motor_enable(dc_motor_s *motor)
 153:controller/actuators/dc_motors.c **** {
 694              		.loc 1 153 1 is_stmt 1 view -0
 695              		.cfi_startproc
 696              		@ args = 0, pretend = 0, frame = 0
 697              		@ frame_needed = 0, uses_anonymous_args = 0
 698              		@ link register save eliminated.
 154:controller/actuators/dc_motors.c **** 	if (motor->status == MS_NORMAL || motor->status == MS_FAULT || motor == NULL)
 699              		.loc 1 154 2 view .LVU160
 700              		.loc 1 154 11 is_stmt 0 view .LVU161
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 18


 701 0000 837B     		ldrb	r3, [r0, #14]	@ zero_extendqisi2
 702              		.loc 1 154 5 view .LVU162
 703 0002 012B     		cmp	r3, #1
 704 0004 0ED9     		bls	.L88
 155:controller/actuators/dc_motors.c **** 	{
 156:controller/actuators/dc_motors.c **** 		return;
 157:controller/actuators/dc_motors.c **** 		/**
 158:controller/actuators/dc_motors.c **** 		 * @todo throw an error
 159:controller/actuators/dc_motors.c **** 		 */
 160:controller/actuators/dc_motors.c **** 	}
 161:controller/actuators/dc_motors.c **** 
 162:controller/actuators/dc_motors.c **** 	// Set duty cycle to 0 for both channels
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_1, 0);
 705              		.loc 1 163 2 is_stmt 1 view .LVU163
 706 0006 4368     		ldr	r3, [r0, #4]
 707 0008 6BB9     		cbnz	r3, .L90
 708              		.loc 1 163 2 is_stmt 0 discriminator 1 view .LVU164
 709 000a 0368     		ldr	r3, [r0]
 710 000c 1B68     		ldr	r3, [r3]
 711 000e 0022     		movs	r2, #0
 712 0010 5A63     		str	r2, [r3, #52]
 713              	.L91:
 164:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 714              		.loc 1 164 2 is_stmt 1 view .LVU165
 715 0012 8368     		ldr	r3, [r0, #8]
 716 0014 D3B9     		cbnz	r3, .L94
 717              		.loc 1 164 2 is_stmt 0 discriminator 1 view .LVU166
 718 0016 0368     		ldr	r3, [r0]
 719 0018 1B68     		ldr	r3, [r3]
 720 001a 0022     		movs	r2, #0
 721 001c 5A63     		str	r2, [r3, #52]
 722              	.L95:
 165:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 723              		.loc 1 165 2 is_stmt 1 view .LVU167
 724              		.loc 1 165 28 is_stmt 0 view .LVU168
 725 001e 0023     		movs	r3, #0
 726 0020 4373     		strb	r3, [r0, #13]
 166:controller/actuators/dc_motors.c **** 	motor->status = MS_NORMAL;
 727              		.loc 1 166 2 is_stmt 1 view .LVU169
 728              		.loc 1 166 16 is_stmt 0 view .LVU170
 729 0022 8373     		strb	r3, [r0, #14]
 730              	.L88:
 167:controller/actuators/dc_motors.c **** }
 731              		.loc 1 167 1 view .LVU171
 732 0024 7047     		bx	lr
 733              	.L90:
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 734              		.loc 1 163 2 discriminator 2 view .LVU172
 735 0026 042B     		cmp	r3, #4
 736 0028 06D0     		beq	.L98
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 737              		.loc 1 163 2 discriminator 4 view .LVU173
 738 002a 082B     		cmp	r3, #8
 739 002c 09D0     		beq	.L99
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 740              		.loc 1 163 2 discriminator 7 view .LVU174
 741 002e 0368     		ldr	r3, [r0]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 19


 742 0030 1B68     		ldr	r3, [r3]
 743 0032 0022     		movs	r2, #0
 744 0034 1A64     		str	r2, [r3, #64]
 745 0036 ECE7     		b	.L91
 746              	.L98:
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 747              		.loc 1 163 2 discriminator 3 view .LVU175
 748 0038 0368     		ldr	r3, [r0]
 749 003a 1B68     		ldr	r3, [r3]
 750 003c 0022     		movs	r2, #0
 751 003e 9A63     		str	r2, [r3, #56]
 752 0040 E7E7     		b	.L91
 753              	.L99:
 163:controller/actuators/dc_motors.c **** 	__HAL_TIM_SET_COMPARE((TIM_HandleTypeDef *)motor->timer, motor->timer_channel_output_2, 0);
 754              		.loc 1 163 2 discriminator 6 view .LVU176
 755 0042 0368     		ldr	r3, [r0]
 756 0044 1B68     		ldr	r3, [r3]
 757 0046 0022     		movs	r2, #0
 758 0048 DA63     		str	r2, [r3, #60]
 759 004a E2E7     		b	.L91
 760              	.L94:
 164:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 761              		.loc 1 164 2 discriminator 2 view .LVU177
 762 004c 042B     		cmp	r3, #4
 763 004e 06D0     		beq	.L100
 164:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 764              		.loc 1 164 2 discriminator 4 view .LVU178
 765 0050 082B     		cmp	r3, #8
 766 0052 09D0     		beq	.L101
 164:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 767              		.loc 1 164 2 discriminator 7 view .LVU179
 768 0054 0368     		ldr	r3, [r0]
 769 0056 1B68     		ldr	r3, [r3]
 770 0058 0022     		movs	r2, #0
 771 005a 1A64     		str	r2, [r3, #64]
 772 005c DFE7     		b	.L95
 773              	.L100:
 164:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 774              		.loc 1 164 2 discriminator 3 view .LVU180
 775 005e 0368     		ldr	r3, [r0]
 776 0060 1B68     		ldr	r3, [r3]
 777 0062 0022     		movs	r2, #0
 778 0064 9A63     		str	r2, [r3, #56]
 779 0066 DAE7     		b	.L95
 780              	.L101:
 164:controller/actuators/dc_motors.c **** 	motor->current_duty_cycle = 0;
 781              		.loc 1 164 2 discriminator 6 view .LVU181
 782 0068 0368     		ldr	r3, [r0]
 783 006a 1B68     		ldr	r3, [r3]
 784 006c 0022     		movs	r2, #0
 785 006e DA63     		str	r2, [r3, #60]
 786 0070 D5E7     		b	.L95
 787              		.cfi_endproc
 788              	.LFE138:
 790              		.text
 791              	.Letext0:
 792              		.file 2 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 20


 793              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 794              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 795              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 796              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 797              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 798              		.file 8 "controller/types.h"
 799              		.file 9 "controller/actuators/dc_motors.h"
 800              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_rcc.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s 			page 21


DEFINED SYMBOLS
                            *ABS*:00000000 dc_motors.c
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:21     .text.dc_motor_set:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:27     .text.dc_motor_set:00000000 dc_motor_set
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:315    .text.dc_motor_set:00000160 $d
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:321    .text.dc_motor_disable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:327    .text.dc_motor_disable:00000000 dc_motor_disable
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:425    .text.dc_motor_set_timer_freq:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:431    .text.dc_motor_set_timer_freq:00000000 dc_motor_set_timer_freq
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:533    .text.dc_motor_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:539    .text.dc_motor_init:00000000 dc_motor_init
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:685    .text.dc_motor_enable:00000000 $t
C:\Users\alireza\AppData\Local\Temp\ccnuNbGC.s:691    .text.dc_motor_enable:00000000 dc_motor_enable

UNDEFINED SYMBOLS
__aeabi_i2d
__aeabi_ddiv
__aeabi_ui2d
__aeabi_dmul
__aeabi_d2uiz
HAL_RCC_GetSysClockFreq
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
