ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"ignition.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/engine_cycle/ignition.c"
  20              		.section	.rodata.ignition_coil_begin_charge.str1.4,"aMS",%progbits,1
  21              		.align	2
  22              	.LC0:
  23 0000 556E6B6F 		.ascii	"Unkown ignition output\000"
  23      776E2069 
  23      676E6974 
  23      696F6E20 
  23      6F757470 
  24              		.section	.text.ignition_coil_begin_charge,"ax",%progbits
  25              		.align	1
  26              		.global	ignition_coil_begin_charge
  27              		.syntax unified
  28              		.thumb
  29              		.thumb_func
  31              	ignition_coil_begin_charge:
  32              	.LVL0:
  33              	.LFB234:
   1:controller/engine_cycle/ignition.c **** #include "ignition.h"
   2:controller/engine_cycle/ignition.c **** 
   3:controller/engine_cycle/ignition.c **** controller_output_pin_t *ignition_outputs = NULL;
   4:controller/engine_cycle/ignition.c **** 
   5:controller/engine_cycle/ignition.c **** volatile ignition_coil_state_t ignition_coil_state[FIRMWARE_IGNITION_OUTPUT_COUNT] = {0};
   6:controller/engine_cycle/ignition.c **** 
   7:controller/engine_cycle/ignition.c **** uint8_t ignition_order[FIRMWARE_LIMIT_NUMBER_OF_CYLINDERS_MAX] = {0};
   8:controller/engine_cycle/ignition.c **** 
   9:controller/engine_cycle/ignition.c **** static volatile bool spark_is_in_progress = false;
  10:controller/engine_cycle/ignition.c **** 
  11:controller/engine_cycle/ignition.c **** static uint8_t number_of_cylinders = 0;
  12:controller/engine_cycle/ignition.c **** 
  13:controller/engine_cycle/ignition.c **** bool ignition_init(controller_output_pin_t *outputs)
  14:controller/engine_cycle/ignition.c **** {
  15:controller/engine_cycle/ignition.c ****     if (outputs == NULL)
  16:controller/engine_cycle/ignition.c ****     {
  17:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
  18:controller/engine_cycle/ignition.c ****         log_error("ignition init failed. No output config");
  19:controller/engine_cycle/ignition.c ****         return false;
  20:controller/engine_cycle/ignition.c ****     }
  21:controller/engine_cycle/ignition.c ****     ignition_outputs = outputs;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 2


  22:controller/engine_cycle/ignition.c **** 
  23:controller/engine_cycle/ignition.c ****     switch (config.firing_order)
  24:controller/engine_cycle/ignition.c ****     {
  25:controller/engine_cycle/ignition.c ****     case FO_1342: // Common inline-4
  26:controller/engine_cycle/ignition.c ****         number_of_cylinders = 4;
  27:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
  28:controller/engine_cycle/ignition.c ****         {
  29:controller/engine_cycle/ignition.c ****         case IM_ONE_COIL:
  30:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  31:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
  32:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
  33:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
  34:controller/engine_cycle/ignition.c ****             break;
  35:controller/engine_cycle/ignition.c ****         case IM_WASTED_SPARK:
  36:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  37:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
  38:controller/engine_cycle/ignition.c ****             ignition_order[2] = 2;
  39:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
  40:controller/engine_cycle/ignition.c ****             break;
  41:controller/engine_cycle/ignition.c ****         case IM_INDIVIDUAL_COILS:
  42:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  43:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
  44:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
  45:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
  46:controller/engine_cycle/ignition.c ****             break;
  47:controller/engine_cycle/ignition.c **** 
  48:controller/engine_cycle/ignition.c ****         default:
  49:controller/engine_cycle/ignition.c ****             change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
  50:controller/engine_cycle/ignition.c ****             log_error("ignition init failed. unkown mode.");
  51:controller/engine_cycle/ignition.c ****             return false;
  52:controller/engine_cycle/ignition.c ****         }
  53:controller/engine_cycle/ignition.c **** 
  54:controller/engine_cycle/ignition.c ****         break;
  55:controller/engine_cycle/ignition.c ****     case FO_153624: // Common inline-6
  56:controller/engine_cycle/ignition.c ****         number_of_cylinders = 6;
  57:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
  58:controller/engine_cycle/ignition.c ****         {
  59:controller/engine_cycle/ignition.c ****         case IM_ONE_COIL:
  60:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  61:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
  62:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
  63:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
  64:controller/engine_cycle/ignition.c ****             ignition_order[4] = 1;
  65:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
  66:controller/engine_cycle/ignition.c ****             break;
  67:controller/engine_cycle/ignition.c ****         case IM_WASTED_SPARK:
  68:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  69:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
  70:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
  71:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
  72:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
  73:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
  74:controller/engine_cycle/ignition.c ****             break;
  75:controller/engine_cycle/ignition.c ****         case IM_INDIVIDUAL_COILS:
  76:controller/engine_cycle/ignition.c ****             config.ignition_mode = IM_WASTED_SPARK;
  77:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  78:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 3


  79:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
  80:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
  81:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
  82:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
  83:controller/engine_cycle/ignition.c ****             log_warning("Coil on plug igntion not possible with 6 cylinders. Defaulted to wasted sp
  84:controller/engine_cycle/ignition.c ****             break;
  85:controller/engine_cycle/ignition.c **** 
  86:controller/engine_cycle/ignition.c ****         default:
  87:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
  88:controller/engine_cycle/ignition.c ****             log_error("ignition init failed. unkown mode.");
  89:controller/engine_cycle/ignition.c ****             return false;
  90:controller/engine_cycle/ignition.c ****         }
  91:controller/engine_cycle/ignition.c ****         break;
  92:controller/engine_cycle/ignition.c ****     default:
  93:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
  94:controller/engine_cycle/ignition.c ****         log_error("ignition init failed. unkown firing order.");
  95:controller/engine_cycle/ignition.c ****         return false;
  96:controller/engine_cycle/ignition.c ****     }
  97:controller/engine_cycle/ignition.c **** 
  98:controller/engine_cycle/ignition.c ****     runtime.firing_interval_deg = (angle_t)720 / (angle_t)number_of_cylinders;
  99:controller/engine_cycle/ignition.c **** 
 100:controller/engine_cycle/ignition.c ****     /* Read the pin states from real hardware */
 101:controller/engine_cycle/ignition.c ****     for (size_t i = 0; i < FIRMWARE_IGNITION_OUTPUT_COUNT; i++)
 102:controller/engine_cycle/ignition.c ****     {
 103:controller/engine_cycle/ignition.c ****         ignition_coil_state[i] = HAL_GPIO_ReadPin(ignition_outputs[i].gpio, ignition_outputs[i].pin
 104:controller/engine_cycle/ignition.c ****     }
 105:controller/engine_cycle/ignition.c ****     /* Set all outputs to reset just in case */
 106:controller/engine_cycle/ignition.c ****     for (size_t i = 0; i < FIRMWARE_IGNITION_OUTPUT_COUNT; i++)
 107:controller/engine_cycle/ignition.c ****     {
 108:controller/engine_cycle/ignition.c ****         HAL_GPIO_WritePin(ignition_outputs[i].gpio, ignition_outputs[i].pin, GPIO_PIN_RESET);
 109:controller/engine_cycle/ignition.c ****     }
 110:controller/engine_cycle/ignition.c **** 
 111:controller/engine_cycle/ignition.c ****     if (config.multi_spark_enabled && !IS_IN_RANGE(config.multi_spark_number_of_sparks, 0, IGNITION
 112:controller/engine_cycle/ignition.c ****     {
 113:controller/engine_cycle/ignition.c ****         log_warning("Multi spark is enabled but number of sparks are 0.");
 114:controller/engine_cycle/ignition.c ****     }
 115:controller/engine_cycle/ignition.c ****     return true;
 116:controller/engine_cycle/ignition.c **** }
 117:controller/engine_cycle/ignition.c **** 
 118:controller/engine_cycle/ignition.c **** /**
 119:controller/engine_cycle/ignition.c ****  * @brief Handles an ignition trigger event based on the crankshaft angle, RPM, and current time.
 120:controller/engine_cycle/ignition.c ****  *
 121:controller/engine_cycle/ignition.c ****  * @param crankshaft_angle The current angle of the crankshaft.
 122:controller/engine_cycle/ignition.c ****  * @param rpm The current revolutions per minute of the engine.
 123:controller/engine_cycle/ignition.c ****  * @param current_time_us The current time in microseconds.
 124:controller/engine_cycle/ignition.c ****  */
 125:controller/engine_cycle/ignition.c **** void ignition_trigger_event_handle(angle_t crankshaft_angle, rpm_t rpm, time_us_t current_time_us)
 126:controller/engine_cycle/ignition.c **** {
 127:controller/engine_cycle/ignition.c ****     /**
 128:controller/engine_cycle/ignition.c ****      * @todo add the necessary checks and bounds
 129:controller/engine_cycle/ignition.c ****      */
 130:controller/engine_cycle/ignition.c ****     if (config.ignition_mode == IM_NO_IGNITION)
 131:controller/engine_cycle/ignition.c ****     {
 132:controller/engine_cycle/ignition.c ****         // obviously, there is no need to do any furthure processing
 133:controller/engine_cycle/ignition.c ****         //ignition_coil_fire_spark()????
 134:controller/engine_cycle/ignition.c ****         return;
 135:controller/engine_cycle/ignition.c ****     }
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 4


 136:controller/engine_cycle/ignition.c ****     if (runtime.firing_interval_deg == 0)
 137:controller/engine_cycle/ignition.c ****     {
 138:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
 139:controller/engine_cycle/ignition.c ****         log_error("ignition not initialized.");
 140:controller/engine_cycle/ignition.c ****         return;
 141:controller/engine_cycle/ignition.c ****     }
 142:controller/engine_cycle/ignition.c **** 
 143:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_TIME_MS)
 144:controller/engine_cycle/ignition.c ****     {
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 146:controller/engine_cycle/ignition.c ****         /**
 147:controller/engine_cycle/ignition.c ****          * @todo throw an error
 148:controller/engine_cycle/ignition.c ****          */
 149:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
 150:controller/engine_cycle/ignition.c ****          log_error("ignition dwell out of bounds.");
 151:controller/engine_cycle/ignition.c **** 
 152:controller/engine_cycle/ignition.c ****         return;
 153:controller/engine_cycle/ignition.c ****     }
 154:controller/engine_cycle/ignition.c ****     /* Wether or not cam phase is known */
 155:controller/engine_cycle/ignition.c ****     bool is_cam_phase_available = false;
 156:controller/engine_cycle/ignition.c **** 
 157:controller/engine_cycle/ignition.c ****     angle_t spark_advance = 0;
 158:controller/engine_cycle/ignition.c **** 
 159:controller/engine_cycle/ignition.c **** #ifdef TEST_MODE
 160:controller/engine_cycle/ignition.c ****     spark_advance = (angle_t)30;
 161:controller/engine_cycle/ignition.c **** #else
 162:controller/engine_cycle/ignition.c ****     spark_advance = ignition_get_advance();
 163:controller/engine_cycle/ignition.c ****     runtime.ignition_advance_deg = spark_advance;
 164:controller/engine_cycle/ignition.c **** #endif
 165:controller/engine_cycle/ignition.c **** 
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 167:controller/engine_cycle/ignition.c ****     runtime.dwell_actual = config.ignition_dwell;
 168:controller/engine_cycle/ignition.c **** 
 169:controller/engine_cycle/ignition.c ****     /* First we have to detect the engine phase */
 170:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / runtime.firing_interval_deg);
 171:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)runtime.firing_interval_deg;
 172:controller/engine_cycle/ignition.c **** 
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 175:controller/engine_cycle/ignition.c **** 
 176:controller/engine_cycle/ignition.c ****     static uint8_t next_firing_cylinders[2] = {0};
 177:controller/engine_cycle/ignition.c **** 
 178:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 179:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 180:controller/engine_cycle/ignition.c **** 
 181:controller/engine_cycle/ignition.c ****     if (!is_cam_phase_available)
 182:controller/engine_cycle/ignition.c ****     {
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 184:controller/engine_cycle/ignition.c ****     }
 185:controller/engine_cycle/ignition.c **** 
 186:controller/engine_cycle/ignition.c ****     bool is_synced = get_bit(runtime.status, STATUS_TRIGGER1_SYNCED);
 187:controller/engine_cycle/ignition.c **** 
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 189:controller/engine_cycle/ignition.c ****     {
 190:controller/engine_cycle/ignition.c ****         /* Now we are close enough to the dwell angle that we can schedule the coil charge start */
 191:controller/engine_cycle/ignition.c **** 
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 5


 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 194:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void *)
 195:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void *)ne
 196:controller/engine_cycle/ignition.c **** 
 197:controller/engine_cycle/ignition.c ****         uint8_t number_of_scheduled_sparks = 1;
 198:controller/engine_cycle/ignition.c ****         if (!config.multi_spark_enabled)
 199:controller/engine_cycle/ignition.c ****         {
 200:controller/engine_cycle/ignition.c ****             runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 201:controller/engine_cycle/ignition.c ****             return;
 202:controller/engine_cycle/ignition.c ****         }
 203:controller/engine_cycle/ignition.c **** 
 204:controller/engine_cycle/ignition.c ****         while (number_of_scheduled_sparks < config.multi_spark_number_of_sparks)
 205:controller/engine_cycle/ignition.c ****         {
 206:controller/engine_cycle/ignition.c ****             if (rpm > config.multi_spark_rpm_threshold)
 207:controller/engine_cycle/ignition.c ****             {
 208:controller/engine_cycle/ignition.c ****                 break;
 209:controller/engine_cycle/ignition.c ****             }
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 212:controller/engine_cycle/ignition.c ****             {
 213:controller/engine_cycle/ignition.c ****                 break;
 214:controller/engine_cycle/ignition.c ****             }
 215:controller/engine_cycle/ignition.c **** 
 216:controller/engine_cycle/ignition.c ****             dwell_start_time_us += duration_of_spark_and_dwell;
 217:controller/engine_cycle/ignition.c ****             spark_start_time_us += duration_of_spark_and_dwell;
 218:controller/engine_cycle/ignition.c **** 
 219:controller/engine_cycle/ignition.c ****             // don't schedule events if there are no empty slots in the scheduler
 220:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (
 221:controller/engine_cycle/ignition.c ****             {
 222:controller/engine_cycle/ignition.c ****                 // fire the spark right away to prevent ign coil damage
 223:controller/engine_cycle/ignition.c ****                 ignition_coil_fire_spark((void *)next_firing_cylinders);
 224:controller/engine_cycle/ignition.c ****                 break;
 225:controller/engine_cycle/ignition.c ****             }
 226:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge,
 227:controller/engine_cycle/ignition.c ****             {
 228:controller/engine_cycle/ignition.c **** 
 229:controller/engine_cycle/ignition.c ****                 break;
 230:controller/engine_cycle/ignition.c ****             }
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 232:controller/engine_cycle/ignition.c ****         }
 233:controller/engine_cycle/ignition.c ****         spark_is_in_progress = true;
 234:controller/engine_cycle/ignition.c ****         runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 235:controller/engine_cycle/ignition.c ****     }
 236:controller/engine_cycle/ignition.c ****     change_bit(&runtime.status, STATUS_IGNITION_ERROR, false);
 237:controller/engine_cycle/ignition.c **** }
 238:controller/engine_cycle/ignition.c **** 
 239:controller/engine_cycle/ignition.c **** /**
 240:controller/engine_cycle/ignition.c ****  * @brief Charges the ignition coil at the specified index.
 241:controller/engine_cycle/ignition.c ****  *
 242:controller/engine_cycle/ignition.c ****  * @param coil_index The index of the coil to be charged.
 243:controller/engine_cycle/ignition.c ****  */
 244:controller/engine_cycle/ignition.c **** void ignition_coil_begin_charge(void *arg)
 245:controller/engine_cycle/ignition.c **** {
  34              		.loc 1 245 1 view -0
  35              		.cfi_startproc
  36              		@ args = 0, pretend = 0, frame = 0
  37              		@ frame_needed = 0, uses_anonymous_args = 0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 6


 246:controller/engine_cycle/ignition.c ****     if (arg == NULL)
  38              		.loc 1 246 5 view .LVU1
  39              		.loc 1 246 8 is_stmt 0 view .LVU2
  40 0000 58B3     		cbz	r0, .L6
 245:controller/engine_cycle/ignition.c ****     if (arg == NULL)
  41              		.loc 1 245 1 view .LVU3
  42 0002 70B5     		push	{r4, r5, r6, lr}
  43              		.cfi_def_cfa_offset 16
  44              		.cfi_offset 4, -16
  45              		.cfi_offset 5, -12
  46              		.cfi_offset 6, -8
  47              		.cfi_offset 14, -4
  48 0004 0446     		mov	r4, r0
 247:controller/engine_cycle/ignition.c ****     {
 248:controller/engine_cycle/ignition.c ****         return;
 249:controller/engine_cycle/ignition.c ****     }
 250:controller/engine_cycle/ignition.c ****     uint8_t *coil_index = (uint8_t *)arg;
  49              		.loc 1 250 5 is_stmt 1 view .LVU4
  50              	.LVL1:
 251:controller/engine_cycle/ignition.c **** 
 252:controller/engine_cycle/ignition.c ****     if (coil_index[1] > FIRMWARE_IGNITION_OUTPUT_COUNT - 1 || coil_index[0] > FIRMWARE_IGNITION_OUT
  51              		.loc 1 252 5 view .LVU5
  52              		.loc 1 252 19 is_stmt 0 view .LVU6
  53 0006 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
  54              		.loc 1 252 8 view .LVU7
  55 0008 032B     		cmp	r3, #3
  56 000a 02D8     		bhi	.L3
  57              		.loc 1 252 73 discriminator 1 view .LVU8
  58 000c 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  59              		.loc 1 252 60 discriminator 1 view .LVU9
  60 000e 032B     		cmp	r3, #3
  61 0010 08D9     		bls	.L4
  62              	.L3:
 253:controller/engine_cycle/ignition.c ****     {
 254:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
  63              		.loc 1 254 9 is_stmt 1 view .LVU10
  64              	.LVL2:
  65              	.LBB34:
  66              	.LBI34:
  67              		.file 2 "controller/utils/utils.h"
   1:controller/utils/utils.h **** /**
   2:controller/utils/utils.h ****  * @file utils.h
   3:controller/utils/utils.h ****  * @brief Header file containing utility functions and definitions for the smart generator controll
   4:controller/utils/utils.h ****  *
   5:controller/utils/utils.h ****  * This file provides declarations for utility functions and macros that are
   6:controller/utils/utils.h ****  * used throughout the firmware to support various functionalities.
   7:controller/utils/utils.h ****  *
   8:controller/utils/utils.h ****  * @note Ensure that this file is included wherever utility functions are required.
   9:controller/utils/utils.h ****  */
  10:controller/utils/utils.h **** #ifndef UTILS_H
  11:controller/utils/utils.h **** #define UTILS_H
  12:controller/utils/utils.h **** 
  13:controller/utils/utils.h **** #include "types.h"
  14:controller/utils/utils.h **** #include "math.h"
  15:controller/utils/utils.h **** #define IS_IN_RANGE(value, min, max) ((value) >= (min) && (value) <= (max))
  16:controller/utils/utils.h **** #define ABS(value) ((value) < 0 ? -(value) : (value))
  17:controller/utils/utils.h **** #define CLAMP(value, min, max) ((value) < (min) ? (min) : ((value) > (max) ? (max) : (value)))
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 7


  18:controller/utils/utils.h **** 
  19:controller/utils/utils.h **** static inline void change_bit(uint32_t *var, uint8_t bit, bool state)
  68              		.loc 2 19 20 view .LVU11
  69              	.LBB35:
  20:controller/utils/utils.h **** {
  21:controller/utils/utils.h ****     if (bit > 31)
  70              		.loc 2 21 5 view .LVU12
  22:controller/utils/utils.h ****     {
  23:controller/utils/utils.h ****         return;
  24:controller/utils/utils.h ****     }
  25:controller/utils/utils.h ****     if (state)
  71              		.loc 2 25 5 view .LVU13
  26:controller/utils/utils.h ****     {
  27:controller/utils/utils.h ****         *var |= (1u << bit);
  72              		.loc 2 27 9 view .LVU14
  73 0012 124A     		ldr	r2, .L9
  74 0014 1368     		ldr	r3, [r2]
  75              		.loc 2 27 14 is_stmt 0 view .LVU15
  76 0016 43F48023 		orr	r3, r3, #262144
  77 001a 1360     		str	r3, [r2]
  78              	.LVL3:
  79              		.loc 2 27 14 view .LVU16
  80              	.LBE35:
  81              	.LBE34:
 255:controller/engine_cycle/ignition.c ****         log_error("Unkown ignition output");
  82              		.loc 1 255 9 is_stmt 1 view .LVU17
  83 001c 1048     		ldr	r0, .L9+4
  84              	.LVL4:
  85              		.loc 1 255 9 is_stmt 0 view .LVU18
  86 001e FFF7FEFF 		bl	log_error
  87              	.LVL5:
 256:controller/engine_cycle/ignition.c ****         return;
  88              		.loc 1 256 9 is_stmt 1 view .LVU19
  89              	.L1:
 257:controller/engine_cycle/ignition.c ****     }
 258:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[0]] = IGNITION_COIL_STATE_CHARGING;
 259:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_CHARGING;
 260:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 261:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 262:controller/engine_cycle/ignition.c **** }
  90              		.loc 1 262 1 is_stmt 0 view .LVU20
  91 0022 70BD     		pop	{r4, r5, r6, pc}
  92              	.LVL6:
  93              	.L4:
 258:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_CHARGING;
  94              		.loc 1 258 5 is_stmt 1 view .LVU21
 258:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_CHARGING;
  95              		.loc 1 258 40 is_stmt 0 view .LVU22
  96 0024 0F4A     		ldr	r2, .L9+8
  97 0026 0125     		movs	r5, #1
  98 0028 D554     		strb	r5, [r2, r3]
 259:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
  99              		.loc 1 259 5 is_stmt 1 view .LVU23
 259:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 100              		.loc 1 259 35 is_stmt 0 view .LVU24
 101 002a 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 259:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 8


 102              		.loc 1 259 40 view .LVU25
 103 002c D554     		strb	r5, [r2, r3]
 260:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 104              		.loc 1 260 5 is_stmt 1 view .LVU26
 260:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 105              		.loc 1 260 50 is_stmt 0 view .LVU27
 106 002e 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 107              	.LVL7:
 260:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 108              		.loc 1 260 39 view .LVU28
 109 0030 0D4E     		ldr	r6, .L9+12
 110 0032 3368     		ldr	r3, [r6]
 111 0034 03EBC001 		add	r1, r3, r0, lsl #3
 260:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 112              		.loc 1 260 5 view .LVU29
 113 0038 2A46     		mov	r2, r5
 114 003a 8988     		ldrh	r1, [r1, #4]
 115 003c 53F83000 		ldr	r0, [r3, r0, lsl #3]
 116 0040 FFF7FEFF 		bl	HAL_GPIO_WritePin
 117              	.LVL8:
 261:controller/engine_cycle/ignition.c **** }
 118              		.loc 1 261 5 is_stmt 1 view .LVU30
 261:controller/engine_cycle/ignition.c **** }
 119              		.loc 1 261 50 is_stmt 0 view .LVU31
 120 0044 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 261:controller/engine_cycle/ignition.c **** }
 121              		.loc 1 261 39 view .LVU32
 122 0046 3368     		ldr	r3, [r6]
 123 0048 03EBC001 		add	r1, r3, r0, lsl #3
 261:controller/engine_cycle/ignition.c **** }
 124              		.loc 1 261 5 view .LVU33
 125 004c 2A46     		mov	r2, r5
 126 004e 8988     		ldrh	r1, [r1, #4]
 127 0050 53F83000 		ldr	r0, [r3, r0, lsl #3]
 128 0054 FFF7FEFF 		bl	HAL_GPIO_WritePin
 129              	.LVL9:
 130 0058 E3E7     		b	.L1
 131              	.LVL10:
 132              	.L6:
 133              		.cfi_def_cfa_offset 0
 134              		.cfi_restore 4
 135              		.cfi_restore 5
 136              		.cfi_restore 6
 137              		.cfi_restore 14
 261:controller/engine_cycle/ignition.c **** }
 138              		.loc 1 261 5 view .LVU34
 139 005a 7047     		bx	lr
 140              	.L10:
 141              		.align	2
 142              	.L9:
 143 005c 00000000 		.word	runtime
 144 0060 00000000 		.word	.LC0
 145 0064 00000000 		.word	ignition_coil_state
 146 0068 00000000 		.word	ignition_outputs
 147              		.cfi_endproc
 148              	.LFE234:
 150              		.section	.text.ignition_coil_fire_spark,"ax",%progbits
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 9


 151              		.align	1
 152              		.global	ignition_coil_fire_spark
 153              		.syntax unified
 154              		.thumb
 155              		.thumb_func
 157              	ignition_coil_fire_spark:
 158              	.LVL11:
 159              	.LFB235:
 263:controller/engine_cycle/ignition.c **** 
 264:controller/engine_cycle/ignition.c **** /**
 265:controller/engine_cycle/ignition.c ****  * @brief Fires a spark from the ignition coil at the specified index.
 266:controller/engine_cycle/ignition.c ****  *
 267:controller/engine_cycle/ignition.c ****  * @param coil_index The index of the coil to fire the spark from.
 268:controller/engine_cycle/ignition.c ****  */
 269:controller/engine_cycle/ignition.c **** void ignition_coil_fire_spark(void *arg)
 270:controller/engine_cycle/ignition.c **** {
 160              		.loc 1 270 1 is_stmt 1 view -0
 161              		.cfi_startproc
 162              		@ args = 0, pretend = 0, frame = 0
 163              		@ frame_needed = 0, uses_anonymous_args = 0
 271:controller/engine_cycle/ignition.c ****     if (arg == NULL)
 164              		.loc 1 271 5 view .LVU36
 165              		.loc 1 271 8 is_stmt 0 view .LVU37
 166 0000 68B3     		cbz	r0, .L16
 270:controller/engine_cycle/ignition.c ****     if (arg == NULL)
 167              		.loc 1 270 1 view .LVU38
 168 0002 70B5     		push	{r4, r5, r6, lr}
 169              		.cfi_def_cfa_offset 16
 170              		.cfi_offset 4, -16
 171              		.cfi_offset 5, -12
 172              		.cfi_offset 6, -8
 173              		.cfi_offset 14, -4
 174 0004 0446     		mov	r4, r0
 272:controller/engine_cycle/ignition.c ****     {
 273:controller/engine_cycle/ignition.c ****         return;
 274:controller/engine_cycle/ignition.c ****     }
 275:controller/engine_cycle/ignition.c **** 
 276:controller/engine_cycle/ignition.c ****     uint8_t *coil_index = (uint8_t *)arg;
 175              		.loc 1 276 5 is_stmt 1 view .LVU39
 176              	.LVL12:
 277:controller/engine_cycle/ignition.c ****     if (coil_index[1] > FIRMWARE_IGNITION_OUTPUT_COUNT - 1 || coil_index[0] > FIRMWARE_IGNITION_OUT
 177              		.loc 1 277 5 view .LVU40
 178              		.loc 1 277 19 is_stmt 0 view .LVU41
 179 0006 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 180              		.loc 1 277 8 view .LVU42
 181 0008 032B     		cmp	r3, #3
 182 000a 02D8     		bhi	.L13
 183              		.loc 1 277 73 discriminator 1 view .LVU43
 184 000c 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 185              		.loc 1 277 60 discriminator 1 view .LVU44
 186 000e 032B     		cmp	r3, #3
 187 0010 08D9     		bls	.L14
 188              	.L13:
 278:controller/engine_cycle/ignition.c ****     {
 279:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
 189              		.loc 1 279 9 is_stmt 1 view .LVU45
 190              	.LVL13:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 10


 191              	.LBB36:
 192              	.LBI36:
  19:controller/utils/utils.h **** {
 193              		.loc 2 19 20 view .LVU46
 194              	.LBB37:
  21:controller/utils/utils.h ****     {
 195              		.loc 2 21 5 view .LVU47
  25:controller/utils/utils.h ****     {
 196              		.loc 2 25 5 view .LVU48
 197              		.loc 2 27 9 view .LVU49
 198 0012 134A     		ldr	r2, .L19
 199 0014 1368     		ldr	r3, [r2]
 200              		.loc 2 27 14 is_stmt 0 view .LVU50
 201 0016 43F48023 		orr	r3, r3, #262144
 202 001a 1360     		str	r3, [r2]
 203              	.LVL14:
 204              		.loc 2 27 14 view .LVU51
 205              	.LBE37:
 206              	.LBE36:
 280:controller/engine_cycle/ignition.c ****         log_error("Unkown ignition output");
 207              		.loc 1 280 9 is_stmt 1 view .LVU52
 208 001c 1148     		ldr	r0, .L19+4
 209              	.LVL15:
 210              		.loc 1 280 9 is_stmt 0 view .LVU53
 211 001e FFF7FEFF 		bl	log_error
 212              	.LVL16:
 281:controller/engine_cycle/ignition.c ****         return;
 213              		.loc 1 281 9 is_stmt 1 view .LVU54
 214              	.L11:
 282:controller/engine_cycle/ignition.c ****     }
 283:controller/engine_cycle/ignition.c **** 
 284:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[0]] = IGNITION_COIL_STATE_NOT_CHARGING;
 285:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_NOT_CHARGING;
 286:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 287:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 288:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 289:controller/engine_cycle/ignition.c **** }
 215              		.loc 1 289 1 is_stmt 0 view .LVU55
 216 0022 70BD     		pop	{r4, r5, r6, pc}
 217              	.LVL17:
 218              	.L14:
 284:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_NOT_CHARGING;
 219              		.loc 1 284 5 is_stmt 1 view .LVU56
 284:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_NOT_CHARGING;
 220              		.loc 1 284 40 is_stmt 0 view .LVU57
 221 0024 104A     		ldr	r2, .L19+8
 222 0026 0025     		movs	r5, #0
 223 0028 D554     		strb	r5, [r2, r3]
 285:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 224              		.loc 1 285 5 is_stmt 1 view .LVU58
 285:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 225              		.loc 1 285 35 is_stmt 0 view .LVU59
 226 002a 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 285:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 227              		.loc 1 285 40 view .LVU60
 228 002c D554     		strb	r5, [r2, r3]
 286:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 11


 229              		.loc 1 286 5 is_stmt 1 view .LVU61
 286:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 230              		.loc 1 286 50 is_stmt 0 view .LVU62
 231 002e 0078     		ldrb	r0, [r0]	@ zero_extendqisi2
 232              	.LVL18:
 286:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 233              		.loc 1 286 39 view .LVU63
 234 0030 0E4E     		ldr	r6, .L19+12
 235 0032 3368     		ldr	r3, [r6]
 236 0034 03EBC001 		add	r1, r3, r0, lsl #3
 286:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 237              		.loc 1 286 5 view .LVU64
 238 0038 2A46     		mov	r2, r5
 239 003a 8988     		ldrh	r1, [r1, #4]
 240 003c 53F83000 		ldr	r0, [r3, r0, lsl #3]
 241 0040 FFF7FEFF 		bl	HAL_GPIO_WritePin
 242              	.LVL19:
 287:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 243              		.loc 1 287 5 is_stmt 1 view .LVU65
 287:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 244              		.loc 1 287 50 is_stmt 0 view .LVU66
 245 0044 6078     		ldrb	r0, [r4, #1]	@ zero_extendqisi2
 287:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 246              		.loc 1 287 39 view .LVU67
 247 0046 3368     		ldr	r3, [r6]
 248 0048 03EBC001 		add	r1, r3, r0, lsl #3
 287:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 249              		.loc 1 287 5 view .LVU68
 250 004c 2A46     		mov	r2, r5
 251 004e 8988     		ldrh	r1, [r1, #4]
 252 0050 53F83000 		ldr	r0, [r3, r0, lsl #3]
 253 0054 FFF7FEFF 		bl	HAL_GPIO_WritePin
 254              	.LVL20:
 288:controller/engine_cycle/ignition.c **** }
 255              		.loc 1 288 5 is_stmt 1 view .LVU69
 288:controller/engine_cycle/ignition.c **** }
 256              		.loc 1 288 26 is_stmt 0 view .LVU70
 257 0058 054B     		ldr	r3, .L19+16
 258 005a 1D70     		strb	r5, [r3]
 259 005c E1E7     		b	.L11
 260              	.LVL21:
 261              	.L16:
 262              		.cfi_def_cfa_offset 0
 263              		.cfi_restore 4
 264              		.cfi_restore 5
 265              		.cfi_restore 6
 266              		.cfi_restore 14
 288:controller/engine_cycle/ignition.c **** }
 267              		.loc 1 288 26 view .LVU71
 268 005e 7047     		bx	lr
 269              	.L20:
 270              		.align	2
 271              	.L19:
 272 0060 00000000 		.word	runtime
 273 0064 00000000 		.word	.LC0
 274 0068 00000000 		.word	ignition_coil_state
 275 006c 00000000 		.word	ignition_outputs
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 12


 276 0070 00000000 		.word	spark_is_in_progress
 277              		.cfi_endproc
 278              	.LFE235:
 280              		.section	.rodata.ignition_init.str1.4,"aMS",%progbits,1
 281              		.align	2
 282              	.LC1:
 283 0000 69676E69 		.ascii	"ignition init failed. No output config\000"
 283      74696F6E 
 283      20696E69 
 283      74206661 
 283      696C6564 
 284 0027 00       		.align	2
 285              	.LC2:
 286 0028 69676E69 		.ascii	"ignition init failed. unkown mode.\000"
 286      74696F6E 
 286      20696E69 
 286      74206661 
 286      696C6564 
 287 004b 00       		.align	2
 288              	.LC3:
 289 004c 436F696C 		.ascii	"Coil on plug igntion not possible with 6 cylinders."
 289      206F6E20 
 289      706C7567 
 289      2069676E 
 289      74696F6E 
 290 007f 20446566 		.ascii	" Defaulted to wasted spark\000"
 290      61756C74 
 290      65642074 
 290      6F207761 
 290      73746564 
 291 009a 0000     		.align	2
 292              	.LC4:
 293 009c 69676E69 		.ascii	"ignition init failed. unkown firing order.\000"
 293      74696F6E 
 293      20696E69 
 293      74206661 
 293      696C6564 
 294 00c7 00       		.align	2
 295              	.LC5:
 296 00c8 4D756C74 		.ascii	"Multi spark is enabled but number of sparks are 0.\000"
 296      69207370 
 296      61726B20 
 296      69732065 
 296      6E61626C 
 297              		.section	.text.ignition_init,"ax",%progbits
 298              		.align	1
 299              		.global	ignition_init
 300              		.syntax unified
 301              		.thumb
 302              		.thumb_func
 304              	ignition_init:
 305              	.LVL22:
 306              	.LFB232:
  14:controller/engine_cycle/ignition.c ****     if (outputs == NULL)
 307              		.loc 1 14 1 is_stmt 1 view -0
 308              		.cfi_startproc
 309              		@ args = 0, pretend = 0, frame = 0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 13


 310              		@ frame_needed = 0, uses_anonymous_args = 0
  14:controller/engine_cycle/ignition.c ****     if (outputs == NULL)
 311              		.loc 1 14 1 is_stmt 0 view .LVU73
 312 0000 10B5     		push	{r4, lr}
 313              		.cfi_def_cfa_offset 8
 314              		.cfi_offset 4, -8
 315              		.cfi_offset 14, -4
  15:controller/engine_cycle/ignition.c ****     {
 316              		.loc 1 15 5 is_stmt 1 view .LVU74
  15:controller/engine_cycle/ignition.c ****     {
 317              		.loc 1 15 8 is_stmt 0 view .LVU75
 318 0002 88B1     		cbz	r0, .L42
  21:controller/engine_cycle/ignition.c **** 
 319              		.loc 1 21 5 is_stmt 1 view .LVU76
  21:controller/engine_cycle/ignition.c **** 
 320              		.loc 1 21 22 is_stmt 0 view .LVU77
 321 0004 614A     		ldr	r2, .L44
 322 0006 1060     		str	r0, [r2]
  23:controller/engine_cycle/ignition.c ****     {
 323              		.loc 1 23 5 is_stmt 1 view .LVU78
  23:controller/engine_cycle/ignition.c ****     {
 324              		.loc 1 23 19 is_stmt 0 view .LVU79
 325 0008 614B     		ldr	r3, .L44+4
 326 000a 93F89832 		ldrb	r3, [r3, #664]	@ zero_extendqisi2
  23:controller/engine_cycle/ignition.c ****     {
 327              		.loc 1 23 5 view .LVU80
 328 000e ABB1     		cbz	r3, .L24
 329 0010 012B     		cmp	r3, #1
 330 0012 50D0     		beq	.L25
  93:controller/engine_cycle/ignition.c ****         log_error("ignition init failed. unkown firing order.");
 331              		.loc 1 93 9 is_stmt 1 view .LVU81
 332              	.LVL23:
 333              	.LBB38:
 334              	.LBI38:
  19:controller/utils/utils.h **** {
 335              		.loc 2 19 20 view .LVU82
 336              	.LBB39:
  21:controller/utils/utils.h ****     {
 337              		.loc 2 21 5 view .LVU83
  25:controller/utils/utils.h ****     {
 338              		.loc 2 25 5 view .LVU84
 339              		.loc 2 27 9 view .LVU85
 340 0014 5F4A     		ldr	r2, .L44+8
 341 0016 1368     		ldr	r3, [r2]
 342              		.loc 2 27 14 is_stmt 0 view .LVU86
 343 0018 43F48023 		orr	r3, r3, #262144
 344 001c 1360     		str	r3, [r2]
 345              	.LVL24:
 346              		.loc 2 27 14 view .LVU87
 347              	.LBE39:
 348              	.LBE38:
  94:controller/engine_cycle/ignition.c ****         return false;
 349              		.loc 1 94 9 is_stmt 1 view .LVU88
 350 001e 5E48     		ldr	r0, .L44+12
 351              	.LVL25:
  94:controller/engine_cycle/ignition.c ****         return false;
 352              		.loc 1 94 9 is_stmt 0 view .LVU89
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 14


 353 0020 FFF7FEFF 		bl	log_error
 354              	.LVL26:
  95:controller/engine_cycle/ignition.c ****     }
 355              		.loc 1 95 9 is_stmt 1 view .LVU90
  95:controller/engine_cycle/ignition.c ****     }
 356              		.loc 1 95 16 is_stmt 0 view .LVU91
 357 0024 0020     		movs	r0, #0
 358              	.L23:
 116:controller/engine_cycle/ignition.c **** 
 359              		.loc 1 116 1 view .LVU92
 360 0026 10BD     		pop	{r4, pc}
 361              	.LVL27:
 362              	.L42:
  17:controller/engine_cycle/ignition.c ****         log_error("ignition init failed. No output config");
 363              		.loc 1 17 9 is_stmt 1 view .LVU93
 364              	.LBB40:
 365              	.LBI40:
  19:controller/utils/utils.h **** {
 366              		.loc 2 19 20 view .LVU94
 367              	.LBB41:
  21:controller/utils/utils.h ****     {
 368              		.loc 2 21 5 view .LVU95
  25:controller/utils/utils.h ****     {
 369              		.loc 2 25 5 view .LVU96
 370              		.loc 2 27 9 view .LVU97
 371 0028 5A4A     		ldr	r2, .L44+8
 372 002a 1368     		ldr	r3, [r2]
 373              		.loc 2 27 14 is_stmt 0 view .LVU98
 374 002c 43F48023 		orr	r3, r3, #262144
 375 0030 1360     		str	r3, [r2]
 376              	.LVL28:
 377              		.loc 2 27 14 view .LVU99
 378              	.LBE41:
 379              	.LBE40:
  18:controller/engine_cycle/ignition.c ****         return false;
 380              		.loc 1 18 9 is_stmt 1 view .LVU100
 381 0032 5A48     		ldr	r0, .L44+16
 382              	.LVL29:
  18:controller/engine_cycle/ignition.c ****         return false;
 383              		.loc 1 18 9 is_stmt 0 view .LVU101
 384 0034 FFF7FEFF 		bl	log_error
 385              	.LVL30:
  19:controller/engine_cycle/ignition.c ****     }
 386              		.loc 1 19 9 is_stmt 1 view .LVU102
  19:controller/engine_cycle/ignition.c ****     }
 387              		.loc 1 19 16 is_stmt 0 view .LVU103
 388 0038 0020     		movs	r0, #0
 389 003a F4E7     		b	.L23
 390              	.LVL31:
 391              	.L24:
  26:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
 392              		.loc 1 26 9 is_stmt 1 view .LVU104
  26:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
 393              		.loc 1 26 29 is_stmt 0 view .LVU105
 394 003c 584B     		ldr	r3, .L44+20
 395 003e 0422     		movs	r2, #4
 396 0040 1A70     		strb	r2, [r3]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 15


  27:controller/engine_cycle/ignition.c ****         {
 397              		.loc 1 27 9 is_stmt 1 view .LVU106
  27:controller/engine_cycle/ignition.c ****         {
 398              		.loc 1 27 23 is_stmt 0 view .LVU107
 399 0042 534B     		ldr	r3, .L44+4
 400 0044 93F8A132 		ldrb	r3, [r3, #673]	@ zero_extendqisi2
  27:controller/engine_cycle/ignition.c ****         {
 401              		.loc 1 27 9 view .LVU108
 402 0048 022B     		cmp	r3, #2
 403 004a 18D0     		beq	.L27
 404 004c 032B     		cmp	r3, #3
 405 004e 1ED0     		beq	.L28
 406 0050 012B     		cmp	r3, #1
 407 0052 26D1     		bne	.L29
  30:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
 408              		.loc 1 30 13 is_stmt 1 view .LVU109
  30:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
 409              		.loc 1 30 31 is_stmt 0 view .LVU110
 410 0054 534B     		ldr	r3, .L44+24
 411 0056 0122     		movs	r2, #1
 412 0058 1A70     		strb	r2, [r3]
  31:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
 413              		.loc 1 31 13 is_stmt 1 view .LVU111
  31:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
 414              		.loc 1 31 31 is_stmt 0 view .LVU112
 415 005a 5A70     		strb	r2, [r3, #1]
  32:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 416              		.loc 1 32 13 is_stmt 1 view .LVU113
  32:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 417              		.loc 1 32 31 is_stmt 0 view .LVU114
 418 005c 9A70     		strb	r2, [r3, #2]
  33:controller/engine_cycle/ignition.c ****             break;
 419              		.loc 1 33 13 is_stmt 1 view .LVU115
  33:controller/engine_cycle/ignition.c ****             break;
 420              		.loc 1 33 31 is_stmt 0 view .LVU116
 421 005e DA70     		strb	r2, [r3, #3]
  34:controller/engine_cycle/ignition.c ****         case IM_WASTED_SPARK:
 422              		.loc 1 34 13 is_stmt 1 view .LVU117
 423              	.LVL32:
 424              	.L30:
  98:controller/engine_cycle/ignition.c **** 
 425              		.loc 1 98 5 view .LVU118
  98:controller/engine_cycle/ignition.c **** 
 426              		.loc 1 98 50 is_stmt 0 view .LVU119
 427 0060 4F4B     		ldr	r3, .L44+20
 428 0062 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 429 0064 07EE903A 		vmov	s15, r3	@ int
 430 0068 F8EE677A 		vcvt.f32.u32	s15, s15
  98:controller/engine_cycle/ignition.c **** 
 431              		.loc 1 98 48 view .LVU120
 432 006c DFED4E6A 		vldr.32	s13, .L44+28
 433 0070 86EEA77A 		vdiv.f32	s14, s13, s15
  98:controller/engine_cycle/ignition.c **** 
 434              		.loc 1 98 33 view .LVU121
 435 0074 474B     		ldr	r3, .L44+8
 436 0076 83ED087A 		vstr.32	s14, [r3, #32]
 101:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 16


 437              		.loc 1 101 5 is_stmt 1 view .LVU122
 438              	.LBB42:
 101:controller/engine_cycle/ignition.c ****     {
 439              		.loc 1 101 10 view .LVU123
 440              	.LVL33:
 101:controller/engine_cycle/ignition.c ****     {
 441              		.loc 1 101 17 is_stmt 0 view .LVU124
 442 007a 0024     		movs	r4, #0
 101:controller/engine_cycle/ignition.c ****     {
 443              		.loc 1 101 5 view .LVU125
 444 007c 62E0     		b	.L34
 445              	.LVL34:
 446              	.L27:
 101:controller/engine_cycle/ignition.c ****     {
 447              		.loc 1 101 5 view .LVU126
 448              	.LBE42:
  36:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 449              		.loc 1 36 13 is_stmt 1 view .LVU127
  36:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 450              		.loc 1 36 31 is_stmt 0 view .LVU128
 451 007e 494B     		ldr	r3, .L44+24
 452 0080 0122     		movs	r2, #1
 453 0082 1A70     		strb	r2, [r3]
  37:controller/engine_cycle/ignition.c ****             ignition_order[2] = 2;
 454              		.loc 1 37 13 is_stmt 1 view .LVU129
  37:controller/engine_cycle/ignition.c ****             ignition_order[2] = 2;
 455              		.loc 1 37 31 is_stmt 0 view .LVU130
 456 0084 0221     		movs	r1, #2
 457 0086 5970     		strb	r1, [r3, #1]
  38:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 458              		.loc 1 38 13 is_stmt 1 view .LVU131
  38:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 459              		.loc 1 38 31 is_stmt 0 view .LVU132
 460 0088 9970     		strb	r1, [r3, #2]
  39:controller/engine_cycle/ignition.c ****             break;
 461              		.loc 1 39 13 is_stmt 1 view .LVU133
  39:controller/engine_cycle/ignition.c ****             break;
 462              		.loc 1 39 31 is_stmt 0 view .LVU134
 463 008a DA70     		strb	r2, [r3, #3]
  40:controller/engine_cycle/ignition.c ****         case IM_INDIVIDUAL_COILS:
 464              		.loc 1 40 13 is_stmt 1 view .LVU135
 465 008c E8E7     		b	.L30
 466              	.L28:
  42:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
 467              		.loc 1 42 13 view .LVU136
  42:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
 468              		.loc 1 42 31 is_stmt 0 view .LVU137
 469 008e 454B     		ldr	r3, .L44+24
 470 0090 0122     		movs	r2, #1
 471 0092 1A70     		strb	r2, [r3]
  43:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
 472              		.loc 1 43 13 is_stmt 1 view .LVU138
  43:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
 473              		.loc 1 43 31 is_stmt 0 view .LVU139
 474 0094 0322     		movs	r2, #3
 475 0096 5A70     		strb	r2, [r3, #1]
  44:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 17


 476              		.loc 1 44 13 is_stmt 1 view .LVU140
  44:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
 477              		.loc 1 44 31 is_stmt 0 view .LVU141
 478 0098 0422     		movs	r2, #4
 479 009a 9A70     		strb	r2, [r3, #2]
  45:controller/engine_cycle/ignition.c ****             break;
 480              		.loc 1 45 13 is_stmt 1 view .LVU142
  45:controller/engine_cycle/ignition.c ****             break;
 481              		.loc 1 45 31 is_stmt 0 view .LVU143
 482 009c 0222     		movs	r2, #2
 483 009e DA70     		strb	r2, [r3, #3]
  46:controller/engine_cycle/ignition.c **** 
 484              		.loc 1 46 13 is_stmt 1 view .LVU144
 485 00a0 DEE7     		b	.L30
 486              	.L29:
  49:controller/engine_cycle/ignition.c ****             log_error("ignition init failed. unkown mode.");
 487              		.loc 1 49 13 view .LVU145
 488              	.LVL35:
 489              	.LBB43:
 490              	.LBI43:
  19:controller/utils/utils.h **** {
 491              		.loc 2 19 20 view .LVU146
 492              	.LBB44:
  21:controller/utils/utils.h ****     {
 493              		.loc 2 21 5 view .LVU147
  25:controller/utils/utils.h ****     {
 494              		.loc 2 25 5 view .LVU148
 495              		.loc 2 27 9 view .LVU149
 496 00a2 3C4A     		ldr	r2, .L44+8
 497 00a4 1368     		ldr	r3, [r2]
 498              		.loc 2 27 14 is_stmt 0 view .LVU150
 499 00a6 43F48023 		orr	r3, r3, #262144
 500 00aa 1360     		str	r3, [r2]
 501              	.LVL36:
 502              		.loc 2 27 14 view .LVU151
 503              	.LBE44:
 504              	.LBE43:
  50:controller/engine_cycle/ignition.c ****             return false;
 505              		.loc 1 50 13 is_stmt 1 view .LVU152
 506 00ac 3F48     		ldr	r0, .L44+32
 507              	.LVL37:
  50:controller/engine_cycle/ignition.c ****             return false;
 508              		.loc 1 50 13 is_stmt 0 view .LVU153
 509 00ae FFF7FEFF 		bl	log_error
 510              	.LVL38:
  51:controller/engine_cycle/ignition.c ****         }
 511              		.loc 1 51 13 is_stmt 1 view .LVU154
  51:controller/engine_cycle/ignition.c ****         }
 512              		.loc 1 51 20 is_stmt 0 view .LVU155
 513 00b2 0020     		movs	r0, #0
 514 00b4 B7E7     		b	.L23
 515              	.LVL39:
 516              	.L25:
  56:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
 517              		.loc 1 56 9 is_stmt 1 view .LVU156
  56:controller/engine_cycle/ignition.c ****         switch (config.ignition_mode)
 518              		.loc 1 56 29 is_stmt 0 view .LVU157
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 18


 519 00b6 3A4B     		ldr	r3, .L44+20
 520 00b8 0622     		movs	r2, #6
 521 00ba 1A70     		strb	r2, [r3]
  57:controller/engine_cycle/ignition.c ****         {
 522              		.loc 1 57 9 is_stmt 1 view .LVU158
  57:controller/engine_cycle/ignition.c ****         {
 523              		.loc 1 57 23 is_stmt 0 view .LVU159
 524 00bc 344B     		ldr	r3, .L44+4
 525 00be 93F8A132 		ldrb	r3, [r3, #673]	@ zero_extendqisi2
  57:controller/engine_cycle/ignition.c ****         {
 526              		.loc 1 57 9 view .LVU160
 527 00c2 022B     		cmp	r3, #2
 528 00c4 0CD0     		beq	.L31
 529 00c6 032B     		cmp	r3, #3
 530 00c8 15D0     		beq	.L32
 531 00ca 012B     		cmp	r3, #1
 532 00cc 24D1     		bne	.L33
  60:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
 533              		.loc 1 60 13 is_stmt 1 view .LVU161
  60:controller/engine_cycle/ignition.c ****             ignition_order[1] = 1;
 534              		.loc 1 60 31 is_stmt 0 view .LVU162
 535 00ce 354B     		ldr	r3, .L44+24
 536 00d0 0122     		movs	r2, #1
 537 00d2 1A70     		strb	r2, [r3]
  61:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
 538              		.loc 1 61 13 is_stmt 1 view .LVU163
  61:controller/engine_cycle/ignition.c ****             ignition_order[2] = 1;
 539              		.loc 1 61 31 is_stmt 0 view .LVU164
 540 00d4 5A70     		strb	r2, [r3, #1]
  62:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 541              		.loc 1 62 13 is_stmt 1 view .LVU165
  62:controller/engine_cycle/ignition.c ****             ignition_order[3] = 1;
 542              		.loc 1 62 31 is_stmt 0 view .LVU166
 543 00d6 9A70     		strb	r2, [r3, #2]
  63:controller/engine_cycle/ignition.c ****             ignition_order[4] = 1;
 544              		.loc 1 63 13 is_stmt 1 view .LVU167
  63:controller/engine_cycle/ignition.c ****             ignition_order[4] = 1;
 545              		.loc 1 63 31 is_stmt 0 view .LVU168
 546 00d8 DA70     		strb	r2, [r3, #3]
  64:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 547              		.loc 1 64 13 is_stmt 1 view .LVU169
  64:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 548              		.loc 1 64 31 is_stmt 0 view .LVU170
 549 00da 1A71     		strb	r2, [r3, #4]
  65:controller/engine_cycle/ignition.c ****             break;
 550              		.loc 1 65 13 is_stmt 1 view .LVU171
  65:controller/engine_cycle/ignition.c ****             break;
 551              		.loc 1 65 31 is_stmt 0 view .LVU172
 552 00dc 5A71     		strb	r2, [r3, #5]
  66:controller/engine_cycle/ignition.c ****         case IM_WASTED_SPARK:
 553              		.loc 1 66 13 is_stmt 1 view .LVU173
 554 00de BFE7     		b	.L30
 555              	.L31:
  68:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 556              		.loc 1 68 13 view .LVU174
  68:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 557              		.loc 1 68 31 is_stmt 0 view .LVU175
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 19


 558 00e0 304B     		ldr	r3, .L44+24
 559 00e2 0122     		movs	r2, #1
 560 00e4 1A70     		strb	r2, [r3]
  69:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
 561              		.loc 1 69 13 is_stmt 1 view .LVU176
  69:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
 562              		.loc 1 69 31 is_stmt 0 view .LVU177
 563 00e6 0221     		movs	r1, #2
 564 00e8 5970     		strb	r1, [r3, #1]
  70:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 565              		.loc 1 70 13 is_stmt 1 view .LVU178
  70:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 566              		.loc 1 70 31 is_stmt 0 view .LVU179
 567 00ea 0320     		movs	r0, #3
 568              	.LVL40:
  70:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 569              		.loc 1 70 31 view .LVU180
 570 00ec 9870     		strb	r0, [r3, #2]
  71:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
 571              		.loc 1 71 13 is_stmt 1 view .LVU181
  71:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
 572              		.loc 1 71 31 is_stmt 0 view .LVU182
 573 00ee D870     		strb	r0, [r3, #3]
  72:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 574              		.loc 1 72 13 is_stmt 1 view .LVU183
  72:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 575              		.loc 1 72 31 is_stmt 0 view .LVU184
 576 00f0 1971     		strb	r1, [r3, #4]
  73:controller/engine_cycle/ignition.c ****             break;
 577              		.loc 1 73 13 is_stmt 1 view .LVU185
  73:controller/engine_cycle/ignition.c ****             break;
 578              		.loc 1 73 31 is_stmt 0 view .LVU186
 579 00f2 5A71     		strb	r2, [r3, #5]
  74:controller/engine_cycle/ignition.c ****         case IM_INDIVIDUAL_COILS:
 580              		.loc 1 74 13 is_stmt 1 view .LVU187
 581 00f4 B4E7     		b	.L30
 582              	.LVL41:
 583              	.L32:
  76:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
 584              		.loc 1 76 13 view .LVU188
  76:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
 585              		.loc 1 76 34 is_stmt 0 view .LVU189
 586 00f6 0222     		movs	r2, #2
 587 00f8 254B     		ldr	r3, .L44+4
 588 00fa 83F8A122 		strb	r2, [r3, #673]
  77:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 589              		.loc 1 77 13 is_stmt 1 view .LVU190
  77:controller/engine_cycle/ignition.c ****             ignition_order[1] = 2;
 590              		.loc 1 77 31 is_stmt 0 view .LVU191
 591 00fe 294B     		ldr	r3, .L44+24
 592 0100 0121     		movs	r1, #1
 593 0102 1970     		strb	r1, [r3]
  78:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
 594              		.loc 1 78 13 is_stmt 1 view .LVU192
  78:controller/engine_cycle/ignition.c ****             ignition_order[2] = 3;
 595              		.loc 1 78 31 is_stmt 0 view .LVU193
 596 0104 5A70     		strb	r2, [r3, #1]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 20


  79:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 597              		.loc 1 79 13 is_stmt 1 view .LVU194
  79:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 598              		.loc 1 79 31 is_stmt 0 view .LVU195
 599 0106 0320     		movs	r0, #3
 600              	.LVL42:
  79:controller/engine_cycle/ignition.c ****             ignition_order[3] = 3;
 601              		.loc 1 79 31 view .LVU196
 602 0108 9870     		strb	r0, [r3, #2]
  80:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
 603              		.loc 1 80 13 is_stmt 1 view .LVU197
  80:controller/engine_cycle/ignition.c ****             ignition_order[4] = 2;
 604              		.loc 1 80 31 is_stmt 0 view .LVU198
 605 010a D870     		strb	r0, [r3, #3]
  81:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 606              		.loc 1 81 13 is_stmt 1 view .LVU199
  81:controller/engine_cycle/ignition.c ****             ignition_order[5] = 1;
 607              		.loc 1 81 31 is_stmt 0 view .LVU200
 608 010c 1A71     		strb	r2, [r3, #4]
  82:controller/engine_cycle/ignition.c ****             log_warning("Coil on plug igntion not possible with 6 cylinders. Defaulted to wasted sp
 609              		.loc 1 82 13 is_stmt 1 view .LVU201
  82:controller/engine_cycle/ignition.c ****             log_warning("Coil on plug igntion not possible with 6 cylinders. Defaulted to wasted sp
 610              		.loc 1 82 31 is_stmt 0 view .LVU202
 611 010e 5971     		strb	r1, [r3, #5]
  83:controller/engine_cycle/ignition.c ****             break;
 612              		.loc 1 83 13 is_stmt 1 view .LVU203
 613 0110 2748     		ldr	r0, .L44+36
 614 0112 FFF7FEFF 		bl	log_warning
 615              	.LVL43:
  84:controller/engine_cycle/ignition.c **** 
 616              		.loc 1 84 13 view .LVU204
 617 0116 A3E7     		b	.L30
 618              	.LVL44:
 619              	.L33:
  87:controller/engine_cycle/ignition.c ****             log_error("ignition init failed. unkown mode.");
 620              		.loc 1 87 9 view .LVU205
 621              	.LBB45:
 622              	.LBI45:
  19:controller/utils/utils.h **** {
 623              		.loc 2 19 20 view .LVU206
 624              	.LBB46:
  21:controller/utils/utils.h ****     {
 625              		.loc 2 21 5 view .LVU207
  25:controller/utils/utils.h ****     {
 626              		.loc 2 25 5 view .LVU208
 627              		.loc 2 27 9 view .LVU209
 628 0118 1E4A     		ldr	r2, .L44+8
 629 011a 1368     		ldr	r3, [r2]
 630              		.loc 2 27 14 is_stmt 0 view .LVU210
 631 011c 43F48023 		orr	r3, r3, #262144
 632 0120 1360     		str	r3, [r2]
 633              	.LVL45:
 634              		.loc 2 27 14 view .LVU211
 635              	.LBE46:
 636              	.LBE45:
  88:controller/engine_cycle/ignition.c ****             return false;
 637              		.loc 1 88 13 is_stmt 1 view .LVU212
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 21


 638 0122 2248     		ldr	r0, .L44+32
 639              	.LVL46:
  88:controller/engine_cycle/ignition.c ****             return false;
 640              		.loc 1 88 13 is_stmt 0 view .LVU213
 641 0124 FFF7FEFF 		bl	log_error
 642              	.LVL47:
  89:controller/engine_cycle/ignition.c ****         }
 643              		.loc 1 89 13 is_stmt 1 view .LVU214
  89:controller/engine_cycle/ignition.c ****         }
 644              		.loc 1 89 20 is_stmt 0 view .LVU215
 645 0128 0020     		movs	r0, #0
 646 012a 7CE7     		b	.L23
 647              	.LVL48:
 648              	.L35:
 649              	.LBB47:
 103:controller/engine_cycle/ignition.c ****     }
 650              		.loc 1 103 9 is_stmt 1 view .LVU216
 103:controller/engine_cycle/ignition.c ****     }
 651              		.loc 1 103 67 is_stmt 0 view .LVU217
 652 012c 174B     		ldr	r3, .L44
 653 012e 1B68     		ldr	r3, [r3]
 654 0130 03EBC402 		add	r2, r3, r4, lsl #3
 103:controller/engine_cycle/ignition.c ****     }
 655              		.loc 1 103 34 view .LVU218
 656 0134 9188     		ldrh	r1, [r2, #4]
 657 0136 53F83400 		ldr	r0, [r3, r4, lsl #3]
 658 013a FFF7FEFF 		bl	HAL_GPIO_ReadPin
 659              	.LVL49:
 103:controller/engine_cycle/ignition.c ****     }
 660              		.loc 1 103 32 discriminator 1 view .LVU219
 661 013e 1D4B     		ldr	r3, .L44+40
 662 0140 1855     		strb	r0, [r3, r4]
 101:controller/engine_cycle/ignition.c ****     {
 663              		.loc 1 101 61 is_stmt 1 discriminator 3 view .LVU220
 664 0142 0134     		adds	r4, r4, #1
 665              	.LVL50:
 666              	.L34:
 101:controller/engine_cycle/ignition.c ****     {
 667              		.loc 1 101 26 discriminator 1 view .LVU221
 668 0144 032C     		cmp	r4, #3
 669 0146 F1D9     		bls	.L35
 670              	.LBE47:
 671              	.LBB48:
 106:controller/engine_cycle/ignition.c ****     {
 672              		.loc 1 106 17 is_stmt 0 view .LVU222
 673 0148 0024     		movs	r4, #0
 674              	.LVL51:
 106:controller/engine_cycle/ignition.c ****     {
 675              		.loc 1 106 17 view .LVU223
 676 014a 0AE0     		b	.L36
 677              	.LVL52:
 678              	.L37:
 108:controller/engine_cycle/ignition.c ****     }
 679              		.loc 1 108 9 is_stmt 1 view .LVU224
 108:controller/engine_cycle/ignition.c ****     }
 680              		.loc 1 108 43 is_stmt 0 view .LVU225
 681 014c 0F4B     		ldr	r3, .L44
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 22


 682 014e 1B68     		ldr	r3, [r3]
 683 0150 03EBC401 		add	r1, r3, r4, lsl #3
 108:controller/engine_cycle/ignition.c ****     }
 684              		.loc 1 108 9 view .LVU226
 685 0154 0022     		movs	r2, #0
 686 0156 8988     		ldrh	r1, [r1, #4]
 687 0158 53F83400 		ldr	r0, [r3, r4, lsl #3]
 688 015c FFF7FEFF 		bl	HAL_GPIO_WritePin
 689              	.LVL53:
 106:controller/engine_cycle/ignition.c ****     {
 690              		.loc 1 106 61 is_stmt 1 discriminator 3 view .LVU227
 691 0160 0134     		adds	r4, r4, #1
 692              	.LVL54:
 693              	.L36:
 106:controller/engine_cycle/ignition.c ****     {
 694              		.loc 1 106 26 discriminator 1 view .LVU228
 695 0162 032C     		cmp	r4, #3
 696 0164 F2D9     		bls	.L37
 697              	.LBE48:
 111:controller/engine_cycle/ignition.c ****     {
 698              		.loc 1 111 5 view .LVU229
 111:controller/engine_cycle/ignition.c ****     {
 699              		.loc 1 111 15 is_stmt 0 view .LVU230
 700 0166 0A4B     		ldr	r3, .L44+4
 701 0168 93F8A232 		ldrb	r3, [r3, #674]	@ zero_extendqisi2
 111:controller/engine_cycle/ignition.c ****     {
 702              		.loc 1 111 8 view .LVU231
 703 016c 5BB1     		cbz	r3, .L38
 111:controller/engine_cycle/ignition.c ****     {
 704              		.loc 1 111 40 discriminator 1 view .LVU232
 705 016e 084B     		ldr	r3, .L44+4
 706 0170 93F8A332 		ldrb	r3, [r3, #675]	@ zero_extendqisi2
 111:controller/engine_cycle/ignition.c ****     {
 707              		.loc 1 111 36 discriminator 1 view .LVU233
 708 0174 082B     		cmp	r3, #8
 709 0176 01D8     		bhi	.L43
 115:controller/engine_cycle/ignition.c **** }
 710              		.loc 1 115 12 view .LVU234
 711 0178 0120     		movs	r0, #1
 712 017a 54E7     		b	.L23
 713              	.L43:
 113:controller/engine_cycle/ignition.c ****     }
 714              		.loc 1 113 9 is_stmt 1 view .LVU235
 715 017c 0E48     		ldr	r0, .L44+44
 716 017e FFF7FEFF 		bl	log_warning
 717              	.LVL55:
 115:controller/engine_cycle/ignition.c **** }
 718              		.loc 1 115 12 is_stmt 0 view .LVU236
 719 0182 0120     		movs	r0, #1
 720 0184 4FE7     		b	.L23
 721              	.L38:
 722 0186 0120     		movs	r0, #1
 723 0188 4DE7     		b	.L23
 724              	.L45:
 725 018a 00BF     		.align	2
 726              	.L44:
 727 018c 00000000 		.word	ignition_outputs
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 23


 728 0190 00100000 		.word	config+4096
 729 0194 00000000 		.word	runtime
 730 0198 9C000000 		.word	.LC4
 731 019c 00000000 		.word	.LC1
 732 01a0 00000000 		.word	number_of_cylinders
 733 01a4 00000000 		.word	ignition_order
 734 01a8 00003444 		.word	1144258560
 735 01ac 28000000 		.word	.LC2
 736 01b0 4C000000 		.word	.LC3
 737 01b4 00000000 		.word	ignition_coil_state
 738 01b8 C8000000 		.word	.LC5
 739              		.cfi_endproc
 740              	.LFE232:
 742              		.section	.text.ignition_get_coil_duty_cycle,"ax",%progbits
 743              		.align	1
 744              		.global	ignition_get_coil_duty_cycle
 745              		.syntax unified
 746              		.thumb
 747              		.thumb_func
 749              	ignition_get_coil_duty_cycle:
 750              	.LFB236:
 290:controller/engine_cycle/ignition.c **** 
 291:controller/engine_cycle/ignition.c **** /**
 292:controller/engine_cycle/ignition.c ****  * @brief Gets the duty cycle of the ignition coil as a percentage.
 293:controller/engine_cycle/ignition.c ****  *
 294:controller/engine_cycle/ignition.c ****  * @return The duty cycle of the ignition coil.
 295:controller/engine_cycle/ignition.c ****  */
 296:controller/engine_cycle/ignition.c **** percent_t ignition_get_coil_duty_cycle()
 297:controller/engine_cycle/ignition.c **** {
 751              		.loc 1 297 1 is_stmt 1 view -0
 752              		.cfi_startproc
 753              		@ args = 0, pretend = 0, frame = 0
 754              		@ frame_needed = 0, uses_anonymous_args = 0
 755              		@ link register save eliminated.
 298:controller/engine_cycle/ignition.c **** }
 756              		.loc 1 298 1 view .LVU238
 757 0000 7047     		bx	lr
 758              		.cfi_endproc
 759              	.LFE236:
 761              		.section	.text.ignition_get_advance,"ax",%progbits
 762              		.align	1
 763              		.global	ignition_get_advance
 764              		.syntax unified
 765              		.thumb
 766              		.thumb_func
 768              	ignition_get_advance:
 769              	.LFB237:
 299:controller/engine_cycle/ignition.c **** 
 300:controller/engine_cycle/ignition.c **** angle_t ignition_get_advance()
 301:controller/engine_cycle/ignition.c **** {
 770              		.loc 1 301 1 view -0
 771              		.cfi_startproc
 772              		@ args = 0, pretend = 0, frame = 0
 773              		@ frame_needed = 0, uses_anonymous_args = 0
 774 0000 08B5     		push	{r3, lr}
 775              		.cfi_def_cfa_offset 8
 776              		.cfi_offset 3, -8
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 24


 777              		.cfi_offset 14, -4
 778 0002 2DED028B 		vpush.64	{d8}
 779              		.cfi_def_cfa_offset 16
 780              		.cfi_offset 80, -16
 781              		.cfi_offset 81, -12
 302:controller/engine_cycle/ignition.c ****     angle_t final_advance = IGNITION_ADVANCE_FAIL_SAFE;
 782              		.loc 1 302 5 view .LVU240
 783              	.LVL56:
 303:controller/engine_cycle/ignition.c ****     if (runtime.spinning_state != SS_RUNNING)
 784              		.loc 1 303 5 view .LVU241
 785              		.loc 1 303 16 is_stmt 0 view .LVU242
 786 0006 0C4B     		ldr	r3, .L51
 787 0008 93F85030 		ldrb	r3, [r3, #80]	@ zero_extendqisi2
 788              		.loc 1 303 8 view .LVU243
 789 000c 032B     		cmp	r3, #3
 790 000e 05D0     		beq	.L48
 304:controller/engine_cycle/ignition.c ****     {
 305:controller/engine_cycle/ignition.c ****         return config.cranking_advance;
 791              		.loc 1 305 9 is_stmt 1 view .LVU244
 792              		.loc 1 305 22 is_stmt 0 view .LVU245
 793 0010 0A4B     		ldr	r3, .L51+4
 794 0012 93ED810A 		vldr.32	s0, [r3, #516]
 795              	.LVL57:
 796              	.L47:
 306:controller/engine_cycle/ignition.c ****     }
 307:controller/engine_cycle/ignition.c **** 
 308:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
 309:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 310:controller/engine_cycle/ignition.c **** 
 311:controller/engine_cycle/ignition.c ****     final_advance = table_2d_get_value(&config.ign_table_1, rpm, map); // expand and allow the use 
 312:controller/engine_cycle/ignition.c **** 
 313:controller/engine_cycle/ignition.c ****     /* Here we can apply all kinds of correction to the table */
 314:controller/engine_cycle/ignition.c **** 
 315:controller/engine_cycle/ignition.c ****     return final_advance;
 316:controller/engine_cycle/ignition.c **** }...
 797              		.loc 1 316 1 view .LVU246
 798 0016 BDEC028B 		vldm	sp!, {d8}
 799              		.cfi_remember_state
 800              		.cfi_restore 80
 801              		.cfi_restore 81
 802              		.cfi_def_cfa_offset 8
 803 001a 08BD     		pop	{r3, pc}
 804              	.LVL58:
 805              	.L48:
 806              		.cfi_restore_state
 308:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
 807              		.loc 1 308 5 is_stmt 1 view .LVU247
 308:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
 808              		.loc 1 308 17 is_stmt 0 view .LVU248
 809 001c FFF7FEFF 		bl	crankshaft_get_rpm
 810              	.LVL59:
 811 0020 B0EE408A 		vmov.f32	s16, s0
 812              	.LVL60:
 309:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 813              		.loc 1 309 5 is_stmt 1 view .LVU249
 309:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 814              		.loc 1 309 22 is_stmt 0 view .LVU250
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 25


 815 0024 FFF7FEFF 		bl	sensor_map_get
 816              	.LVL61:
 309:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 817              		.loc 1 309 22 view .LVU251
 818 0028 F0EE400A 		vmov.f32	s1, s0
 819              	.LVL62:
 311:controller/engine_cycle/ignition.c ****     final_advance = table_2d_get_value(&config.ign_table_1, rpm, map); // expand and allow the use 
 820              		.loc 1 311 5 is_stmt 1 view .LVU252
 311:controller/engine_cycle/ignition.c ****     final_advance = table_2d_get_value(&config.ign_table_1, rpm, map); // expand and allow the use 
 821              		.loc 1 311 21 is_stmt 0 view .LVU253
 822 002c B0EE480A 		vmov.f32	s0, s16
 823              	.LVL63:
 311:controller/engine_cycle/ignition.c ****     final_advance = table_2d_get_value(&config.ign_table_1, rpm, map); // expand and allow the use 
 824              		.loc 1 311 21 view .LVU254
 825 0030 0348     		ldr	r0, .L51+8
 826 0032 FFF7FEFF 		bl	table_2d_get_value
 827              	.LVL64:
 315:controller/engine_cycle/ignition.c ****     return final_advance;
 828              		.loc 1 315 5 is_stmt 1 view .LVU255
 315:controller/engine_cycle/ignition.c ****     return final_advance;
 829              		.loc 1 315 12 is_stmt 0 view .LVU256
 830 0036 EEE7     		b	.L47
 831              	.L52:
 832              		.align	2
 833              	.L51:
 834 0038 00000000 		.word	runtime
 835 003c 00100000 		.word	config+4096
 836 0040 00090000 		.word	config+2304
 837              		.cfi_endproc
 838              	.LFE237:
 840              		.section	.rodata.ignition_trigger_event_handle.str1.4,"aMS",%progbits,1
 841              		.align	2
 842              	.LC6:
 843 0000 69676E69 		.ascii	"ignition not initialized.\000"
 843      74696F6E 
 843      206E6F74 
 843      20696E69 
 843      7469616C 
 844 001a 0000     		.align	2
 845              	.LC7:
 846 001c 69676E69 		.ascii	"ignition dwell out of bounds.\000"
 846      74696F6E 
 846      20647765 
 846      6C6C206F 
 846      7574206F 
 847              		.section	.text.ignition_trigger_event_handle,"ax",%progbits
 848              		.align	1
 849              		.global	ignition_trigger_event_handle
 850              		.syntax unified
 851              		.thumb
 852              		.thumb_func
 854              	ignition_trigger_event_handle:
 855              	.LVL65:
 856              	.LFB233:
 126:controller/engine_cycle/ignition.c **** {
 857              		.loc 1 126 1 is_stmt 1 view -0
 858              		.cfi_startproc
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 26


 859              		@ args = 0, pretend = 0, frame = 16
 860              		@ frame_needed = 0, uses_anonymous_args = 0
 130:controller/engine_cycle/ignition.c ****     if (config.ignition_mode == IM_NO_IGNITION)
 861              		.loc 1 130 5 view .LVU258
 130:controller/engine_cycle/ignition.c ****     if (config.ignition_mode == IM_NO_IGNITION)
 862              		.loc 1 130 15 is_stmt 0 view .LVU259
 863 0000 AD4B     		ldr	r3, .L89
 864 0002 93F8A132 		ldrb	r3, [r3, #673]	@ zero_extendqisi2
 130:controller/engine_cycle/ignition.c ****     if (config.ignition_mode == IM_NO_IGNITION)
 865              		.loc 1 130 8 view .LVU260
 866 0006 002B     		cmp	r3, #0
 867 0008 00F05481 		beq	.L83
 126:controller/engine_cycle/ignition.c **** {
 868              		.loc 1 126 1 view .LVU261
 869 000c 70B5     		push	{r4, r5, r6, lr}
 870              		.cfi_def_cfa_offset 16
 871              		.cfi_offset 4, -16
 872              		.cfi_offset 5, -12
 873              		.cfi_offset 6, -8
 874              		.cfi_offset 14, -4
 875 000e 2DED048B 		vpush.64	{d8, d9}
 876              		.cfi_def_cfa_offset 32
 877              		.cfi_offset 80, -32
 878              		.cfi_offset 81, -28
 879              		.cfi_offset 82, -24
 880              		.cfi_offset 83, -20
 881 0012 84B0     		sub	sp, sp, #16
 882              		.cfi_def_cfa_offset 48
 883 0014 F0EE408A 		vmov.f32	s17, s0
 884 0018 B0EE608A 		vmov.f32	s16, s1
 885 001c 0446     		mov	r4, r0
 136:controller/engine_cycle/ignition.c ****     if (runtime.firing_interval_deg == 0)
 886              		.loc 1 136 5 is_stmt 1 view .LVU262
 136:controller/engine_cycle/ignition.c ****     if (runtime.firing_interval_deg == 0)
 887              		.loc 1 136 16 is_stmt 0 view .LVU263
 888 001e A74B     		ldr	r3, .L89+4
 889 0020 D3ED087A 		vldr.32	s15, [r3, #32]
 136:controller/engine_cycle/ignition.c ****     if (runtime.firing_interval_deg == 0)
 890              		.loc 1 136 8 view .LVU264
 891 0024 F5EE407A 		vcmp.f32	s15, #0
 892 0028 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 893 002c 21D0     		beq	.L86
 143:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_TIME_MS)
 894              		.loc 1 143 5 is_stmt 1 view .LVU265
 143:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_TIME_MS)
 895              		.loc 1 143 10 is_stmt 0 view .LVU266
 896 002e A24B     		ldr	r3, .L89
 897 0030 D3ED837A 		vldr.32	s15, [r3, #524]
 143:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_TIME_MS)
 898              		.loc 1 143 8 view .LVU267
 899 0034 B6EE007A 		vmov.f32	s14, #5.0e-1
 900 0038 F4EEC77A 		vcmpe.f32	s15, s14
 901 003c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 902 0040 06DB     		blt	.L56
 143:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_TIME_MS)
 903              		.loc 1 143 9 discriminator 1 view .LVU268
 904 0042 B1EE007A 		vmov.f32	s14, #4.0e+0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 27


 905 0046 F4EEC77A 		vcmpe.f32	s15, s14
 906 004a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 907 004e 2AD9     		bls	.L58
 908              	.L56:
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 909              		.loc 1 145 9 is_stmt 1 view .LVU269
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 910              		.loc 1 145 33 is_stmt 0 view .LVU270
 911 0050 B6EE007A 		vmov.f32	s14, #5.0e-1
 912 0054 F4EEC77A 		vcmpe.f32	s15, s14
 913 0058 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 914 005c 12D4     		bmi	.L72
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 915              		.loc 1 145 33 discriminator 2 view .LVU271
 916 005e B1EE007A 		vmov.f32	s14, #4.0e+0
 917 0062 F4EEC77A 		vcmpe.f32	s15, s14
 918 0066 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 919 006a 0DDD     		ble	.L59
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 920              		.loc 1 145 33 discriminator 4 view .LVU272
 921 006c F0EE477A 		vmov.f32	s15, s14
 922 0070 0AE0     		b	.L59
 923              	.L86:
 138:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
 924              		.loc 1 138 9 is_stmt 1 view .LVU273
 925              	.LVL66:
 926              	.LBB49:
 927              	.LBI49:
  19:controller/utils/utils.h **** {
 928              		.loc 2 19 20 view .LVU274
 929              	.LBB50:
  21:controller/utils/utils.h ****     {
 930              		.loc 2 21 5 view .LVU275
  25:controller/utils/utils.h ****     {
 931              		.loc 2 25 5 view .LVU276
 932              		.loc 2 27 9 view .LVU277
 933 0072 1A46     		mov	r2, r3
 934 0074 1B68     		ldr	r3, [r3]
 935              		.loc 2 27 14 is_stmt 0 view .LVU278
 936 0076 43F48023 		orr	r3, r3, #262144
 937 007a 1360     		str	r3, [r2]
 938              	.LVL67:
 939              		.loc 2 27 14 view .LVU279
 940              	.LBE50:
 941              	.LBE49:
 139:controller/engine_cycle/ignition.c ****         log_error("ignition not initialized.");
 942              		.loc 1 139 9 is_stmt 1 view .LVU280
 943 007c 9048     		ldr	r0, .L89+8
 944              	.LVL68:
 139:controller/engine_cycle/ignition.c ****         log_error("ignition not initialized.");
 945              		.loc 1 139 9 is_stmt 0 view .LVU281
 946 007e FFF7FEFF 		bl	log_error
 947              	.LVL69:
 140:controller/engine_cycle/ignition.c ****         return;
 948              		.loc 1 140 9 is_stmt 1 view .LVU282
 949 0082 0CE0     		b	.L53
 950              	.LVL70:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 28


 951              	.L72:
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 952              		.loc 1 145 33 is_stmt 0 discriminator 1 view .LVU283
 953 0084 F6EE007A 		vmov.f32	s15, #5.0e-1
 954              	.L59:
 145:controller/engine_cycle/ignition.c ****         config.ignition_dwell = CLAMP(config.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_M
 955              		.loc 1 145 31 discriminator 8 view .LVU284
 956 0088 8B4B     		ldr	r3, .L89
 957 008a C3ED837A 		vstr.32	s15, [r3, #524]
 149:controller/engine_cycle/ignition.c ****         change_bit(&runtime.status, STATUS_IGNITION_ERROR, true);
 958              		.loc 1 149 9 is_stmt 1 view .LVU285
 959              	.LVL71:
 960              	.LBB51:
 961              	.LBI51:
  19:controller/utils/utils.h **** {
 962              		.loc 2 19 20 view .LVU286
 963              	.LBB52:
  21:controller/utils/utils.h ****     {
 964              		.loc 2 21 5 view .LVU287
  25:controller/utils/utils.h ****     {
 965              		.loc 2 25 5 view .LVU288
 966              		.loc 2 27 9 view .LVU289
 967 008e 8B4A     		ldr	r2, .L89+4
 968 0090 1368     		ldr	r3, [r2]
 969              		.loc 2 27 14 is_stmt 0 view .LVU290
 970 0092 43F48023 		orr	r3, r3, #262144
 971 0096 1360     		str	r3, [r2]
 972              	.LVL72:
 973              		.loc 2 27 14 view .LVU291
 974              	.LBE52:
 975              	.LBE51:
 150:controller/engine_cycle/ignition.c ****          log_error("ignition dwell out of bounds.");
 976              		.loc 1 150 10 is_stmt 1 view .LVU292
 977 0098 8A48     		ldr	r0, .L89+12
 978              	.LVL73:
 150:controller/engine_cycle/ignition.c ****          log_error("ignition dwell out of bounds.");
 979              		.loc 1 150 10 is_stmt 0 view .LVU293
 980 009a FFF7FEFF 		bl	log_error
 981              	.LVL74:
 152:controller/engine_cycle/ignition.c ****         return;
 982              		.loc 1 152 9 is_stmt 1 view .LVU294
 983              	.L53:
 237:controller/engine_cycle/ignition.c **** }
 984              		.loc 1 237 1 is_stmt 0 view .LVU295
 985 009e 04B0     		add	sp, sp, #16
 986              		.cfi_remember_state
 987              		.cfi_def_cfa_offset 32
 988              		@ sp needed
 989 00a0 BDEC048B 		vldm	sp!, {d8-d9}
 990              		.cfi_restore 82
 991              		.cfi_restore 83
 992              		.cfi_restore 80
 993              		.cfi_restore 81
 994              		.cfi_def_cfa_offset 16
 995              	.LVL75:
 237:controller/engine_cycle/ignition.c **** }
 996              		.loc 1 237 1 view .LVU296
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 29


 997 00a4 70BD     		pop	{r4, r5, r6, pc}
 998              	.LVL76:
 999              	.L58:
 1000              		.cfi_restore_state
 155:controller/engine_cycle/ignition.c ****     bool is_cam_phase_available = false;
 1001              		.loc 1 155 5 is_stmt 1 view .LVU297
 157:controller/engine_cycle/ignition.c ****     angle_t spark_advance = 0;
 1002              		.loc 1 157 5 view .LVU298
 162:controller/engine_cycle/ignition.c ****     spark_advance = ignition_get_advance();
 1003              		.loc 1 162 5 view .LVU299
 162:controller/engine_cycle/ignition.c ****     spark_advance = ignition_get_advance();
 1004              		.loc 1 162 21 is_stmt 0 view .LVU300
 1005 00a6 FFF7FEFF 		bl	ignition_get_advance
 1006              	.LVL77:
 163:controller/engine_cycle/ignition.c ****     runtime.ignition_advance_deg = spark_advance;
 1007              		.loc 1 163 5 is_stmt 1 view .LVU301
 163:controller/engine_cycle/ignition.c ****     runtime.ignition_advance_deg = spark_advance;
 1008              		.loc 1 163 34 is_stmt 0 view .LVU302
 1009 00aa 844B     		ldr	r3, .L89+4
 1010 00ac 83ED090A 		vstr.32	s0, [r3, #36]
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1011              		.loc 1 166 5 is_stmt 1 view .LVU303
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1012              		.loc 1 166 21 is_stmt 0 view .LVU304
 1013 00b0 B5EEC00A 		vcmpe.f32	s0, #0
 1014 00b4 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1015 00b8 09D4     		bmi	.L73
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1016              		.loc 1 166 21 discriminator 2 view .LVU305
 1017 00ba DFED837A 		vldr.32	s15, .L89+16
 1018 00be B4EEE70A 		vcmpe.f32	s0, s15
 1019 00c2 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1020 00c6 04DD     		ble	.L61
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1021              		.loc 1 166 21 discriminator 4 view .LVU306
 1022 00c8 B0EE670A 		vmov.f32	s0, s15
 1023              	.LVL78:
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1024              		.loc 1 166 21 discriminator 4 view .LVU307
 1025 00cc 01E0     		b	.L61
 1026              	.LVL79:
 1027              	.L73:
 166:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 1028              		.loc 1 166 21 discriminator 1 view .LVU308
 1029 00ce 9FED7F0A 		vldr.32	s0, .L89+20
 1030              	.LVL80:
 1031              	.L61:
 167:controller/engine_cycle/ignition.c ****     runtime.dwell_actual = config.ignition_dwell;
 1032              		.loc 1 167 5 is_stmt 1 view .LVU309
 167:controller/engine_cycle/ignition.c ****     runtime.dwell_actual = config.ignition_dwell;
 1033              		.loc 1 167 34 is_stmt 0 view .LVU310
 1034 00d2 794B     		ldr	r3, .L89
 1035 00d4 D3ED837A 		vldr.32	s15, [r3, #524]
 167:controller/engine_cycle/ignition.c ****     runtime.dwell_actual = config.ignition_dwell;
 1036              		.loc 1 167 26 view .LVU311
 1037 00d8 784B     		ldr	r3, .L89+4
 1038 00da C3ED137A 		vstr.32	s15, [r3, #76]
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 30


 170:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / runtime.firing_interval_deg);
 1039              		.loc 1 170 5 is_stmt 1 view .LVU312
 170:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / runtime.firing_interval_deg);
 1040              		.loc 1 170 57 is_stmt 0 view .LVU313
 1041 00de 93ED087A 		vldr.32	s14, [r3, #32]
 170:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / runtime.firing_interval_deg);
 1042              		.loc 1 170 48 view .LVU314
 1043 00e2 C8EE876A 		vdiv.f32	s13, s17, s14
 170:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / runtime.firing_interval_deg);
 1044              		.loc 1 170 13 view .LVU315
 1045 00e6 FCEEE66A 		vcvt.u32.f32	s13, s13
 1046 00ea CDED016A 		vstr.32	s13, [sp, #4]	@ int
 1047 00ee 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
 1048              	.LVL81:
 171:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)runtime.firing_interval_deg;
 1049              		.loc 1 171 5 is_stmt 1 view .LVU316
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 1050              		.loc 1 173 5 view .LVU317
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 1051              		.loc 1 173 47 is_stmt 0 view .LVU318
 1052 00f2 06EE903A 		vmov	s13, r3	@ int
 1053 00f6 F8EEE66A 		vcvt.f32.s32	s13, s13
 1054 00fa 66EE876A 		vmul.f32	s13, s13, s14
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 1055              		.loc 1 173 77 view .LVU319
 1056 00fe 76EEC06A 		vsub.f32	s13, s13, s0
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 1057              		.loc 1 173 93 view .LVU320
 1058 0102 37EE267A 		vadd.f32	s14, s14, s13
 1059              	.LVL82:
 173:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * runtime.firing_interval_deg - spark_advance + runti
 1060              		.loc 1 173 22 view .LVU321
 1061 0106 8DED037A 		vstr.32	s14, [sp, #12]
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1062              		.loc 1 174 5 is_stmt 1 view .LVU322
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1063              		.loc 1 174 58 is_stmt 0 view .LVU323
 1064 010a 9DED037A 		vldr.32	s14, [sp, #12]
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1065              		.loc 1 174 89 view .LVU324
 1066 010e DFED706A 		vldr.32	s13, .L89+24
 1067 0112 67EEA67A 		vmul.f32	s15, s15, s13
 1068              	.LVL83:
 1069              	.LBB53:
 1070              	.LBI53:
  28:controller/utils/utils.h ****     }
  29:controller/utils/utils.h ****     else
  30:controller/utils/utils.h ****     {
  31:controller/utils/utils.h ****         *var &= ~(1u << bit);
  32:controller/utils/utils.h ****     }
  33:controller/utils/utils.h **** }
  34:controller/utils/utils.h **** 
  35:controller/utils/utils.h **** static inline bool get_bit(uint32_t flags, uint8_t bit)
  36:controller/utils/utils.h **** {
  37:controller/utils/utils.h ****     if (bit < 32)
  38:controller/utils/utils.h ****     {
  39:controller/utils/utils.h ****         return (flags >> bit) & 1u;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 31


  40:controller/utils/utils.h ****     }
  41:controller/utils/utils.h ****     return false;
  42:controller/utils/utils.h **** }
  43:controller/utils/utils.h **** 
  44:controller/utils/utils.h **** /**
  45:controller/utils/utils.h ****  * @brief Maps a value from one range to another.
  46:controller/utils/utils.h ****  *
  47:controller/utils/utils.h ****  * @param x The value to map.
  48:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  49:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  50:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  51:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  52:controller/utils/utils.h ****  * @return The mapped value in the output range.
  53:controller/utils/utils.h ****  */
  54:controller/utils/utils.h **** #define MAP(x, in_min, in_max, out_min, out_max) \
  55:controller/utils/utils.h ****     (((x) - (in_min)) * ((out_max) - (out_min)) / ((in_max) - (in_min)) + (out_min))
  56:controller/utils/utils.h **** 
  57:controller/utils/utils.h **** /**
  58:controller/utils/utils.h ****  * @brief Maps a uint16_t value from one range to another.
  59:controller/utils/utils.h ****  *
  60:controller/utils/utils.h ****  * @param x The value to map.
  61:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  62:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  63:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  64:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  65:controller/utils/utils.h ****  * @return The mapped value in the output range.
  66:controller/utils/utils.h ****  */
  67:controller/utils/utils.h **** static inline uint16_t map_uint16(uint16_t x, uint16_t in_min, uint16_t in_max, uint16_t out_min, u
  68:controller/utils/utils.h **** {
  69:controller/utils/utils.h ****     if (in_max == in_min)
  70:controller/utils/utils.h ****     {
  71:controller/utils/utils.h ****         return 0; // Avoid division by zero
  72:controller/utils/utils.h ****     }
  73:controller/utils/utils.h ****     return (uint16_t)((x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min);
  74:controller/utils/utils.h **** }
  75:controller/utils/utils.h **** 
  76:controller/utils/utils.h **** static inline float mapf(float x, float in_min, float in_max, float out_min, float out_max)
  77:controller/utils/utils.h **** {
  78:controller/utils/utils.h ****     if (in_max == in_min)
  79:controller/utils/utils.h ****     {
  80:controller/utils/utils.h ****         return 0.0f; // Avoid division by zero
  81:controller/utils/utils.h ****     }
  82:controller/utils/utils.h ****     return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
  83:controller/utils/utils.h **** }
  84:controller/utils/utils.h **** 
  85:controller/utils/utils.h **** // http://en.wikipedia.org/wiki/Endianness
  86:controller/utils/utils.h **** inline uint16_t swap_endian_uint16(uint16_t x)
  87:controller/utils/utils.h **** {
  88:controller/utils/utils.h ****     return ((x << 8) | (x >> 8));
  89:controller/utils/utils.h **** }
  90:controller/utils/utils.h **** inline uint32_t swap_endian_uint32(uint32_t x)
  91:controller/utils/utils.h **** {
  92:controller/utils/utils.h ****     return (((x >> 24) & 0x000000ff) | ((x << 8) & 0x00ff0000) |
  93:controller/utils/utils.h ****             ((x >> 8) & 0x0000ff00) | ((x << 24) & 0xff000000));
  94:controller/utils/utils.h **** }
  95:controller/utils/utils.h **** 
  96:controller/utils/utils.h **** void swap_endian_copy_uint8(uint8_t *dst, const uint8_t *src, size_t size);
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 32


  97:controller/utils/utils.h **** 
  98:controller/utils/utils.h **** #define CELSIUS_TO_KELVIN(celsius) ((celsius) + 273.15f)
  99:controller/utils/utils.h **** #define KELVIN_TO_CELSIUS(kelvin) ((kelvin) - 273.15f)
 100:controller/utils/utils.h **** 
 101:controller/utils/utils.h **** /**
 102:controller/utils/utils.h ****  * @brief Function to calculate the microseconds it takes for the engine to turn one degree.
 103:controller/utils/utils.h ****  * @note Returns 0 if rpm is 0.
 104:controller/utils/utils.h ****  */
 105:controller/utils/utils.h **** static inline time_us_t microseconds_per_degree(rpm_t rpm)
 106:controller/utils/utils.h **** {
 107:controller/utils/utils.h ****     if (rpm == 0)
 108:controller/utils/utils.h ****     {
 109:controller/utils/utils.h ****         return 0;
 110:controller/utils/utils.h ****     }
 111:controller/utils/utils.h ****     return (time_us_t)60.0f * 1e6f / (rpm * 360.0f);
 112:controller/utils/utils.h **** }
 113:controller/utils/utils.h **** 
 114:controller/utils/utils.h **** /**
 115:controller/utils/utils.h ****  * @brief Function to calculate the degrees the engine turns in one microsecond.
 116:controller/utils/utils.h ****  * @note Returns 0 if rpm is 0.
 117:controller/utils/utils.h ****  */
 118:controller/utils/utils.h **** static inline angle_t degrees_per_microsecond(rpm_t rpm)
 1071              		.loc 2 118 23 is_stmt 1 view .LVU325
 1072              	.LBB54:
 119:controller/utils/utils.h **** {
 120:controller/utils/utils.h ****     if (rpm == 0)
 1073              		.loc 2 120 5 view .LVU326
 1074              		.loc 2 120 8 is_stmt 0 view .LVU327
 1075 0116 B5EE408A 		vcmp.f32	s16, #0
 1076 011a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1077 011e 00F0AF80 		beq	.L74
 121:controller/utils/utils.h ****     {
 122:controller/utils/utils.h ****         return 0.0f;
 123:controller/utils/utils.h ****     }
 124:controller/utils/utils.h ****     return (angle_t)(rpm * 360.0f) / (60.0f * 1e6f);
 1078              		.loc 2 124 5 is_stmt 1 view .LVU328
 1079              		.loc 2 124 12 is_stmt 0 view .LVU329
 1080 0122 DFED6C6A 		vldr.32	s13, .L89+28
 1081 0126 68EE266A 		vmul.f32	s13, s16, s13
 1082              		.loc 2 124 36 view .LVU330
 1083 012a DFED6B5A 		vldr.32	s11, .L89+32
 1084 012e 86EEA56A 		vdiv.f32	s12, s13, s11
 1085              	.L63:
 1086              	.LVL84:
 1087              		.loc 2 124 36 view .LVU331
 1088              	.LBE54:
 1089              	.LBE53:
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1090              		.loc 1 174 103 discriminator 1 view .LVU332
 1091 0132 67EE867A 		vmul.f32	s15, s15, s12
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1092              		.loc 1 174 58 discriminator 1 view .LVU333
 1093 0136 77EE677A 		vsub.f32	s15, s14, s15
 174:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)config.ignition_dwell * (float)10
 1094              		.loc 1 174 22 discriminator 1 view .LVU334
 1095 013a CDED027A 		vstr.32	s15, [sp, #8]
 176:controller/engine_cycle/ignition.c ****     static uint8_t next_firing_cylinders[2] = {0};
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 33


 1096              		.loc 1 176 5 is_stmt 1 view .LVU335
 178:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 1097              		.loc 1 178 5 view .LVU336
 178:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 1098              		.loc 1 178 46 is_stmt 0 view .LVU337
 1099 013e 6748     		ldr	r0, .L89+36
 1100 0140 C25C     		ldrb	r2, [r0, r3]	@ zero_extendqisi2
 178:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 1101              		.loc 1 178 54 view .LVU338
 1102 0142 013A     		subs	r2, r2, #1
 1103 0144 D2B2     		uxtb	r2, r2
 178:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 1104              		.loc 1 178 30 view .LVU339
 1105 0146 6649     		ldr	r1, .L89+40
 1106 0148 0A70     		strb	r2, [r1]
 179:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 1107              		.loc 1 179 5 is_stmt 1 view .LVU340
 179:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 1108              		.loc 1 179 30 is_stmt 0 view .LVU341
 1109 014a 4A70     		strb	r2, [r1, #1]
 181:controller/engine_cycle/ignition.c ****     if (!is_cam_phase_available)
 1110              		.loc 1 181 5 is_stmt 1 view .LVU342
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 1111              		.loc 1 183 9 view .LVU343
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 1112              		.loc 1 183 57 is_stmt 0 view .LVU344
 1113 014c 0233     		adds	r3, r3, #2
 1114              	.LVL85:
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 1115              		.loc 1 183 50 view .LVU345
 1116 014e C35C     		ldrb	r3, [r0, r3]	@ zero_extendqisi2
 1117              	.LVL86:
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 1118              		.loc 1 183 62 view .LVU346
 1119 0150 013B     		subs	r3, r3, #1
 183:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 1120              		.loc 1 183 34 view .LVU347
 1121 0152 4B70     		strb	r3, [r1, #1]
 186:controller/engine_cycle/ignition.c ****     bool is_synced = get_bit(runtime.status, STATUS_TRIGGER1_SYNCED);
 1122              		.loc 1 186 5 is_stmt 1 view .LVU348
 186:controller/engine_cycle/ignition.c ****     bool is_synced = get_bit(runtime.status, STATUS_TRIGGER1_SYNCED);
 1123              		.loc 1 186 22 is_stmt 0 view .LVU349
 1124 0154 594B     		ldr	r3, .L89+4
 1125              	.LVL87:
 186:controller/engine_cycle/ignition.c ****     bool is_synced = get_bit(runtime.status, STATUS_TRIGGER1_SYNCED);
 1126              		.loc 1 186 22 view .LVU350
 1127 0156 1B68     		ldr	r3, [r3]
 1128              	.LVL88:
 1129              	.LBB56:
 1130              	.LBI56:
  35:controller/utils/utils.h **** {
 1131              		.loc 2 35 20 is_stmt 1 view .LVU351
 1132              	.LBB57:
  37:controller/utils/utils.h ****     {
 1133              		.loc 2 37 5 view .LVU352
  39:controller/utils/utils.h ****     }
 1134              		.loc 2 39 9 view .LVU353
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 34


  39:controller/utils/utils.h ****     }
 1135              		.loc 2 39 9 is_stmt 0 view .LVU354
 1136              	.LBE57:
 1137              	.LBE56:
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1138              		.loc 1 188 5 is_stmt 1 view .LVU355
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1139              		.loc 1 188 8 is_stmt 0 view .LVU356
 1140 0158 13F0080F 		tst	r3, #8
 1141 015c 00F0A480 		beq	.L64
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1142              		.loc 1 188 40 discriminator 1 view .LVU357
 1143 0160 DDED027A 		vldr.32	s15, [sp, #8]
 1144 0164 77EEE87A 		vsub.f32	s15, s15, s17
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1145              		.loc 1 188 19 discriminator 1 view .LVU358
 1146 0168 B2EE047A 		vmov.f32	s14, #1.0e+1
 1147 016c F4EEC77A 		vcmpe.f32	s15, s14
 1148 0170 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1149 0174 40F19880 		bpl	.L64
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1150              		.loc 1 188 68 discriminator 2 view .LVU359
 1151 0178 5A4B     		ldr	r3, .L89+44
 1152              	.LVL89:
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1153              		.loc 1 188 68 discriminator 2 view .LVU360
 1154 017a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1155              		.loc 1 188 65 discriminator 2 view .LVU361
 1156 017c 002B     		cmp	r3, #0
 1157 017e 40F09380 		bne	.L64
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1158              		.loc 1 188 111 discriminator 3 view .LVU362
 1159 0182 DDED027A 		vldr.32	s15, [sp, #8]
 1160 0186 77EEE87A 		vsub.f32	s15, s15, s17
 188:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 1161              		.loc 1 188 90 discriminator 3 view .LVU363
 1162 018a F5EEC07A 		vcmpe.f32	s15, #0
 1163 018e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1164 0192 40F38980 		ble	.L64
 1165              	.LBB58:
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 1166              		.loc 1 192 9 is_stmt 1 view .LVU364
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 1167              		.loc 1 192 89 is_stmt 0 view .LVU365
 1168 0196 DDED027A 		vldr.32	s15, [sp, #8]
 1169 019a 77EEE87A 		vsub.f32	s15, s15, s17
 1170              	.LVL90:
 1171              	.LBB59:
 1172              	.LBI59:
 105:controller/utils/utils.h **** {
 1173              		.loc 2 105 25 is_stmt 1 view .LVU366
 1174              	.LBB60:
 107:controller/utils/utils.h ****     {
 1175              		.loc 2 107 5 view .LVU367
 107:controller/utils/utils.h ****     {
 1176              		.loc 2 107 8 is_stmt 0 view .LVU368
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 35


 1177 019e B5EE408A 		vcmp.f32	s16, #0
 1178 01a2 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1179 01a6 6ED0     		beq	.L75
 111:controller/utils/utils.h **** }
 1180              		.loc 2 111 5 is_stmt 1 view .LVU369
 111:controller/utils/utils.h **** }
 1181              		.loc 2 111 43 is_stmt 0 view .LVU370
 1182 01a8 9FED4A7A 		vldr.32	s14, .L89+28
 1183 01ac 28EE077A 		vmul.f32	s14, s16, s14
 111:controller/utils/utils.h **** }
 1184              		.loc 2 111 36 view .LVU371
 1185 01b0 DFED496A 		vldr.32	s13, .L89+32
 1186 01b4 86EE879A 		vdiv.f32	s18, s13, s14
 1187 01b8 BCEEC99A 		vcvt.u32.f32	s18, s18
 1188              	.L67:
 1189              	.LVL91:
 111:controller/utils/utils.h **** }
 1190              		.loc 2 111 36 view .LVU372
 1191              	.LBE60:
 1192              	.LBE59:
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 1193              		.loc 1 192 109 discriminator 1 view .LVU373
 1194 01bc B8EE499A 		vcvt.f32.u32	s18, s18
 1195 01c0 67EE897A 		vmul.f32	s15, s15, s18
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 1196              		.loc 1 192 59 discriminator 1 view .LVU374
 1197 01c4 FCEEE77A 		vcvt.u32.f32	s15, s15
 1198 01c8 17EE906A 		vmov	r6, s15	@ int
 192:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 1199              		.loc 1 192 19 discriminator 1 view .LVU375
 1200 01cc 2644     		add	r6, r6, r4
 1201              	.LVL92:
 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 1202              		.loc 1 193 9 is_stmt 1 view .LVU376
 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 1203              		.loc 1 193 89 is_stmt 0 view .LVU377
 1204 01ce DDED037A 		vldr.32	s15, [sp, #12]
 1205 01d2 77EEE87A 		vsub.f32	s15, s15, s17
 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 1206              		.loc 1 193 109 discriminator 1 view .LVU378
 1207 01d6 69EE277A 		vmul.f32	s15, s18, s15
 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 1208              		.loc 1 193 59 discriminator 1 view .LVU379
 1209 01da FCEEE77A 		vcvt.u32.f32	s15, s15
 1210 01de 17EE905A 		vmov	r5, s15	@ int
 193:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 1211              		.loc 1 193 19 discriminator 1 view .LVU380
 1212 01e2 2544     		add	r5, r5, r4
 1213              	.LVL93:
 194:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void *)
 1214              		.loc 1 194 9 is_stmt 1 view .LVU381
 1215 01e4 3E4C     		ldr	r4, .L89+40
 1216              	.LVL94:
 194:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void *)
 1217              		.loc 1 194 9 is_stmt 0 view .LVU382
 1218 01e6 2246     		mov	r2, r4
 1219 01e8 3F49     		ldr	r1, .L89+48
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 36


 1220 01ea 3046     		mov	r0, r6
 1221 01ec FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 1222              	.LVL95:
 195:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void *)ne
 1223              		.loc 1 195 9 is_stmt 1 view .LVU383
 1224 01f0 2246     		mov	r2, r4
 1225 01f2 3E49     		ldr	r1, .L89+52
 1226 01f4 2846     		mov	r0, r5
 1227 01f6 FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 1228              	.LVL96:
 197:controller/engine_cycle/ignition.c ****         uint8_t number_of_scheduled_sparks = 1;
 1229              		.loc 1 197 9 view .LVU384
 198:controller/engine_cycle/ignition.c ****         if (!config.multi_spark_enabled)
 1230              		.loc 1 198 9 view .LVU385
 198:controller/engine_cycle/ignition.c ****         if (!config.multi_spark_enabled)
 1231              		.loc 1 198 20 is_stmt 0 view .LVU386
 1232 01fa 2F4B     		ldr	r3, .L89
 1233 01fc 93F8A232 		ldrb	r3, [r3, #674]	@ zero_extendqisi2
 198:controller/engine_cycle/ignition.c ****         if (!config.multi_spark_enabled)
 1234              		.loc 1 198 12 view .LVU387
 1235 0200 002B     		cmp	r3, #0
 1236 0202 43D0     		beq	.L87
 197:controller/engine_cycle/ignition.c ****         uint8_t number_of_scheduled_sparks = 1;
 1237              		.loc 1 197 17 view .LVU388
 1238 0204 0124     		movs	r4, #1
 1239              	.LVL97:
 1240              	.L68:
 204:controller/engine_cycle/ignition.c ****         while (number_of_scheduled_sparks < config.multi_spark_number_of_sparks)
 1241              		.loc 1 204 43 is_stmt 1 view .LVU389
 204:controller/engine_cycle/ignition.c ****         while (number_of_scheduled_sparks < config.multi_spark_number_of_sparks)
 1242              		.loc 1 204 51 is_stmt 0 view .LVU390
 1243 0206 2C4B     		ldr	r3, .L89
 1244 0208 93F8A332 		ldrb	r3, [r3, #675]	@ zero_extendqisi2
 204:controller/engine_cycle/ignition.c ****         while (number_of_scheduled_sparks < config.multi_spark_number_of_sparks)
 1245              		.loc 1 204 43 view .LVU391
 1246 020c A342     		cmp	r3, r4
 1247 020e 45D9     		bls	.L69
 1248              	.LBB62:
 206:controller/engine_cycle/ignition.c ****             if (rpm > config.multi_spark_rpm_threshold)
 1249              		.loc 1 206 13 is_stmt 1 view .LVU392
 206:controller/engine_cycle/ignition.c ****             if (rpm > config.multi_spark_rpm_threshold)
 1250              		.loc 1 206 29 is_stmt 0 view .LVU393
 1251 0210 294B     		ldr	r3, .L89
 1252 0212 D3ED847A 		vldr.32	s15, [r3, #528]
 206:controller/engine_cycle/ignition.c ****             if (rpm > config.multi_spark_rpm_threshold)
 1253              		.loc 1 206 16 view .LVU394
 1254 0216 F4EEC87A 		vcmpe.f32	s15, s16
 1255 021a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1256 021e 3DD4     		bmi	.L69
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1257              		.loc 1 210 13 is_stmt 1 view .LVU395
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1258              		.loc 1 210 64 is_stmt 0 view .LVU396
 1259 0220 07EE904A 		vmov	s15, r4	@ int
 1260 0224 F8EE677A 		vcvt.f32.u32	s15, s15
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1261              		.loc 1 210 107 view .LVU397
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 37


 1262 0228 93ED857A 		vldr.32	s14, [r3, #532]
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1263              		.loc 1 210 141 view .LVU398
 1264 022c D3ED836A 		vldr.32	s13, [r3, #524]
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1265              		.loc 1 210 133 view .LVU399
 1266 0230 37EE267A 		vadd.f32	s14, s14, s13
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1267              		.loc 1 210 98 view .LVU400
 1268 0234 67EE877A 		vmul.f32	s15, s15, s14
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1269              		.loc 1 210 158 view .LVU401
 1270 0238 9FED257A 		vldr.32	s14, .L89+24
 1271 023c 67EE877A 		vmul.f32	s15, s15, s14
 210:controller/engine_cycle/ignition.c ****             time_us_t duration_of_spark_and_dwell = (uint32_t)((float)number_of_scheduled_sparks * 
 1272              		.loc 1 210 23 view .LVU402
 1273 0240 FCEEE77A 		vcvt.u32.f32	s15, s15
 1274              	.LVL98:
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 1275              		.loc 1 211 13 is_stmt 1 view .LVU403
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 1276              		.loc 1 211 45 is_stmt 0 view .LVU404
 1277 0244 F8EE676A 		vcvt.f32.u32	s13, s15
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 1278              		.loc 1 211 54 view .LVU405
 1279 0248 93ED867A 		vldr.32	s14, [r3, #536]
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 1280              		.loc 1 211 86 discriminator 1 view .LVU406
 1281 024c 29EE077A 		vmul.f32	s14, s18, s14
 211:controller/engine_cycle/ignition.c ****             if (duration_of_spark_and_dwell >= config.multi_spark_max_trailing_angle * microseconds
 1282              		.loc 1 211 16 discriminator 1 view .LVU407
 1283 0250 F4EEC76A 		vcmpe.f32	s13, s14
 1284 0254 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1285 0258 20DA     		bge	.L69
 216:controller/engine_cycle/ignition.c ****             dwell_start_time_us += duration_of_spark_and_dwell;
 1286              		.loc 1 216 13 is_stmt 1 view .LVU408
 216:controller/engine_cycle/ignition.c ****             dwell_start_time_us += duration_of_spark_and_dwell;
 1287              		.loc 1 216 33 is_stmt 0 view .LVU409
 1288 025a 17EE903A 		vmov	r3, s15	@ int
 1289 025e 1E44     		add	r6, r6, r3
 1290              	.LVL99:
 217:controller/engine_cycle/ignition.c ****             spark_start_time_us += duration_of_spark_and_dwell;
 1291              		.loc 1 217 13 is_stmt 1 view .LVU410
 217:controller/engine_cycle/ignition.c ****             spark_start_time_us += duration_of_spark_and_dwell;
 1292              		.loc 1 217 33 is_stmt 0 view .LVU411
 1293 0260 1D44     		add	r5, r5, r3
 1294              	.LVL100:
 220:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (
 1295              		.loc 1 220 13 is_stmt 1 view .LVU412
 220:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (
 1296              		.loc 1 220 18 is_stmt 0 view .LVU413
 1297 0262 1F4A     		ldr	r2, .L89+40
 1298 0264 2149     		ldr	r1, .L89+52
 1299 0266 2846     		mov	r0, r5
 1300 0268 FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 1301              	.LVL101:
 220:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 38


 1302              		.loc 1 220 16 discriminator 1 view .LVU414
 1303 026c 98B1     		cbz	r0, .L88
 226:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge,
 1304              		.loc 1 226 13 is_stmt 1 view .LVU415
 226:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge,
 1305              		.loc 1 226 18 is_stmt 0 view .LVU416
 1306 026e 1C4A     		ldr	r2, .L89+40
 1307 0270 1D49     		ldr	r1, .L89+48
 1308 0272 3046     		mov	r0, r6
 1309 0274 FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 1310              	.LVL102:
 226:controller/engine_cycle/ignition.c ****             if (!scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge,
 1311              		.loc 1 226 16 discriminator 1 view .LVU417
 1312 0278 80B1     		cbz	r0, .L69
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 1313              		.loc 1 231 13 is_stmt 1 view .LVU418
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 1314              		.loc 1 231 39 is_stmt 0 view .LVU419
 1315 027a 0134     		adds	r4, r4, #1
 1316              	.LVL103:
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 1317              		.loc 1 231 39 view .LVU420
 1318 027c E4B2     		uxtb	r4, r4
 1319              	.LVL104:
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 1320              		.loc 1 231 39 view .LVU421
 1321 027e C2E7     		b	.L68
 1322              	.LVL105:
 1323              	.L74:
 231:controller/engine_cycle/ignition.c ****             number_of_scheduled_sparks++;
 1324              		.loc 1 231 39 view .LVU422
 1325              	.LBE62:
 1326              	.LBE58:
 1327              	.LBB65:
 1328              	.LBB55:
 122:controller/utils/utils.h ****     }
 1329              		.loc 2 122 16 view .LVU423
 1330 0280 9FED126A 		vldr.32	s12, .L89+20
 1331 0284 55E7     		b	.L63
 1332              	.LVL106:
 1333              	.L75:
 122:controller/utils/utils.h ****     }
 1334              		.loc 2 122 16 view .LVU424
 1335              	.LBE55:
 1336              	.LBE65:
 1337              	.LBB66:
 1338              	.LBB63:
 1339              	.LBB61:
 109:controller/utils/utils.h ****     }
 1340              		.loc 2 109 16 view .LVU425
 1341 0286 9FED1A9A 		vldr.32	s18, .L89+56	@ int
 1342 028a 97E7     		b	.L67
 1343              	.LVL107:
 1344              	.L87:
 109:controller/utils/utils.h ****     }
 1345              		.loc 2 109 16 view .LVU426
 1346              	.LBE61:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 39


 1347              	.LBE63:
 200:controller/engine_cycle/ignition.c ****             runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 1348              		.loc 1 200 13 is_stmt 1 view .LVU427
 200:controller/engine_cycle/ignition.c ****             runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 1349              		.loc 1 200 52 is_stmt 0 view .LVU428
 1350 028c 0B4B     		ldr	r3, .L89+4
 1351 028e 0122     		movs	r2, #1
 1352 0290 83F85220 		strb	r2, [r3, #82]
 201:controller/engine_cycle/ignition.c ****             return;
 1353              		.loc 1 201 13 is_stmt 1 view .LVU429
 1354 0294 03E7     		b	.L53
 1355              	.LVL108:
 1356              	.L88:
 1357              	.LBB64:
 223:controller/engine_cycle/ignition.c ****                 ignition_coil_fire_spark((void *)next_firing_cylinders);
 1358              		.loc 1 223 17 view .LVU430
 1359 0296 1248     		ldr	r0, .L89+40
 1360 0298 FFF7FEFF 		bl	ignition_coil_fire_spark
 1361              	.LVL109:
 224:controller/engine_cycle/ignition.c ****                 break;
 1362              		.loc 1 224 17 view .LVU431
 1363              	.L69:
 224:controller/engine_cycle/ignition.c ****                 break;
 1364              		.loc 1 224 17 is_stmt 0 view .LVU432
 1365              	.LBE64:
 233:controller/engine_cycle/ignition.c ****         spark_is_in_progress = true;
 1366              		.loc 1 233 9 is_stmt 1 view .LVU433
 233:controller/engine_cycle/ignition.c ****         spark_is_in_progress = true;
 1367              		.loc 1 233 30 is_stmt 0 view .LVU434
 1368 029c 114B     		ldr	r3, .L89+44
 1369 029e 0122     		movs	r2, #1
 1370 02a0 1A70     		strb	r2, [r3]
 234:controller/engine_cycle/ignition.c ****         runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 1371              		.loc 1 234 9 is_stmt 1 view .LVU435
 234:controller/engine_cycle/ignition.c ****         runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 1372              		.loc 1 234 48 is_stmt 0 view .LVU436
 1373 02a2 064B     		ldr	r3, .L89+4
 1374 02a4 83F85240 		strb	r4, [r3, #82]
 1375              	.LVL110:
 1376              	.L64:
 234:controller/engine_cycle/ignition.c ****         runtime.multi_spark_actual_spark_count = number_of_scheduled_sparks;
 1377              		.loc 1 234 48 view .LVU437
 1378              	.LBE66:
 236:controller/engine_cycle/ignition.c ****     change_bit(&runtime.status, STATUS_IGNITION_ERROR, false);
 1379              		.loc 1 236 5 is_stmt 1 view .LVU438
 1380              	.LBB67:
 1381              	.LBI67:
  19:controller/utils/utils.h **** {
 1382              		.loc 2 19 20 view .LVU439
 1383              	.LBB68:
  21:controller/utils/utils.h ****     {
 1384              		.loc 2 21 5 view .LVU440
  25:controller/utils/utils.h ****     {
 1385              		.loc 2 25 5 view .LVU441
  31:controller/utils/utils.h ****     }
 1386              		.loc 2 31 9 view .LVU442
 1387 02a8 044A     		ldr	r2, .L89+4
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 40


 1388 02aa 1368     		ldr	r3, [r2]
  31:controller/utils/utils.h ****     }
 1389              		.loc 2 31 14 is_stmt 0 view .LVU443
 1390 02ac 23F48023 		bic	r3, r3, #262144
 1391 02b0 1360     		str	r3, [r2]
 1392              	.LVL111:
  31:controller/utils/utils.h ****     }
 1393              		.loc 2 31 14 view .LVU444
 1394 02b2 F4E6     		b	.L53
 1395              	.LVL112:
 1396              	.L83:
 1397              		.cfi_def_cfa_offset 0
 1398              		.cfi_restore 4
 1399              		.cfi_restore 5
 1400              		.cfi_restore 6
 1401              		.cfi_restore 14
 1402              		.cfi_restore 80
 1403              		.cfi_restore 81
 1404              		.cfi_restore 82
 1405              		.cfi_restore 83
  31:controller/utils/utils.h ****     }
 1406              		.loc 2 31 14 view .LVU445
 1407 02b4 7047     		bx	lr
 1408              	.L90:
 1409 02b6 00BF     		.align	2
 1410              	.L89:
 1411 02b8 00100000 		.word	config+4096
 1412 02bc 00000000 		.word	runtime
 1413 02c0 00000000 		.word	.LC6
 1414 02c4 1C000000 		.word	.LC7
 1415 02c8 00002042 		.word	1109393408
 1416 02cc 00000000 		.word	0
 1417 02d0 00007A44 		.word	1148846080
 1418 02d4 0000B443 		.word	1135869952
 1419 02d8 C0E1644C 		.word	1281679808
 1420 02dc 00000000 		.word	ignition_order
 1421 02e0 00000000 		.word	next_firing_cylinders.0
 1422 02e4 00000000 		.word	spark_is_in_progress
 1423 02e8 00000000 		.word	ignition_coil_begin_charge
 1424 02ec 00000000 		.word	ignition_coil_fire_spark
 1425 02f0 00000000 		.word	0
 1426              	.LBE68:
 1427              	.LBE67:
 1428              		.cfi_endproc
 1429              	.LFE233:
 1431              		.section	.bss.next_firing_cylinders.0,"aw",%nobits
 1432              		.align	2
 1435              	next_firing_cylinders.0:
 1436 0000 0000     		.space	2
 1437              		.section	.bss.number_of_cylinders,"aw",%nobits
 1440              	number_of_cylinders:
 1441 0000 00       		.space	1
 1442              		.section	.bss.spark_is_in_progress,"aw",%nobits
 1445              	spark_is_in_progress:
 1446 0000 00       		.space	1
 1447              		.global	ignition_order
 1448              		.section	.bss.ignition_order,"aw",%nobits
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 41


 1449              		.align	2
 1452              	ignition_order:
 1453 0000 00000000 		.space	8
 1453      00000000 
 1454              		.global	ignition_coil_state
 1455              		.section	.bss.ignition_coil_state,"aw",%nobits
 1456              		.align	2
 1459              	ignition_coil_state:
 1460 0000 00000000 		.space	4
 1461              		.global	ignition_outputs
 1462              		.section	.bss.ignition_outputs,"aw",%nobits
 1463              		.align	2
 1466              	ignition_outputs:
 1467 0000 00000000 		.space	4
 1468              		.text
 1469              	.Letext0:
 1470              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 1471              		.file 4 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 1472              		.file 5 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 1473              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 1474              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1475              		.file 8 "controller/types.h"
 1476              		.file 9 "controller/tables.h"
 1477              		.file 10 "controller/config_and_runtime.h"
 1478              		.file 11 "controller/engine_cycle/trigger.h"
 1479              		.file 12 "controller/engine_cycle/ignition.h"
 1480              		.file 13 "controller/IO/sensors.h"
 1481              		.file 14 "controller/utils/timing.h"
 1482              		.file 15 "controller/utils/error_handling.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s 			page 42


DEFINED SYMBOLS
                            *ABS*:00000000 ignition.c
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:21     .rodata.ignition_coil_begin_charge.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:25     .text.ignition_coil_begin_charge:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:31     .text.ignition_coil_begin_charge:00000000 ignition_coil_begin_charge
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:143    .text.ignition_coil_begin_charge:0000005c $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1459   .bss.ignition_coil_state:00000000 ignition_coil_state
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1466   .bss.ignition_outputs:00000000 ignition_outputs
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:151    .text.ignition_coil_fire_spark:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:157    .text.ignition_coil_fire_spark:00000000 ignition_coil_fire_spark
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:272    .text.ignition_coil_fire_spark:00000060 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1445   .bss.spark_is_in_progress:00000000 spark_is_in_progress
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:281    .rodata.ignition_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:298    .text.ignition_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:304    .text.ignition_init:00000000 ignition_init
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:727    .text.ignition_init:0000018c $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1440   .bss.number_of_cylinders:00000000 number_of_cylinders
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1452   .bss.ignition_order:00000000 ignition_order
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:743    .text.ignition_get_coil_duty_cycle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:749    .text.ignition_get_coil_duty_cycle:00000000 ignition_get_coil_duty_cycle
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:762    .text.ignition_get_advance:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:768    .text.ignition_get_advance:00000000 ignition_get_advance
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:834    .text.ignition_get_advance:00000038 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:841    .rodata.ignition_trigger_event_handle.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:848    .text.ignition_trigger_event_handle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:854    .text.ignition_trigger_event_handle:00000000 ignition_trigger_event_handle
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1411   .text.ignition_trigger_event_handle:000002b8 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1435   .bss.next_firing_cylinders.0:00000000 next_firing_cylinders.0
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1432   .bss.next_firing_cylinders.0:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1441   .bss.number_of_cylinders:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1446   .bss.spark_is_in_progress:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1449   .bss.ignition_order:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1456   .bss.ignition_coil_state:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5Z7IOi.s:1463   .bss.ignition_outputs:00000000 $d

UNDEFINED SYMBOLS
log_error
HAL_GPIO_WritePin
runtime
log_warning
HAL_GPIO_ReadPin
config
crankshaft_get_rpm
sensor_map_get
table_2d_get_value
scheduler_schedule_event_with_arg
