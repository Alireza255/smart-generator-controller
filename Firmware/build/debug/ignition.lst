ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"ignition.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "controller/engine_cycle/ignition.c"
  20              		.section	.rodata.ignition_coil_begin_charge.str1.4,"aMS",%progbits,1
  21              		.align	2
  22              	.LC0:
  23 0000 556E6B6F 		.ascii	"Unkown ignition output\000"
  23      776E2069 
  23      676E6974 
  23      696F6E20 
  23      6F757470 
  24              		.section	.text.ignition_coil_begin_charge,"ax",%progbits
  25              		.align	1
  26              		.global	ignition_coil_begin_charge
  27              		.syntax unified
  28              		.thumb
  29              		.thumb_func
  31              	ignition_coil_begin_charge:
  32              	.LVL0:
  33              	.LFB233:
   1:controller/engine_cycle/ignition.c **** #include "ignition.h"
   2:controller/engine_cycle/ignition.c **** 
   3:controller/engine_cycle/ignition.c **** controller_output_pin_t ignition_outputs[IGNITION_MAX_OUTPUTS] = {0};
   4:controller/engine_cycle/ignition.c **** 
   5:controller/engine_cycle/ignition.c **** volatile ignition_coil_state_t ignition_coil_state[IGNITION_MAX_OUTPUTS] = {0};
   6:controller/engine_cycle/ignition.c **** 
   7:controller/engine_cycle/ignition.c **** uint8_t ignition_order[IGNITION_MAX_OUTPUTS] = {0};
   8:controller/engine_cycle/ignition.c **** 
   9:controller/engine_cycle/ignition.c **** static volatile bool spark_is_in_progress = false;
  10:controller/engine_cycle/ignition.c **** 
  11:controller/engine_cycle/ignition.c **** 
  12:controller/engine_cycle/ignition.c **** void ignition_init(ignition_output_conf_t *output_conf)
  13:controller/engine_cycle/ignition.c **** {
  14:controller/engine_cycle/ignition.c ****     if (output_conf == NULL)
  15:controller/engine_cycle/ignition.c ****     {
  16:controller/engine_cycle/ignition.c ****         log_error("ignition init failed. No output config");
  17:controller/engine_cycle/ignition.c ****         return;
  18:controller/engine_cycle/ignition.c ****     }
  19:controller/engine_cycle/ignition.c **** 
  20:controller/engine_cycle/ignition.c **** 
  21:controller/engine_cycle/ignition.c ****     switch (configuration.firing_order)
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 2


  22:controller/engine_cycle/ignition.c ****     {
  23:controller/engine_cycle/ignition.c ****         case FO_1342:
  24:controller/engine_cycle/ignition.c ****             engine.cylinder_count = 4;
  25:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
  26:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
  27:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
  28:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
  29:controller/engine_cycle/ignition.c ****         break;
  30:controller/engine_cycle/ignition.c ****         
  31:controller/engine_cycle/ignition.c ****         default:
  32:controller/engine_cycle/ignition.c ****             log_error("ignition init failed. unkown firing order.");
  33:controller/engine_cycle/ignition.c ****             return;
  34:controller/engine_cycle/ignition.c ****         break;
  35:controller/engine_cycle/ignition.c ****     }
  36:controller/engine_cycle/ignition.c ****     
  37:controller/engine_cycle/ignition.c ****     engine.firing_interval = (angle_t)720 / engine.cylinder_count;
  38:controller/engine_cycle/ignition.c **** 
  39:controller/engine_cycle/ignition.c **** 
  40:controller/engine_cycle/ignition.c ****     for (size_t i = 0; i < IGNITION_MAX_OUTPUTS; i++)
  41:controller/engine_cycle/ignition.c ****     {
  42:controller/engine_cycle/ignition.c ****         ignition_outputs[i].gpio = output_conf->output[i].gpio;
  43:controller/engine_cycle/ignition.c ****         ignition_outputs[i].pin = output_conf->output[i].pin;
  44:controller/engine_cycle/ignition.c ****     }
  45:controller/engine_cycle/ignition.c ****     /* Read the pin states from real hardware */
  46:controller/engine_cycle/ignition.c ****     for (size_t i = 0; i < IGNITION_MAX_OUTPUTS; i++)
  47:controller/engine_cycle/ignition.c ****     {
  48:controller/engine_cycle/ignition.c ****         ignition_coil_state[i] = HAL_GPIO_ReadPin(ignition_outputs[i].gpio, ignition_outputs->pin);
  49:controller/engine_cycle/ignition.c ****     }
  50:controller/engine_cycle/ignition.c ****     /* Set all outputs to reset just in case */
  51:controller/engine_cycle/ignition.c ****     for (size_t i = 0; i < IGNITION_MAX_OUTPUTS; i++)
  52:controller/engine_cycle/ignition.c ****     {
  53:controller/engine_cycle/ignition.c ****         HAL_GPIO_WritePin(ignition_outputs[i].gpio, ignition_outputs->pin, GPIO_PIN_RESET);
  54:controller/engine_cycle/ignition.c ****     }
  55:controller/engine_cycle/ignition.c ****     
  56:controller/engine_cycle/ignition.c ****     if (configuration.ignition_is_multi_spark && !IS_IN_RANGE(configuration.ignition_multi_spark_nu
  57:controller/engine_cycle/ignition.c ****     {
  58:controller/engine_cycle/ignition.c ****         log_warning("Multi spark is enabled but number of sparks are 0.");
  59:controller/engine_cycle/ignition.c ****     }
  60:controller/engine_cycle/ignition.c **** 
  61:controller/engine_cycle/ignition.c **** }
  62:controller/engine_cycle/ignition.c **** 
  63:controller/engine_cycle/ignition.c **** /**
  64:controller/engine_cycle/ignition.c ****  * @brief Handles an ignition trigger event based on the crankshaft angle, RPM, and current time.
  65:controller/engine_cycle/ignition.c ****  * 
  66:controller/engine_cycle/ignition.c ****  * @param crankshaft_angle The current angle of the crankshaft.
  67:controller/engine_cycle/ignition.c ****  * @param rpm The current revolutions per minute of the engine.
  68:controller/engine_cycle/ignition.c ****  * @param current_time_us The current time in microseconds.
  69:controller/engine_cycle/ignition.c ****  */
  70:controller/engine_cycle/ignition.c **** void ignition_trigger_event_handle(angle_t crankshaft_angle, rpm_t rpm, time_us_t current_time_us)
  71:controller/engine_cycle/ignition.c **** {
  72:controller/engine_cycle/ignition.c ****     /**
  73:controller/engine_cycle/ignition.c ****      * @todo add the necessary checks and bounds
  74:controller/engine_cycle/ignition.c ****      */
  75:controller/engine_cycle/ignition.c ****     if (engine.firing_interval == 0)
  76:controller/engine_cycle/ignition.c ****     {
  77:controller/engine_cycle/ignition.c ****         log_error("ignition not initialized.");
  78:controller/engine_cycle/ignition.c ****         return;
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 3


  79:controller/engine_cycle/ignition.c ****     }
  80:controller/engine_cycle/ignition.c ****     
  81:controller/engine_cycle/ignition.c ****     if (configuration.ignition_mode == IM_NO_IGNITION)
  82:controller/engine_cycle/ignition.c ****     {
  83:controller/engine_cycle/ignition.c ****         // obviously, there is no need to do any furthure processing
  84:controller/engine_cycle/ignition.c ****         return;
  85:controller/engine_cycle/ignition.c ****     }
  86:controller/engine_cycle/ignition.c ****     
  87:controller/engine_cycle/ignition.c ****     if (!IS_IN_RANGE(configuration.ignition_dwell, IGNITION_MIN_DWELL_TIME_MS, IGNITION_MAX_DWELL_T
  88:controller/engine_cycle/ignition.c ****     {
  89:controller/engine_cycle/ignition.c ****         /**
  90:controller/engine_cycle/ignition.c ****          * @todo throw an error
  91:controller/engine_cycle/ignition.c ****          */
  92:controller/engine_cycle/ignition.c ****         log_error("ignition dwell out of bounds.");
  93:controller/engine_cycle/ignition.c ****         return;
  94:controller/engine_cycle/ignition.c ****     }
  95:controller/engine_cycle/ignition.c ****     /* Wether or not cam phase is known */
  96:controller/engine_cycle/ignition.c ****     bool is_cam_phase_available = false;
  97:controller/engine_cycle/ignition.c **** 
  98:controller/engine_cycle/ignition.c ****     angle_t spark_advance = 0;
  99:controller/engine_cycle/ignition.c ****     #ifdef TEST_MODE
 100:controller/engine_cycle/ignition.c ****     spark_advance = (angle_t)30;
 101:controller/engine_cycle/ignition.c ****     #else
 102:controller/engine_cycle/ignition.c ****     spark_advance = spark_logic_get_advance();
 103:controller/engine_cycle/ignition.c ****     #endif
 104:controller/engine_cycle/ignition.c **** 
 105:controller/engine_cycle/ignition.c ****     spark_advance = CLAMP(spark_advance, IGNITION_MIN_ADVANCE, IGNITION_MAX_ADVANCE);
 106:controller/engine_cycle/ignition.c ****     
 107:controller/engine_cycle/ignition.c ****     uint8_t multi_spark_count = 0;
 108:controller/engine_cycle/ignition.c ****     if (configuration.ignition_is_multi_spark && rpm < configuration.ignition_multi_spark_rpm_thres
 109:controller/engine_cycle/ignition.c ****     {
 110:controller/engine_cycle/ignition.c ****         multi_spark_count = configuration.ignition_multi_spark_number_of_sparks;
 111:controller/engine_cycle/ignition.c ****     }
 112:controller/engine_cycle/ignition.c ****     
 113:controller/engine_cycle/ignition.c **** 
 114:controller/engine_cycle/ignition.c ****     /* First we have to detect the engine phase */
 115:controller/engine_cycle/ignition.c ****     uint8_t phase = (uint8_t)(crankshaft_angle / engine.firing_interval);
 116:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)engine.firing_interval;
 117:controller/engine_cycle/ignition.c **** 
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_spark_angle = phase * engine.firing_interval - spark_advance + engine.fir
 119:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
 120:controller/engine_cycle/ignition.c ****     
 121:controller/engine_cycle/ignition.c ****     static uint8_t next_firing_cylinders[2] = {0};
 122:controller/engine_cycle/ignition.c **** 
 123:controller/engine_cycle/ignition.c ****     next_firing_cylinders[0] = ignition_order[phase] - 1;
 124:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 125:controller/engine_cycle/ignition.c **** 
 126:controller/engine_cycle/ignition.c ****     if (!is_cam_phase_available)
 127:controller/engine_cycle/ignition.c ****     {
 128:controller/engine_cycle/ignition.c ****         next_firing_cylinders[1] = ignition_order[phase + 2] - 1;
 129:controller/engine_cycle/ignition.c ****         
 130:controller/engine_cycle/ignition.c ****     }
 131:controller/engine_cycle/ignition.c ****     
 132:controller/engine_cycle/ignition.c **** 
 133:controller/engine_cycle/ignition.c ****     bool is_synced = engine.trigger.sync_status == TS_FULLY_SYNCED;
 134:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 135:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 4


 136:controller/engine_cycle/ignition.c ****         /* Now we are close enough to the dwell angle that we can schedule the coil charge start */
 137:controller/engine_cycle/ignition.c ****         spark_is_in_progress = true;
 138:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 139:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 140:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
 141:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void*)nex
 142:controller/engine_cycle/ignition.c **** 
 143:controller/engine_cycle/ignition.c ****     }
 144:controller/engine_cycle/ignition.c ****     
 145:controller/engine_cycle/ignition.c **** }
 146:controller/engine_cycle/ignition.c **** 
 147:controller/engine_cycle/ignition.c **** 
 148:controller/engine_cycle/ignition.c **** /**
 149:controller/engine_cycle/ignition.c ****  * @brief Gets the number of sparks per coil based on the ignition mode.
 150:controller/engine_cycle/ignition.c ****  * 
 151:controller/engine_cycle/ignition.c ****  * @param ignition_mode The mode of ignition, specified as an enumeration of type ignition_mode_e.
 152:controller/engine_cycle/ignition.c ****  * @return The number of sparks per coil.
 153:controller/engine_cycle/ignition.c ****  */
 154:controller/engine_cycle/ignition.c **** uint8_t ignition_get_number_of_sparks_per_coil(ignition_mode_e ignition_mode)
 155:controller/engine_cycle/ignition.c **** {
 156:controller/engine_cycle/ignition.c ****     switch (ignition_mode)
 157:controller/engine_cycle/ignition.c ****     {
 158:controller/engine_cycle/ignition.c ****     case IM_ONE_COIL:
 159:controller/engine_cycle/ignition.c ****         return engine.cylinder_count;
 160:controller/engine_cycle/ignition.c ****     case IM_INDIVIDUAL_COILS:
 161:controller/engine_cycle/ignition.c ****         return 1;
 162:controller/engine_cycle/ignition.c ****     case IM_WASTED_SPARK:
 163:controller/engine_cycle/ignition.c ****         return 2;
 164:controller/engine_cycle/ignition.c ****     default:
 165:controller/engine_cycle/ignition.c ****         log_error("Unkown ignition mode");
 166:controller/engine_cycle/ignition.c ****         return 1;
 167:controller/engine_cycle/ignition.c ****     }
 168:controller/engine_cycle/ignition.c **** }
 169:controller/engine_cycle/ignition.c **** 
 170:controller/engine_cycle/ignition.c **** 
 171:controller/engine_cycle/ignition.c **** /**
 172:controller/engine_cycle/ignition.c ****  * @brief Charges the ignition coil at the specified index.
 173:controller/engine_cycle/ignition.c ****  * 
 174:controller/engine_cycle/ignition.c ****  * @param coil_index The index of the coil to be charged.
 175:controller/engine_cycle/ignition.c ****  */
 176:controller/engine_cycle/ignition.c **** void ignition_coil_begin_charge(void *arg)
 177:controller/engine_cycle/ignition.c **** {
  34              		.loc 1 177 1 view -0
  35              		.cfi_startproc
  36              		@ args = 0, pretend = 0, frame = 0
  37              		@ frame_needed = 0, uses_anonymous_args = 0
 178:controller/engine_cycle/ignition.c ****     if (arg == NULL)
  38              		.loc 1 178 5 view .LVU1
  39              		.loc 1 178 8 is_stmt 0 view .LVU2
  40 0000 10B3     		cbz	r0, .L5
 177:controller/engine_cycle/ignition.c ****     if (arg == NULL)
  41              		.loc 1 177 1 view .LVU3
  42 0002 70B5     		push	{r4, r5, r6, lr}
  43              		.cfi_def_cfa_offset 16
  44              		.cfi_offset 4, -16
  45              		.cfi_offset 5, -12
  46              		.cfi_offset 6, -8
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 5


  47              		.cfi_offset 14, -4
  48 0004 0446     		mov	r4, r0
 179:controller/engine_cycle/ignition.c ****     {
 180:controller/engine_cycle/ignition.c ****         return;
 181:controller/engine_cycle/ignition.c ****     }
 182:controller/engine_cycle/ignition.c ****     uint8_t *coil_index = (uint8_t*)arg;
  49              		.loc 1 182 5 is_stmt 1 view .LVU4
  50              	.LVL1:
 183:controller/engine_cycle/ignition.c **** 
 184:controller/engine_cycle/ignition.c ****     if (coil_index[1] > IGNITION_MAX_OUTPUTS - 1)
  51              		.loc 1 184 5 view .LVU5
  52              		.loc 1 184 19 is_stmt 0 view .LVU6
  53 0006 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
  54              		.loc 1 184 8 view .LVU7
  55 0008 032B     		cmp	r3, #3
  56 000a 19D8     		bhi	.L8
 185:controller/engine_cycle/ignition.c ****     {
 186:controller/engine_cycle/ignition.c ****         log_error("Unkown ignition output");
 187:controller/engine_cycle/ignition.c ****         return;
 188:controller/engine_cycle/ignition.c ****     }
 189:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[0]] = IGNITION_COIL_STATE_CHARGING;
  57              		.loc 1 189 5 is_stmt 1 view .LVU8
  58              		.loc 1 189 35 is_stmt 0 view .LVU9
  59 000c 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
  60              		.loc 1 189 40 view .LVU10
  61 000e 0F4B     		ldr	r3, .L9
  62 0010 0126     		movs	r6, #1
  63 0012 9E54     		strb	r6, [r3, r2]
 190:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_CHARGING;
  64              		.loc 1 190 5 is_stmt 1 view .LVU11
  65              		.loc 1 190 35 is_stmt 0 view .LVU12
  66 0014 4278     		ldrb	r2, [r0, #1]	@ zero_extendqisi2
  67              		.loc 1 190 40 view .LVU13
  68 0016 9E54     		strb	r6, [r3, r2]
 191:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
  69              		.loc 1 191 5 is_stmt 1 view .LVU14
  70              		.loc 1 191 50 is_stmt 0 view .LVU15
  71 0018 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
  72              		.loc 1 191 92 view .LVU16
  73 001a 0D4D     		ldr	r5, .L9+4
  74 001c 05EBC301 		add	r1, r5, r3, lsl #3
  75              		.loc 1 191 5 view .LVU17
  76 0020 3246     		mov	r2, r6
  77 0022 8988     		ldrh	r1, [r1, #4]
  78 0024 55F83300 		ldr	r0, [r5, r3, lsl #3]
  79              	.LVL2:
  80              		.loc 1 191 5 view .LVU18
  81 0028 FFF7FEFF 		bl	HAL_GPIO_WritePin
  82              	.LVL3:
 192:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
  83              		.loc 1 192 5 is_stmt 1 view .LVU19
  84              		.loc 1 192 50 is_stmt 0 view .LVU20
  85 002c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
  86              		.loc 1 192 92 view .LVU21
  87 002e 05EBC301 		add	r1, r5, r3, lsl #3
  88              		.loc 1 192 5 view .LVU22
  89 0032 3246     		mov	r2, r6
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 6


  90 0034 8988     		ldrh	r1, [r1, #4]
  91 0036 55F83300 		ldr	r0, [r5, r3, lsl #3]
  92 003a FFF7FEFF 		bl	HAL_GPIO_WritePin
  93              	.LVL4:
  94              	.L1:
 193:controller/engine_cycle/ignition.c **** }
  95              		.loc 1 193 1 view .LVU23
  96 003e 70BD     		pop	{r4, r5, r6, pc}
  97              	.LVL5:
  98              	.L8:
 186:controller/engine_cycle/ignition.c ****         return;
  99              		.loc 1 186 9 is_stmt 1 view .LVU24
 100 0040 0448     		ldr	r0, .L9+8
 101              	.LVL6:
 186:controller/engine_cycle/ignition.c ****         return;
 102              		.loc 1 186 9 is_stmt 0 view .LVU25
 103 0042 FFF7FEFF 		bl	log_error
 104              	.LVL7:
 187:controller/engine_cycle/ignition.c ****     }
 105              		.loc 1 187 9 is_stmt 1 view .LVU26
 106 0046 FAE7     		b	.L1
 107              	.LVL8:
 108              	.L5:
 109              		.cfi_def_cfa_offset 0
 110              		.cfi_restore 4
 111              		.cfi_restore 5
 112              		.cfi_restore 6
 113              		.cfi_restore 14
 187:controller/engine_cycle/ignition.c ****     }
 114              		.loc 1 187 9 is_stmt 0 view .LVU27
 115 0048 7047     		bx	lr
 116              	.L10:
 117 004a 00BF     		.align	2
 118              	.L9:
 119 004c 00000000 		.word	ignition_coil_state
 120 0050 00000000 		.word	ignition_outputs
 121 0054 00000000 		.word	.LC0
 122              		.cfi_endproc
 123              	.LFE233:
 125              		.section	.text.ignition_coil_fire_spark,"ax",%progbits
 126              		.align	1
 127              		.global	ignition_coil_fire_spark
 128              		.syntax unified
 129              		.thumb
 130              		.thumb_func
 132              	ignition_coil_fire_spark:
 133              	.LVL9:
 134              	.LFB234:
 194:controller/engine_cycle/ignition.c **** 
 195:controller/engine_cycle/ignition.c **** /**
 196:controller/engine_cycle/ignition.c ****  * @brief Fires a spark from the ignition coil at the specified index.
 197:controller/engine_cycle/ignition.c ****  * 
 198:controller/engine_cycle/ignition.c ****  * @param coil_index The index of the coil to fire the spark from.
 199:controller/engine_cycle/ignition.c ****  */
 200:controller/engine_cycle/ignition.c **** void ignition_coil_fire_spark(void *arg)
 201:controller/engine_cycle/ignition.c **** {
 135              		.loc 1 201 1 is_stmt 1 view -0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 7


 136              		.cfi_startproc
 137              		@ args = 0, pretend = 0, frame = 0
 138              		@ frame_needed = 0, uses_anonymous_args = 0
 202:controller/engine_cycle/ignition.c ****     if (arg == NULL)
 139              		.loc 1 202 5 view .LVU29
 140              		.loc 1 202 8 is_stmt 0 view .LVU30
 141 0000 20B3     		cbz	r0, .L15
 201:controller/engine_cycle/ignition.c ****     if (arg == NULL)
 142              		.loc 1 201 1 view .LVU31
 143 0002 70B5     		push	{r4, r5, r6, lr}
 144              		.cfi_def_cfa_offset 16
 145              		.cfi_offset 4, -16
 146              		.cfi_offset 5, -12
 147              		.cfi_offset 6, -8
 148              		.cfi_offset 14, -4
 149 0004 0446     		mov	r4, r0
 203:controller/engine_cycle/ignition.c ****     {
 204:controller/engine_cycle/ignition.c ****         return;
 205:controller/engine_cycle/ignition.c ****     }
 206:controller/engine_cycle/ignition.c ****     
 207:controller/engine_cycle/ignition.c ****     uint8_t *coil_index = (uint8_t*)arg;
 150              		.loc 1 207 5 is_stmt 1 view .LVU32
 151              	.LVL10:
 208:controller/engine_cycle/ignition.c ****     if (coil_index[1] > IGNITION_MAX_OUTPUTS - 1)
 152              		.loc 1 208 5 view .LVU33
 153              		.loc 1 208 19 is_stmt 0 view .LVU34
 154 0006 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 155              		.loc 1 208 8 view .LVU35
 156 0008 032B     		cmp	r3, #3
 157 000a 1BD8     		bhi	.L18
 209:controller/engine_cycle/ignition.c ****     {
 210:controller/engine_cycle/ignition.c ****         log_error("Unkown ignition output");
 211:controller/engine_cycle/ignition.c ****         return;
 212:controller/engine_cycle/ignition.c ****     }
 213:controller/engine_cycle/ignition.c ****     
 214:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[0]] = IGNITION_COIL_STATE_NOT_CHARGING;
 158              		.loc 1 214 5 is_stmt 1 view .LVU36
 159              		.loc 1 214 35 is_stmt 0 view .LVU37
 160 000c 0278     		ldrb	r2, [r0]	@ zero_extendqisi2
 161              		.loc 1 214 40 view .LVU38
 162 000e 104B     		ldr	r3, .L19
 163 0010 0025     		movs	r5, #0
 164 0012 9D54     		strb	r5, [r3, r2]
 215:controller/engine_cycle/ignition.c ****     ignition_coil_state[coil_index[1]] = IGNITION_COIL_STATE_NOT_CHARGING;
 165              		.loc 1 215 5 is_stmt 1 view .LVU39
 166              		.loc 1 215 35 is_stmt 0 view .LVU40
 167 0014 4278     		ldrb	r2, [r0, #1]	@ zero_extendqisi2
 168              		.loc 1 215 40 view .LVU41
 169 0016 9D54     		strb	r5, [r3, r2]
 216:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[0]].gpio, ignition_outputs[coil_index[0]].pin, GP
 170              		.loc 1 216 5 is_stmt 1 view .LVU42
 171              		.loc 1 216 50 is_stmt 0 view .LVU43
 172 0018 0378     		ldrb	r3, [r0]	@ zero_extendqisi2
 173              		.loc 1 216 92 view .LVU44
 174 001a 0E4E     		ldr	r6, .L19+4
 175 001c 06EBC301 		add	r1, r6, r3, lsl #3
 176              		.loc 1 216 5 view .LVU45
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 8


 177 0020 2A46     		mov	r2, r5
 178 0022 8988     		ldrh	r1, [r1, #4]
 179 0024 56F83300 		ldr	r0, [r6, r3, lsl #3]
 180              	.LVL11:
 181              		.loc 1 216 5 view .LVU46
 182 0028 FFF7FEFF 		bl	HAL_GPIO_WritePin
 183              	.LVL12:
 217:controller/engine_cycle/ignition.c ****     HAL_GPIO_WritePin(ignition_outputs[coil_index[1]].gpio, ignition_outputs[coil_index[1]].pin, GP
 184              		.loc 1 217 5 is_stmt 1 view .LVU47
 185              		.loc 1 217 50 is_stmt 0 view .LVU48
 186 002c 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 187              		.loc 1 217 92 view .LVU49
 188 002e 06EBC301 		add	r1, r6, r3, lsl #3
 189              		.loc 1 217 5 view .LVU50
 190 0032 2A46     		mov	r2, r5
 191 0034 8988     		ldrh	r1, [r1, #4]
 192 0036 56F83300 		ldr	r0, [r6, r3, lsl #3]
 193 003a FFF7FEFF 		bl	HAL_GPIO_WritePin
 194              	.LVL13:
 218:controller/engine_cycle/ignition.c ****     spark_is_in_progress = false;
 195              		.loc 1 218 5 is_stmt 1 view .LVU51
 196              		.loc 1 218 26 is_stmt 0 view .LVU52
 197 003e 064B     		ldr	r3, .L19+8
 198 0040 1D70     		strb	r5, [r3]
 199              	.L11:
 219:controller/engine_cycle/ignition.c **** }
 200              		.loc 1 219 1 view .LVU53
 201 0042 70BD     		pop	{r4, r5, r6, pc}
 202              	.LVL14:
 203              	.L18:
 210:controller/engine_cycle/ignition.c ****         return;
 204              		.loc 1 210 9 is_stmt 1 view .LVU54
 205 0044 0548     		ldr	r0, .L19+12
 206              	.LVL15:
 210:controller/engine_cycle/ignition.c ****         return;
 207              		.loc 1 210 9 is_stmt 0 view .LVU55
 208 0046 FFF7FEFF 		bl	log_error
 209              	.LVL16:
 211:controller/engine_cycle/ignition.c ****     }
 210              		.loc 1 211 9 is_stmt 1 view .LVU56
 211 004a FAE7     		b	.L11
 212              	.LVL17:
 213              	.L15:
 214              		.cfi_def_cfa_offset 0
 215              		.cfi_restore 4
 216              		.cfi_restore 5
 217              		.cfi_restore 6
 218              		.cfi_restore 14
 211:controller/engine_cycle/ignition.c ****     }
 219              		.loc 1 211 9 is_stmt 0 view .LVU57
 220 004c 7047     		bx	lr
 221              	.L20:
 222 004e 00BF     		.align	2
 223              	.L19:
 224 0050 00000000 		.word	ignition_coil_state
 225 0054 00000000 		.word	ignition_outputs
 226 0058 00000000 		.word	spark_is_in_progress
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 9


 227 005c 00000000 		.word	.LC0
 228              		.cfi_endproc
 229              	.LFE234:
 231              		.section	.rodata.ignition_init.str1.4,"aMS",%progbits,1
 232              		.align	2
 233              	.LC1:
 234 0000 69676E69 		.ascii	"ignition init failed. No output config\000"
 234      74696F6E 
 234      20696E69 
 234      74206661 
 234      696C6564 
 235 0027 00       		.align	2
 236              	.LC2:
 237 0028 69676E69 		.ascii	"ignition init failed. unkown firing order.\000"
 237      74696F6E 
 237      20696E69 
 237      74206661 
 237      696C6564 
 238 0053 00       		.align	2
 239              	.LC3:
 240 0054 4D756C74 		.ascii	"Multi spark is enabled but number of sparks are 0.\000"
 240      69207370 
 240      61726B20 
 240      69732065 
 240      6E61626C 
 241              		.section	.text.ignition_init,"ax",%progbits
 242              		.align	1
 243              		.global	ignition_init
 244              		.syntax unified
 245              		.thumb
 246              		.thumb_func
 248              	ignition_init:
 249              	.LVL18:
 250              	.LFB230:
  13:controller/engine_cycle/ignition.c ****     if (output_conf == NULL)
 251              		.loc 1 13 1 is_stmt 1 view -0
 252              		.cfi_startproc
 253              		@ args = 0, pretend = 0, frame = 0
 254              		@ frame_needed = 0, uses_anonymous_args = 0
  13:controller/engine_cycle/ignition.c ****     if (output_conf == NULL)
 255              		.loc 1 13 1 is_stmt 0 view .LVU59
 256 0000 10B5     		push	{r4, lr}
 257              		.cfi_def_cfa_offset 8
 258              		.cfi_offset 4, -8
 259              		.cfi_offset 14, -4
  14:controller/engine_cycle/ignition.c ****     {
 260              		.loc 1 14 5 is_stmt 1 view .LVU60
  14:controller/engine_cycle/ignition.c ****     {
 261              		.loc 1 14 8 is_stmt 0 view .LVU61
 262 0002 90B1     		cbz	r0, .L32
 263 0004 0146     		mov	r1, r0
  21:controller/engine_cycle/ignition.c ****     {
 264              		.loc 1 21 5 is_stmt 1 view .LVU62
  21:controller/engine_cycle/ignition.c ****     {
 265              		.loc 1 21 26 is_stmt 0 view .LVU63
 266 0006 274B     		ldr	r3, .L33
 267 0008 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 10


  21:controller/engine_cycle/ignition.c ****     {
 268              		.loc 1 21 5 view .LVU64
 269 000a 93B9     		cbnz	r3, .L24
  24:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
 270              		.loc 1 24 13 is_stmt 1 view .LVU65
  24:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
 271              		.loc 1 24 35 is_stmt 0 view .LVU66
 272 000c 264A     		ldr	r2, .L33+4
 273 000e 0420     		movs	r0, #4
 274              	.LVL19:
  24:controller/engine_cycle/ignition.c ****             ignition_order[0] = 1;
 275              		.loc 1 24 35 view .LVU67
 276 0010 1074     		strb	r0, [r2, #16]
  25:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
 277              		.loc 1 25 13 is_stmt 1 view .LVU68
  25:controller/engine_cycle/ignition.c ****             ignition_order[1] = 3;
 278              		.loc 1 25 31 is_stmt 0 view .LVU69
 279 0012 264B     		ldr	r3, .L33+8
 280 0014 0124     		movs	r4, #1
 281 0016 1C70     		strb	r4, [r3]
  26:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
 282              		.loc 1 26 13 is_stmt 1 view .LVU70
  26:controller/engine_cycle/ignition.c ****             ignition_order[2] = 4;
 283              		.loc 1 26 31 is_stmt 0 view .LVU71
 284 0018 0324     		movs	r4, #3
 285 001a 5C70     		strb	r4, [r3, #1]
  27:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
 286              		.loc 1 27 13 is_stmt 1 view .LVU72
  27:controller/engine_cycle/ignition.c ****             ignition_order[3] = 2;
 287              		.loc 1 27 31 is_stmt 0 view .LVU73
 288 001c 9870     		strb	r0, [r3, #2]
  28:controller/engine_cycle/ignition.c ****         break;
 289              		.loc 1 28 13 is_stmt 1 view .LVU74
  28:controller/engine_cycle/ignition.c ****         break;
 290              		.loc 1 28 31 is_stmt 0 view .LVU75
 291 001e 0220     		movs	r0, #2
 292 0020 D870     		strb	r0, [r3, #3]
  29:controller/engine_cycle/ignition.c ****         
 293              		.loc 1 29 9 is_stmt 1 view .LVU76
  34:controller/engine_cycle/ignition.c ****     }
 294              		.loc 1 34 9 view .LVU77
  37:controller/engine_cycle/ignition.c **** 
 295              		.loc 1 37 5 view .LVU78
  37:controller/engine_cycle/ignition.c **** 
 296              		.loc 1 37 28 is_stmt 0 view .LVU79
 297 0022 234B     		ldr	r3, .L33+12
 298 0024 5361     		str	r3, [r2, #20]	@ float
  40:controller/engine_cycle/ignition.c ****     {
 299              		.loc 1 40 5 is_stmt 1 view .LVU80
 300              	.LBB9:
  40:controller/engine_cycle/ignition.c ****     {
 301              		.loc 1 40 10 view .LVU81
 302              	.LVL20:
  40:controller/engine_cycle/ignition.c ****     {
 303              		.loc 1 40 17 is_stmt 0 view .LVU82
 304 0026 0023     		movs	r3, #0
  40:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 11


 305              		.loc 1 40 5 view .LVU83
 306 0028 13E0     		b	.L25
 307              	.LVL21:
 308              	.L32:
  40:controller/engine_cycle/ignition.c ****     {
 309              		.loc 1 40 5 view .LVU84
 310              	.LBE9:
  16:controller/engine_cycle/ignition.c ****         return;
 311              		.loc 1 16 9 is_stmt 1 view .LVU85
 312 002a 2248     		ldr	r0, .L33+16
 313              	.LVL22:
  16:controller/engine_cycle/ignition.c ****         return;
 314              		.loc 1 16 9 is_stmt 0 view .LVU86
 315 002c FFF7FEFF 		bl	log_error
 316              	.LVL23:
  17:controller/engine_cycle/ignition.c ****     }
 317              		.loc 1 17 9 is_stmt 1 view .LVU87
 318 0030 02E0     		b	.L21
 319              	.LVL24:
 320              	.L24:
  32:controller/engine_cycle/ignition.c ****             return;
 321              		.loc 1 32 13 view .LVU88
 322 0032 2148     		ldr	r0, .L33+20
 323              	.LVL25:
  32:controller/engine_cycle/ignition.c ****             return;
 324              		.loc 1 32 13 is_stmt 0 view .LVU89
 325 0034 FFF7FEFF 		bl	log_error
 326              	.LVL26:
  33:controller/engine_cycle/ignition.c ****         break;
 327              		.loc 1 33 13 is_stmt 1 view .LVU90
 328              	.L21:
  61:controller/engine_cycle/ignition.c **** 
 329              		.loc 1 61 1 is_stmt 0 view .LVU91
 330 0038 10BD     		pop	{r4, pc}
 331              	.LVL27:
 332              	.L26:
 333              	.LBB10:
  42:controller/engine_cycle/ignition.c ****         ignition_outputs[i].pin = output_conf->output[i].pin;
 334              		.loc 1 42 9 is_stmt 1 view .LVU92
  42:controller/engine_cycle/ignition.c ****         ignition_outputs[i].pin = output_conf->output[i].pin;
 335              		.loc 1 42 58 is_stmt 0 view .LVU93
 336 003a 51F83300 		ldr	r0, [r1, r3, lsl #3]
  42:controller/engine_cycle/ignition.c ****         ignition_outputs[i].pin = output_conf->output[i].pin;
 337              		.loc 1 42 34 view .LVU94
 338 003e 1F4A     		ldr	r2, .L33+24
 339 0040 42F83300 		str	r0, [r2, r3, lsl #3]
  43:controller/engine_cycle/ignition.c ****     }
 340              		.loc 1 43 9 is_stmt 1 view .LVU95
  43:controller/engine_cycle/ignition.c ****     }
 341              		.loc 1 43 57 is_stmt 0 view .LVU96
 342 0044 01EBC300 		add	r0, r1, r3, lsl #3
 343 0048 4068     		ldr	r0, [r0, #4]
  43:controller/engine_cycle/ignition.c ****     }
 344              		.loc 1 43 33 view .LVU97
 345 004a 02EBC302 		add	r2, r2, r3, lsl #3
 346 004e 5060     		str	r0, [r2, #4]
  40:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 12


 347              		.loc 1 40 51 is_stmt 1 discriminator 3 view .LVU98
 348 0050 0133     		adds	r3, r3, #1
 349              	.LVL28:
 350              	.L25:
  40:controller/engine_cycle/ignition.c ****     {
 351              		.loc 1 40 26 discriminator 1 view .LVU99
 352 0052 032B     		cmp	r3, #3
 353 0054 F1D9     		bls	.L26
 354              	.LBE10:
 355              	.LBB11:
  46:controller/engine_cycle/ignition.c ****     {
 356              		.loc 1 46 17 is_stmt 0 view .LVU100
 357 0056 0024     		movs	r4, #0
 358 0058 08E0     		b	.L27
 359              	.LVL29:
 360              	.L28:
  48:controller/engine_cycle/ignition.c ****     }
 361              		.loc 1 48 9 is_stmt 1 view .LVU101
  48:controller/engine_cycle/ignition.c ****     }
 362              		.loc 1 48 93 is_stmt 0 view .LVU102
 363 005a 184B     		ldr	r3, .L33+24
  48:controller/engine_cycle/ignition.c ****     }
 364              		.loc 1 48 34 view .LVU103
 365 005c 9988     		ldrh	r1, [r3, #4]
 366 005e 53F83400 		ldr	r0, [r3, r4, lsl #3]
 367 0062 FFF7FEFF 		bl	HAL_GPIO_ReadPin
 368              	.LVL30:
  48:controller/engine_cycle/ignition.c ****     }
 369              		.loc 1 48 32 discriminator 1 view .LVU104
 370 0066 164B     		ldr	r3, .L33+28
 371 0068 1855     		strb	r0, [r3, r4]
  46:controller/engine_cycle/ignition.c ****     {
 372              		.loc 1 46 51 is_stmt 1 discriminator 3 view .LVU105
 373 006a 0134     		adds	r4, r4, #1
 374              	.LVL31:
 375              	.L27:
  46:controller/engine_cycle/ignition.c ****     {
 376              		.loc 1 46 26 discriminator 1 view .LVU106
 377 006c 032C     		cmp	r4, #3
 378 006e F4D9     		bls	.L28
 379              	.LBE11:
 380              	.LBB12:
  51:controller/engine_cycle/ignition.c ****     {
 381              		.loc 1 51 17 is_stmt 0 view .LVU107
 382 0070 0024     		movs	r4, #0
 383              	.LVL32:
  51:controller/engine_cycle/ignition.c ****     {
 384              		.loc 1 51 17 view .LVU108
 385 0072 07E0     		b	.L29
 386              	.LVL33:
 387              	.L30:
  53:controller/engine_cycle/ignition.c ****     }
 388              		.loc 1 53 9 is_stmt 1 view .LVU109
  53:controller/engine_cycle/ignition.c ****     }
 389              		.loc 1 53 69 is_stmt 0 view .LVU110
 390 0074 114B     		ldr	r3, .L33+24
  53:controller/engine_cycle/ignition.c ****     }
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 13


 391              		.loc 1 53 9 view .LVU111
 392 0076 0022     		movs	r2, #0
 393 0078 9988     		ldrh	r1, [r3, #4]
 394 007a 53F83400 		ldr	r0, [r3, r4, lsl #3]
 395 007e FFF7FEFF 		bl	HAL_GPIO_WritePin
 396              	.LVL34:
  51:controller/engine_cycle/ignition.c ****     {
 397              		.loc 1 51 51 is_stmt 1 discriminator 3 view .LVU112
 398 0082 0134     		adds	r4, r4, #1
 399              	.LVL35:
 400              	.L29:
  51:controller/engine_cycle/ignition.c ****     {
 401              		.loc 1 51 26 discriminator 1 view .LVU113
 402 0084 032C     		cmp	r4, #3
 403 0086 F5D9     		bls	.L30
 404              	.LBE12:
  56:controller/engine_cycle/ignition.c ****     {
 405              		.loc 1 56 5 view .LVU114
  56:controller/engine_cycle/ignition.c ****     {
 406              		.loc 1 56 22 is_stmt 0 view .LVU115
 407 0088 064B     		ldr	r3, .L33
 408 008a 93F82030 		ldrb	r3, [r3, #32]	@ zero_extendqisi2
  56:controller/engine_cycle/ignition.c ****     {
 409              		.loc 1 56 8 view .LVU116
 410 008e 002B     		cmp	r3, #0
 411 0090 D2D0     		beq	.L21
  56:controller/engine_cycle/ignition.c ****     {
 412              		.loc 1 56 51 discriminator 1 view .LVU117
 413 0092 044B     		ldr	r3, .L33
 414 0094 93F82130 		ldrb	r3, [r3, #33]	@ zero_extendqisi2
  56:controller/engine_cycle/ignition.c ****     {
 415              		.loc 1 56 47 discriminator 1 view .LVU118
 416 0098 082B     		cmp	r3, #8
 417 009a CDD9     		bls	.L21
  58:controller/engine_cycle/ignition.c ****     }
 418              		.loc 1 58 9 is_stmt 1 view .LVU119
 419 009c 0948     		ldr	r0, .L33+32
 420 009e FFF7FEFF 		bl	log_warning
 421              	.LVL36:
 422 00a2 C9E7     		b	.L21
 423              	.L34:
 424              		.align	2
 425              	.L33:
 426 00a4 00000000 		.word	configuration
 427 00a8 00000000 		.word	engine
 428 00ac 00000000 		.word	ignition_order
 429 00b0 00003443 		.word	1127481344
 430 00b4 00000000 		.word	.LC1
 431 00b8 28000000 		.word	.LC2
 432 00bc 00000000 		.word	ignition_outputs
 433 00c0 00000000 		.word	ignition_coil_state
 434 00c4 54000000 		.word	.LC3
 435              		.cfi_endproc
 436              	.LFE230:
 438              		.section	.rodata.ignition_trigger_event_handle.str1.4,"aMS",%progbits,1
 439              		.align	2
 440              	.LC4:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 14


 441 0000 69676E69 		.ascii	"ignition not initialized.\000"
 441      74696F6E 
 441      206E6F74 
 441      20696E69 
 441      7469616C 
 442 001a 0000     		.align	2
 443              	.LC5:
 444 001c 69676E69 		.ascii	"ignition dwell out of bounds.\000"
 444      74696F6E 
 444      20647765 
 444      6C6C206F 
 444      7574206F 
 445              		.section	.text.ignition_trigger_event_handle,"ax",%progbits
 446              		.align	1
 447              		.global	ignition_trigger_event_handle
 448              		.syntax unified
 449              		.thumb
 450              		.thumb_func
 452              	ignition_trigger_event_handle:
 453              	.LVL37:
 454              	.LFB231:
  71:controller/engine_cycle/ignition.c ****     /**
 455              		.loc 1 71 1 view -0
 456              		.cfi_startproc
 457              		@ args = 0, pretend = 0, frame = 16
 458              		@ frame_needed = 0, uses_anonymous_args = 0
  71:controller/engine_cycle/ignition.c ****     /**
 459              		.loc 1 71 1 is_stmt 0 view .LVU121
 460 0000 30B5     		push	{r4, r5, lr}
 461              		.cfi_def_cfa_offset 12
 462              		.cfi_offset 4, -12
 463              		.cfi_offset 5, -8
 464              		.cfi_offset 14, -4
 465 0002 85B0     		sub	sp, sp, #20
 466              		.cfi_def_cfa_offset 32
  75:controller/engine_cycle/ignition.c ****     {
 467              		.loc 1 75 5 is_stmt 1 view .LVU122
  75:controller/engine_cycle/ignition.c ****     {
 468              		.loc 1 75 15 is_stmt 0 view .LVU123
 469 0004 5D4B     		ldr	r3, .L52
 470 0006 D3ED057A 		vldr.32	s15, [r3, #20]
  75:controller/engine_cycle/ignition.c ****     {
 471              		.loc 1 75 8 view .LVU124
 472 000a F5EE407A 		vcmp.f32	s15, #0
 473 000e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 474 0012 00F0A480 		beq	.L51
  81:controller/engine_cycle/ignition.c ****     {
 475              		.loc 1 81 5 is_stmt 1 view .LVU125
  81:controller/engine_cycle/ignition.c ****     {
 476              		.loc 1 81 22 is_stmt 0 view .LVU126
 477 0016 5A4B     		ldr	r3, .L52+4
 478 0018 1B7E     		ldrb	r3, [r3, #24]	@ zero_extendqisi2
  81:controller/engine_cycle/ignition.c ****     {
 479              		.loc 1 81 8 view .LVU127
 480 001a 002B     		cmp	r3, #0
 481 001c 00F0A680 		beq	.L35
  87:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 15


 482              		.loc 1 87 5 is_stmt 1 view .LVU128
  87:controller/engine_cycle/ignition.c ****     {
 483              		.loc 1 87 10 is_stmt 0 view .LVU129
 484 0020 574B     		ldr	r3, .L52+4
 485 0022 93ED077A 		vldr.32	s14, [r3, #28]
  87:controller/engine_cycle/ignition.c ****     {
 486              		.loc 1 87 8 view .LVU130
 487 0026 F6EE006A 		vmov.f32	s13, #5.0e-1
 488 002a B4EEE67A 		vcmpe.f32	s14, s13
 489 002e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 490 0032 C0F29880 		blt	.L38
  87:controller/engine_cycle/ignition.c ****     {
 491              		.loc 1 87 9 discriminator 1 view .LVU131
 492 0036 F1EE006A 		vmov.f32	s13, #4.0e+0
 493 003a B4EEE67A 		vcmpe.f32	s14, s13
 494 003e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 495 0042 00F29080 		bhi	.L38
  96:controller/engine_cycle/ignition.c **** 
 496              		.loc 1 96 5 is_stmt 1 view .LVU132
 497              	.LVL38:
  98:controller/engine_cycle/ignition.c ****     #ifdef TEST_MODE
 498              		.loc 1 98 5 view .LVU133
 100:controller/engine_cycle/ignition.c ****     #else
 499              		.loc 1 100 5 view .LVU134
 105:controller/engine_cycle/ignition.c ****     
 500              		.loc 1 105 5 view .LVU135
 107:controller/engine_cycle/ignition.c ****     if (configuration.ignition_is_multi_spark && rpm < configuration.ignition_multi_spark_rpm_thres
 501              		.loc 1 107 5 view .LVU136
 108:controller/engine_cycle/ignition.c ****     {
 502              		.loc 1 108 5 view .LVU137
 110:controller/engine_cycle/ignition.c ****     }
 503              		.loc 1 110 9 view .LVU138
 115:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)engine.firing_interval;
 504              		.loc 1 115 5 view .LVU139
 115:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)engine.firing_interval;
 505              		.loc 1 115 48 is_stmt 0 view .LVU140
 506 0046 C0EE276A 		vdiv.f32	s13, s0, s15
 115:controller/engine_cycle/ignition.c ****     uint8_t phase_count = (uint8_t)(angle_t)360 / (angle_t)engine.firing_interval;
 507              		.loc 1 115 13 view .LVU141
 508 004a FCEEE66A 		vcvt.u32.f32	s13, s13
 509 004e CDED016A 		vstr.32	s13, [sp, #4]	@ int
 510 0052 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
 511              	.LVL39:
 116:controller/engine_cycle/ignition.c **** 
 512              		.loc 1 116 5 is_stmt 1 view .LVU142
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
 513              		.loc 1 118 5 view .LVU143
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
 514              		.loc 1 118 47 is_stmt 0 view .LVU144
 515 0056 06EE903A 		vmov	s13, r3	@ int
 516 005a F8EEE66A 		vcvt.f32.s32	s13, s13
 517 005e 66EEA76A 		vmul.f32	s13, s13, s15
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
 518              		.loc 1 118 72 view .LVU145
 519 0062 B3EE0E6A 		vmov.f32	s12, #3.0e+1
 520 0066 76EEC66A 		vsub.f32	s13, s13, s12
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 16


 521              		.loc 1 118 88 view .LVU146
 522 006a 77EEA67A 		vadd.f32	s15, s15, s13
 523              	.LVL40:
 118:controller/engine_cycle/ignition.c ****     volatile angle_t next_dwell_angle = next_spark_angle - (float)configuration.ignition_dwell * (f
 524              		.loc 1 118 22 view .LVU147
 525 006e CDED037A 		vstr.32	s15, [sp, #12]
 119:controller/engine_cycle/ignition.c ****     
 526              		.loc 1 119 5 is_stmt 1 view .LVU148
 119:controller/engine_cycle/ignition.c ****     
 527              		.loc 1 119 58 is_stmt 0 view .LVU149
 528 0072 DDED037A 		vldr.32	s15, [sp, #12]
 119:controller/engine_cycle/ignition.c ****     
 529              		.loc 1 119 96 view .LVU150
 530 0076 DFED436A 		vldr.32	s13, .L52+8
 531 007a 27EE267A 		vmul.f32	s14, s14, s13
 532              	.LVL41:
 533              	.LBB13:
 534              	.LBI13:
 535              		.file 2 "controller/utils/utils.h"
   1:controller/utils/utils.h **** /**
   2:controller/utils/utils.h ****  * @file utils.h
   3:controller/utils/utils.h ****  * @brief Header file containing utility functions and definitions for the smart generator controll
   4:controller/utils/utils.h ****  * 
   5:controller/utils/utils.h ****  * This file provides declarations for utility functions and macros that are
   6:controller/utils/utils.h ****  * used throughout the firmware to support various functionalities.
   7:controller/utils/utils.h ****  * 
   8:controller/utils/utils.h ****  * @note Ensure that this file is included wherever utility functions are required.
   9:controller/utils/utils.h ****  */
  10:controller/utils/utils.h **** #ifndef UTILS_H
  11:controller/utils/utils.h **** #define UTILS_H
  12:controller/utils/utils.h **** 
  13:controller/utils/utils.h **** #include "types.h"
  14:controller/utils/utils.h **** #include "math.h"
  15:controller/utils/utils.h **** #define IS_IN_RANGE(value, min, max) ((value) >= (min) && (value) <= (max))
  16:controller/utils/utils.h **** #define ABS(value) ((value) < 0 ? -(value) : (value))
  17:controller/utils/utils.h **** #define CLAMP(value, min, max) ((value) < (min) ? (min) : ((value) > (max) ? (max) : (value)))
  18:controller/utils/utils.h **** 
  19:controller/utils/utils.h **** void change_bit_uint32(uint32_t *var, uint8_t bit_index, bool state);
  20:controller/utils/utils.h **** 
  21:controller/utils/utils.h **** /**
  22:controller/utils/utils.h ****  * @brief Maps a value from one range to another.
  23:controller/utils/utils.h ****  * 
  24:controller/utils/utils.h ****  * @param x The value to map.
  25:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  26:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  27:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  28:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  29:controller/utils/utils.h ****  * @return The mapped value in the output range.
  30:controller/utils/utils.h ****  */
  31:controller/utils/utils.h **** #define MAP(x, in_min, in_max, out_min, out_max) \
  32:controller/utils/utils.h ****     (((x) - (in_min)) * ((out_max) - (out_min)) / ((in_max) - (in_min)) + (out_min))
  33:controller/utils/utils.h **** 
  34:controller/utils/utils.h **** 
  35:controller/utils/utils.h **** /**
  36:controller/utils/utils.h ****  * @brief Maps a uint16_t value from one range to another.
  37:controller/utils/utils.h ****  * 
  38:controller/utils/utils.h ****  * @param x The value to map.
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 17


  39:controller/utils/utils.h ****  * @param in_min The lower bound of the input range.
  40:controller/utils/utils.h ****  * @param in_max The upper bound of the input range.
  41:controller/utils/utils.h ****  * @param out_min The lower bound of the output range.
  42:controller/utils/utils.h ****  * @param out_max The upper bound of the output range.
  43:controller/utils/utils.h ****  * @return The mapped value in the output range.
  44:controller/utils/utils.h ****  */
  45:controller/utils/utils.h **** static inline uint16_t map_uint16(uint16_t x, uint16_t in_min, uint16_t in_max, uint16_t out_min, u
  46:controller/utils/utils.h **** {
  47:controller/utils/utils.h ****     if (in_max == in_min)
  48:controller/utils/utils.h ****     {
  49:controller/utils/utils.h ****         return 0; // Avoid division by zero
  50:controller/utils/utils.h ****     }
  51:controller/utils/utils.h ****     return (uint16_t)((x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min);
  52:controller/utils/utils.h **** }
  53:controller/utils/utils.h **** 
  54:controller/utils/utils.h **** static inline float mapf(float x, float in_min, float in_max, float out_min, float out_max)
  55:controller/utils/utils.h **** {
  56:controller/utils/utils.h ****     if (in_max == in_min)
  57:controller/utils/utils.h ****     {
  58:controller/utils/utils.h ****         return 0.0f; // Avoid division by zero
  59:controller/utils/utils.h ****     }
  60:controller/utils/utils.h ****     return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
  61:controller/utils/utils.h **** }
  62:controller/utils/utils.h **** 
  63:controller/utils/utils.h **** // http://en.wikipedia.org/wiki/Endianness
  64:controller/utils/utils.h **** inline uint16_t swap_endian_uint16(uint16_t x)
  65:controller/utils/utils.h **** {
  66:controller/utils/utils.h **** 	return ((x << 8) | (x >> 8));
  67:controller/utils/utils.h **** }
  68:controller/utils/utils.h **** inline uint32_t swap_endian_uint32(uint32_t x)
  69:controller/utils/utils.h **** {
  70:controller/utils/utils.h **** 	return (((x >> 24) & 0x000000ff) | ((x <<  8) & 0x00ff0000) |
  71:controller/utils/utils.h **** 			((x >>  8) & 0x0000ff00) | ((x << 24) & 0xff000000));
  72:controller/utils/utils.h **** }
  73:controller/utils/utils.h **** 
  74:controller/utils/utils.h **** void swap_endian_copy_uint8(uint8_t *dst, const uint8_t *src, size_t size);
  75:controller/utils/utils.h **** 
  76:controller/utils/utils.h **** #define CELSIUS_TO_KELVIN(celsius) ((celsius) + 273.15f)
  77:controller/utils/utils.h **** #define KELVIN_TO_CELSIUS(kelvin) ((kelvin) - 273.15f)
  78:controller/utils/utils.h **** 
  79:controller/utils/utils.h **** /**
  80:controller/utils/utils.h ****  * @brief Function to calculate the microseconds it takes for the engine to turn one degree.
  81:controller/utils/utils.h ****  * @note Returns 0 if rpm is 0.
  82:controller/utils/utils.h ****  */
  83:controller/utils/utils.h **** static inline time_us_t microseconds_per_degree(rpm_t rpm)
  84:controller/utils/utils.h **** {
  85:controller/utils/utils.h ****     if (rpm == 0)
  86:controller/utils/utils.h ****     {
  87:controller/utils/utils.h ****         return 0;
  88:controller/utils/utils.h ****     }
  89:controller/utils/utils.h ****     return (time_us_t) 60.0f * 1e6f / (rpm * 360.0f);
  90:controller/utils/utils.h **** }
  91:controller/utils/utils.h **** 
  92:controller/utils/utils.h **** /**
  93:controller/utils/utils.h ****  * @brief Function to calculate the degrees the engine turns in one microsecond.
  94:controller/utils/utils.h ****  * @note Returns 0 if rpm is 0.
  95:controller/utils/utils.h ****  */
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 18


  96:controller/utils/utils.h **** static inline angle_t degrees_per_microsecond(rpm_t rpm)
 536              		.loc 2 96 23 is_stmt 1 view .LVU151
 537              	.LBB14:
  97:controller/utils/utils.h **** {
  98:controller/utils/utils.h ****     if (rpm == 0)
 538              		.loc 2 98 5 view .LVU152
 539              		.loc 2 98 8 is_stmt 0 view .LVU153
 540 007e F5EE400A 		vcmp.f32	s1, #0
 541 0082 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 542 0086 73D0     		beq	.L45
  99:controller/utils/utils.h ****     {
 100:controller/utils/utils.h ****         return 0.0f;
 101:controller/utils/utils.h ****     }
 102:controller/utils/utils.h ****     return (angle_t)(rpm * 360.0f) / (60.0f * 1e6f);
 543              		.loc 2 102 5 is_stmt 1 view .LVU154
 544              		.loc 2 102 12 is_stmt 0 view .LVU155
 545 0088 DFED3F6A 		vldr.32	s13, .L52+12
 546 008c 60EEA66A 		vmul.f32	s13, s1, s13
 547              		.loc 2 102 36 view .LVU156
 548 0090 DFED3E5A 		vldr.32	s11, .L52+16
 549 0094 86EEA56A 		vdiv.f32	s12, s13, s11
 550              	.L41:
 551              	.LVL42:
 552              		.loc 2 102 36 view .LVU157
 553              	.LBE14:
 554              	.LBE13:
 119:controller/engine_cycle/ignition.c ****     
 555              		.loc 1 119 110 discriminator 1 view .LVU158
 556 0098 27EE067A 		vmul.f32	s14, s14, s12
 119:controller/engine_cycle/ignition.c ****     
 557              		.loc 1 119 58 discriminator 1 view .LVU159
 558 009c 77EEC77A 		vsub.f32	s15, s15, s14
 119:controller/engine_cycle/ignition.c ****     
 559              		.loc 1 119 22 discriminator 1 view .LVU160
 560 00a0 CDED027A 		vstr.32	s15, [sp, #8]
 121:controller/engine_cycle/ignition.c **** 
 561              		.loc 1 121 5 is_stmt 1 view .LVU161
 123:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 562              		.loc 1 123 5 view .LVU162
 123:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 563              		.loc 1 123 46 is_stmt 0 view .LVU163
 564 00a4 3A4C     		ldr	r4, .L52+20
 565 00a6 E25C     		ldrb	r2, [r4, r3]	@ zero_extendqisi2
 123:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 566              		.loc 1 123 54 view .LVU164
 567 00a8 013A     		subs	r2, r2, #1
 568 00aa D2B2     		uxtb	r2, r2
 123:controller/engine_cycle/ignition.c ****     next_firing_cylinders[1] = ignition_order[phase] - 1;
 569              		.loc 1 123 30 view .LVU165
 570 00ac 3949     		ldr	r1, .L52+24
 571 00ae 0A70     		strb	r2, [r1]
 124:controller/engine_cycle/ignition.c **** 
 572              		.loc 1 124 5 is_stmt 1 view .LVU166
 124:controller/engine_cycle/ignition.c **** 
 573              		.loc 1 124 30 is_stmt 0 view .LVU167
 574 00b0 4A70     		strb	r2, [r1, #1]
 126:controller/engine_cycle/ignition.c ****     {
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 19


 575              		.loc 1 126 5 is_stmt 1 view .LVU168
 128:controller/engine_cycle/ignition.c ****         
 576              		.loc 1 128 9 view .LVU169
 128:controller/engine_cycle/ignition.c ****         
 577              		.loc 1 128 57 is_stmt 0 view .LVU170
 578 00b2 0233     		adds	r3, r3, #2
 579              	.LVL43:
 128:controller/engine_cycle/ignition.c ****         
 580              		.loc 1 128 50 view .LVU171
 581 00b4 E35C     		ldrb	r3, [r4, r3]	@ zero_extendqisi2
 582              	.LVL44:
 128:controller/engine_cycle/ignition.c ****         
 583              		.loc 1 128 62 view .LVU172
 584 00b6 013B     		subs	r3, r3, #1
 128:controller/engine_cycle/ignition.c ****         
 585              		.loc 1 128 34 view .LVU173
 586 00b8 4B70     		strb	r3, [r1, #1]
 133:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 587              		.loc 1 133 5 is_stmt 1 view .LVU174
 133:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 588              		.loc 1 133 36 is_stmt 0 view .LVU175
 589 00ba 304B     		ldr	r3, .L52
 590              	.LVL45:
 133:controller/engine_cycle/ignition.c ****     if (is_synced && (next_dwell_angle - crankshaft_angle) < 10 && !spark_is_in_progress && (next_d
 591              		.loc 1 133 36 view .LVU176
 592 00bc 5B7F     		ldrb	r3, [r3, #29]	@ zero_extendqisi2
 593              	.LVL46:
 134:controller/engine_cycle/ignition.c ****     {
 594              		.loc 1 134 5 is_stmt 1 view .LVU177
 134:controller/engine_cycle/ignition.c ****     {
 595              		.loc 1 134 8 is_stmt 0 view .LVU178
 596 00be 012B     		cmp	r3, #1
 597 00c0 54D1     		bne	.L35
 134:controller/engine_cycle/ignition.c ****     {
 598              		.loc 1 134 40 discriminator 1 view .LVU179
 599 00c2 DDED027A 		vldr.32	s15, [sp, #8]
 600 00c6 77EEC07A 		vsub.f32	s15, s15, s0
 134:controller/engine_cycle/ignition.c ****     {
 601              		.loc 1 134 19 discriminator 1 view .LVU180
 602 00ca B2EE047A 		vmov.f32	s14, #1.0e+1
 603 00ce F4EEC77A 		vcmpe.f32	s15, s14
 604 00d2 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 605 00d6 49D5     		bpl	.L35
 134:controller/engine_cycle/ignition.c ****     {
 606              		.loc 1 134 68 discriminator 2 view .LVU181
 607 00d8 2F4B     		ldr	r3, .L52+28
 608 00da 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 134:controller/engine_cycle/ignition.c ****     {
 609              		.loc 1 134 65 discriminator 2 view .LVU182
 610 00dc 002B     		cmp	r3, #0
 611 00de 45D1     		bne	.L35
 134:controller/engine_cycle/ignition.c ****     {
 612              		.loc 1 134 111 discriminator 3 view .LVU183
 613 00e0 DDED027A 		vldr.32	s15, [sp, #8]
 614 00e4 77EEC07A 		vsub.f32	s15, s15, s0
 134:controller/engine_cycle/ignition.c ****     {
 615              		.loc 1 134 90 discriminator 3 view .LVU184
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 20


 616 00e8 F5EEC07A 		vcmpe.f32	s15, #0
 617 00ec F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 618 00f0 3CDD     		ble	.L35
 619              	.LBB16:
 137:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 620              		.loc 1 137 9 is_stmt 1 view .LVU185
 137:controller/engine_cycle/ignition.c ****         time_us_t dwell_start_time_us = current_time_us + (time_us_t)((next_dwell_angle - crankshaf
 621              		.loc 1 137 30 is_stmt 0 view .LVU186
 622 00f2 294B     		ldr	r3, .L52+28
 623 00f4 0122     		movs	r2, #1
 624 00f6 1A70     		strb	r2, [r3]
 138:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 625              		.loc 1 138 9 is_stmt 1 view .LVU187
 138:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 626              		.loc 1 138 89 is_stmt 0 view .LVU188
 627 00f8 9DED027A 		vldr.32	s14, [sp, #8]
 628 00fc 37EE407A 		vsub.f32	s14, s14, s0
 629              	.LVL47:
 630              	.LBB17:
 631              	.LBI17:
  83:controller/utils/utils.h **** {
 632              		.loc 2 83 25 is_stmt 1 view .LVU189
 633              	.LBB18:
  85:controller/utils/utils.h ****     {
 634              		.loc 2 85 5 view .LVU190
  85:controller/utils/utils.h ****     {
 635              		.loc 2 85 8 is_stmt 0 view .LVU191
 636 0100 F5EE400A 		vcmp.f32	s1, #0
 637 0104 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 638 0108 35D0     		beq	.L46
  89:controller/utils/utils.h **** }
 639              		.loc 2 89 5 is_stmt 1 view .LVU192
  89:controller/utils/utils.h **** }
 640              		.loc 2 89 44 is_stmt 0 view .LVU193
 641 010a DFED1F7A 		vldr.32	s15, .L52+12
 642 010e 60EEA70A 		vmul.f32	s1, s1, s15
 643              	.LVL48:
  89:controller/utils/utils.h **** }
 644              		.loc 2 89 37 view .LVU194
 645 0112 DFED1E6A 		vldr.32	s13, .L52+16
 646 0116 C6EEA07A 		vdiv.f32	s15, s13, s1
 647 011a FCEEE77A 		vcvt.u32.f32	s15, s15
 648              	.L44:
 649              	.LVL49:
  89:controller/utils/utils.h **** }
 650              		.loc 2 89 37 view .LVU195
 651              	.LBE18:
 652              	.LBE17:
 138:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 653              		.loc 1 138 109 discriminator 1 view .LVU196
 654 011e F8EE677A 		vcvt.f32.u32	s15, s15
 655 0122 27EE277A 		vmul.f32	s14, s14, s15
 138:controller/engine_cycle/ignition.c ****         time_us_t spark_start_time_us = current_time_us + (time_us_t)((next_spark_angle - crankshaf
 656              		.loc 1 138 59 discriminator 1 view .LVU197
 657 0126 BCEEC77A 		vcvt.u32.f32	s14, s14
 658              	.LVL50:
 139:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 21


 659              		.loc 1 139 9 is_stmt 1 view .LVU198
 139:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
 660              		.loc 1 139 89 is_stmt 0 view .LVU199
 661 012a DDED036A 		vldr.32	s13, [sp, #12]
 662 012e 76EEC06A 		vsub.f32	s13, s13, s0
 139:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
 663              		.loc 1 139 109 discriminator 1 view .LVU200
 664 0132 67EEA67A 		vmul.f32	s15, s15, s13
 139:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
 665              		.loc 1 139 59 discriminator 1 view .LVU201
 666 0136 FCEEE77A 		vcvt.u32.f32	s15, s15
 139:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(dwell_start_time_us, ignition_coil_begin_charge, (void*)n
 667              		.loc 1 139 19 discriminator 1 view .LVU202
 668 013a 17EE904A 		vmov	r4, s15	@ int
 669 013e 0444     		add	r4, r4, r0
 670              	.LVL51:
 140:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void*)nex
 671              		.loc 1 140 9 is_stmt 1 view .LVU203
 672 0140 144D     		ldr	r5, .L52+24
 673 0142 2A46     		mov	r2, r5
 674 0144 1549     		ldr	r1, .L52+32
 675 0146 17EE103A 		vmov	r3, s14	@ int
 676 014a 0344     		add	r3, r3, r0
 677              	.LVL52:
 140:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void*)nex
 678              		.loc 1 140 9 is_stmt 0 view .LVU204
 679 014c 1846     		mov	r0, r3
 680              	.LVL53:
 140:controller/engine_cycle/ignition.c ****         scheduler_schedule_event_with_arg(spark_start_time_us, ignition_coil_fire_spark, (void*)nex
 681              		.loc 1 140 9 view .LVU205
 682 014e FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 683              	.LVL54:
 141:controller/engine_cycle/ignition.c **** 
 684              		.loc 1 141 9 is_stmt 1 view .LVU206
 685 0152 2A46     		mov	r2, r5
 686 0154 1249     		ldr	r1, .L52+36
 687 0156 2046     		mov	r0, r4
 688 0158 FFF7FEFF 		bl	scheduler_schedule_event_with_arg
 689              	.LVL55:
 690 015c 06E0     		b	.L35
 691              	.LVL56:
 692              	.L51:
 141:controller/engine_cycle/ignition.c **** 
 693              		.loc 1 141 9 is_stmt 0 view .LVU207
 694              	.LBE16:
  77:controller/engine_cycle/ignition.c ****         return;
 695              		.loc 1 77 9 is_stmt 1 view .LVU208
 696 015e 1148     		ldr	r0, .L52+40
 697              	.LVL57:
  77:controller/engine_cycle/ignition.c ****         return;
 698              		.loc 1 77 9 is_stmt 0 view .LVU209
 699 0160 FFF7FEFF 		bl	log_error
 700              	.LVL58:
  78:controller/engine_cycle/ignition.c ****     }
 701              		.loc 1 78 9 is_stmt 1 view .LVU210
 702 0164 02E0     		b	.L35
 703              	.LVL59:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 22


 704              	.L38:
  92:controller/engine_cycle/ignition.c ****         return;
 705              		.loc 1 92 9 view .LVU211
 706 0166 1048     		ldr	r0, .L52+44
 707              	.LVL60:
  92:controller/engine_cycle/ignition.c ****         return;
 708              		.loc 1 92 9 is_stmt 0 view .LVU212
 709 0168 FFF7FEFF 		bl	log_error
 710              	.LVL61:
  93:controller/engine_cycle/ignition.c ****     }
 711              		.loc 1 93 9 is_stmt 1 view .LVU213
 712              	.L35:
 145:controller/engine_cycle/ignition.c **** 
 713              		.loc 1 145 1 is_stmt 0 view .LVU214
 714 016c 05B0     		add	sp, sp, #20
 715              		.cfi_remember_state
 716              		.cfi_def_cfa_offset 12
 717              		@ sp needed
 718 016e 30BD     		pop	{r4, r5, pc}
 719              	.LVL62:
 720              	.L45:
 721              		.cfi_restore_state
 722              	.LBB21:
 723              	.LBB15:
 100:controller/utils/utils.h ****     }
 724              		.loc 2 100 16 view .LVU215
 725 0170 9FED0E6A 		vldr.32	s12, .L52+48
 726 0174 90E7     		b	.L41
 727              	.LVL63:
 728              	.L46:
 100:controller/utils/utils.h ****     }
 729              		.loc 2 100 16 view .LVU216
 730              	.LBE15:
 731              	.LBE21:
 732              	.LBB22:
 733              	.LBB20:
 734              	.LBB19:
  87:controller/utils/utils.h ****     }
 735              		.loc 2 87 16 view .LVU217
 736 0176 DFED0E7A 		vldr.32	s15, .L52+52	@ int
 737 017a D0E7     		b	.L44
 738              	.L53:
 739              		.align	2
 740              	.L52:
 741 017c 00000000 		.word	engine
 742 0180 00000000 		.word	configuration
 743 0184 00007A44 		.word	1148846080
 744 0188 0000B443 		.word	1135869952
 745 018c C0E1644C 		.word	1281679808
 746 0190 00000000 		.word	ignition_order
 747 0194 00000000 		.word	next_firing_cylinders.0
 748 0198 00000000 		.word	spark_is_in_progress
 749 019c 00000000 		.word	ignition_coil_begin_charge
 750 01a0 00000000 		.word	ignition_coil_fire_spark
 751 01a4 00000000 		.word	.LC4
 752 01a8 1C000000 		.word	.LC5
 753 01ac 00000000 		.word	0
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 23


 754 01b0 00000000 		.word	0
 755              	.LBE19:
 756              	.LBE20:
 757              	.LBE22:
 758              		.cfi_endproc
 759              	.LFE231:
 761              		.section	.rodata.ignition_get_number_of_sparks_per_coil.str1.4,"aMS",%progbits,1
 762              		.align	2
 763              	.LC6:
 764 0000 556E6B6F 		.ascii	"Unkown ignition mode\000"
 764      776E2069 
 764      676E6974 
 764      696F6E20 
 764      6D6F6465 
 765              		.section	.text.ignition_get_number_of_sparks_per_coil,"ax",%progbits
 766              		.align	1
 767              		.global	ignition_get_number_of_sparks_per_coil
 768              		.syntax unified
 769              		.thumb
 770              		.thumb_func
 772              	ignition_get_number_of_sparks_per_coil:
 773              	.LVL64:
 774              	.LFB232:
 155:controller/engine_cycle/ignition.c ****     switch (ignition_mode)
 775              		.loc 1 155 1 is_stmt 1 view -0
 776              		.cfi_startproc
 777              		@ args = 0, pretend = 0, frame = 0
 778              		@ frame_needed = 0, uses_anonymous_args = 0
 156:controller/engine_cycle/ignition.c ****     {
 779              		.loc 1 156 5 view .LVU219
 780 0000 0228     		cmp	r0, #2
 781 0002 0CD0     		beq	.L57
 782 0004 0328     		cmp	r0, #3
 783 0006 0CD0     		beq	.L58
 155:controller/engine_cycle/ignition.c ****     switch (ignition_mode)
 784              		.loc 1 155 1 is_stmt 0 view .LVU220
 785 0008 08B5     		push	{r3, lr}
 786              		.cfi_def_cfa_offset 8
 787              		.cfi_offset 3, -8
 788              		.cfi_offset 14, -4
 156:controller/engine_cycle/ignition.c ****     {
 789              		.loc 1 156 5 view .LVU221
 790 000a 0128     		cmp	r0, #1
 791 000c 02D1     		bne	.L56
 159:controller/engine_cycle/ignition.c ****     case IM_INDIVIDUAL_COILS:
 792              		.loc 1 159 9 is_stmt 1 view .LVU222
 159:controller/engine_cycle/ignition.c ****     case IM_INDIVIDUAL_COILS:
 793              		.loc 1 159 22 is_stmt 0 view .LVU223
 794 000e 064B     		ldr	r3, .L63
 795 0010 187C     		ldrb	r0, [r3, #16]	@ zero_extendqisi2
 796              	.LVL65:
 797              	.L55:
 168:controller/engine_cycle/ignition.c **** 
 798              		.loc 1 168 1 view .LVU224
 799 0012 08BD     		pop	{r3, pc}
 800              	.LVL66:
 801              	.L56:
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 24


 165:controller/engine_cycle/ignition.c ****         return 1;
 802              		.loc 1 165 9 is_stmt 1 view .LVU225
 803 0014 0548     		ldr	r0, .L63+4
 804              	.LVL67:
 165:controller/engine_cycle/ignition.c ****         return 1;
 805              		.loc 1 165 9 is_stmt 0 view .LVU226
 806 0016 FFF7FEFF 		bl	log_error
 807              	.LVL68:
 166:controller/engine_cycle/ignition.c ****     }
 808              		.loc 1 166 9 is_stmt 1 view .LVU227
 166:controller/engine_cycle/ignition.c ****     }
 809              		.loc 1 166 16 is_stmt 0 view .LVU228
 810 001a 0120     		movs	r0, #1
 811 001c F9E7     		b	.L55
 812              	.LVL69:
 813              	.L57:
 814              		.cfi_def_cfa_offset 0
 815              		.cfi_restore 3
 816              		.cfi_restore 14
 156:controller/engine_cycle/ignition.c ****     {
 817              		.loc 1 156 5 view .LVU229
 818 001e 0120     		movs	r0, #1
 819              	.LVL70:
 156:controller/engine_cycle/ignition.c ****     {
 820              		.loc 1 156 5 view .LVU230
 821 0020 7047     		bx	lr
 822              	.LVL71:
 823              	.L58:
 163:controller/engine_cycle/ignition.c ****     default:
 824              		.loc 1 163 16 view .LVU231
 825 0022 0220     		movs	r0, #2
 826              	.LVL72:
 168:controller/engine_cycle/ignition.c **** 
 827              		.loc 1 168 1 view .LVU232
 828 0024 7047     		bx	lr
 829              	.L64:
 830 0026 00BF     		.align	2
 831              	.L63:
 832 0028 00000000 		.word	engine
 833 002c 00000000 		.word	.LC6
 834              		.cfi_endproc
 835              	.LFE232:
 837              		.section	.text.ignition_get_coil_duty_cycle,"ax",%progbits
 838              		.align	1
 839              		.global	ignition_get_coil_duty_cycle
 840              		.syntax unified
 841              		.thumb
 842              		.thumb_func
 844              	ignition_get_coil_duty_cycle:
 845              	.LFB235:
 220:controller/engine_cycle/ignition.c **** 
 221:controller/engine_cycle/ignition.c **** /**
 222:controller/engine_cycle/ignition.c ****  * @brief Gets the duty cycle of the ignition coil as a percentage.
 223:controller/engine_cycle/ignition.c ****  * 
 224:controller/engine_cycle/ignition.c ****  * @return The duty cycle of the ignition coil.
 225:controller/engine_cycle/ignition.c ****  */
 226:controller/engine_cycle/ignition.c **** percent_t ignition_get_coil_duty_cycle()
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 25


 227:controller/engine_cycle/ignition.c **** {
 846              		.loc 1 227 1 is_stmt 1 view -0
 847              		.cfi_startproc
 848              		@ args = 0, pretend = 0, frame = 0
 849              		@ frame_needed = 0, uses_anonymous_args = 0
 850              		@ link register save eliminated.
 228:controller/engine_cycle/ignition.c **** 
 229:controller/engine_cycle/ignition.c **** }
 851              		.loc 1 229 1 view .LVU234
 852 0000 7047     		bx	lr
 853              		.cfi_endproc
 854              	.LFE235:
 856              		.section	.text.ignition_get_advance,"ax",%progbits
 857              		.align	1
 858              		.global	ignition_get_advance
 859              		.syntax unified
 860              		.thumb
 861              		.thumb_func
 863              	ignition_get_advance:
 864              	.LFB236:
 230:controller/engine_cycle/ignition.c **** 
 231:controller/engine_cycle/ignition.c **** angle_t ignition_get_advance()
 232:controller/engine_cycle/ignition.c **** {
 865              		.loc 1 232 1 view -0
 866              		.cfi_startproc
 867              		@ args = 0, pretend = 0, frame = 0
 868              		@ frame_needed = 0, uses_anonymous_args = 0
 869 0000 08B5     		push	{r3, lr}
 870              		.cfi_def_cfa_offset 8
 871              		.cfi_offset 3, -8
 872              		.cfi_offset 14, -4
 873 0002 2DED028B 		vpush.64	{d8}
 874              		.cfi_def_cfa_offset 16
 875              		.cfi_offset 80, -16
 876              		.cfi_offset 81, -12
 233:controller/engine_cycle/ignition.c ****     angle_t final_advance = IGNITION_ADVANCE_FAIL_SAFE;
 877              		.loc 1 233 5 view .LVU236
 878              	.LVL73:
 234:controller/engine_cycle/ignition.c ****     if (engine.spinning_state != SS_RUNNING)
 879              		.loc 1 234 5 view .LVU237
 880              		.loc 1 234 15 is_stmt 0 view .LVU238
 881 0006 0E4B     		ldr	r3, .L70
 882 0008 5B7C     		ldrb	r3, [r3, #17]	@ zero_extendqisi2
 883              		.loc 1 234 8 view .LVU239
 884 000a 032B     		cmp	r3, #3
 885 000c 05D0     		beq	.L67
 235:controller/engine_cycle/ignition.c ****     {
 236:controller/engine_cycle/ignition.c ****         return configuration.cranking_advance;
 886              		.loc 1 236 9 is_stmt 1 view .LVU240
 887              		.loc 1 236 29 is_stmt 0 view .LVU241
 888 000e 0D4B     		ldr	r3, .L70+4
 889 0010 93ED040A 		vldr.32	s0, [r3, #16]
 890              	.LVL74:
 891              	.L66:
 237:controller/engine_cycle/ignition.c ****     }
 238:controller/engine_cycle/ignition.c **** 
 239:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 26


 240:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 241:controller/engine_cycle/ignition.c **** 
 242:controller/engine_cycle/ignition.c ****     final_advance += table_2d_get_value(&configuration.ignition_table, rpm, map);
 243:controller/engine_cycle/ignition.c ****     
 244:controller/engine_cycle/ignition.c ****     /* Here we can apply all kinds of correction to the table */
 245:controller/engine_cycle/ignition.c **** 
 246:controller/engine_cycle/ignition.c ****     return final_advance;
 247:controller/engine_cycle/ignition.c **** }...
 892              		.loc 1 247 1 view .LVU242
 893 0014 BDEC028B 		vldm	sp!, {d8}
 894              		.cfi_remember_state
 895              		.cfi_restore 80
 896              		.cfi_restore 81
 897              		.cfi_def_cfa_offset 8
 898 0018 08BD     		pop	{r3, pc}
 899              	.LVL75:
 900              	.L67:
 901              		.cfi_restore_state
 239:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
 902              		.loc 1 239 5 is_stmt 1 view .LVU243
 239:controller/engine_cycle/ignition.c ****     rpm_t rpm = crankshaft_get_rpm();
 903              		.loc 1 239 17 is_stmt 0 view .LVU244
 904 001a FFF7FEFF 		bl	crankshaft_get_rpm
 905              	.LVL76:
 906 001e B0EE408A 		vmov.f32	s16, s0
 907              	.LVL77:
 240:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 908              		.loc 1 240 5 is_stmt 1 view .LVU245
 240:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 909              		.loc 1 240 22 is_stmt 0 view .LVU246
 910 0022 FFF7FEFF 		bl	sensor_map_get
 911              	.LVL78:
 240:controller/engine_cycle/ignition.c ****     pressure_t map = sensor_map_get();
 912              		.loc 1 240 22 view .LVU247
 913 0026 F0EE400A 		vmov.f32	s1, s0
 914              	.LVL79:
 242:controller/engine_cycle/ignition.c ****     final_advance += table_2d_get_value(&configuration.ignition_table, rpm, map);
 915              		.loc 1 242 5 is_stmt 1 view .LVU248
 242:controller/engine_cycle/ignition.c ****     final_advance += table_2d_get_value(&configuration.ignition_table, rpm, map);
 916              		.loc 1 242 22 is_stmt 0 view .LVU249
 917 002a B0EE480A 		vmov.f32	s0, s16
 918              	.LVL80:
 242:controller/engine_cycle/ignition.c ****     final_advance += table_2d_get_value(&configuration.ignition_table, rpm, map);
 919              		.loc 1 242 22 view .LVU250
 920 002e 0648     		ldr	r0, .L70+8
 921 0030 FFF7FEFF 		bl	table_2d_get_value
 922              	.LVL81:
 242:controller/engine_cycle/ignition.c ****     final_advance += table_2d_get_value(&configuration.ignition_table, rpm, map);
 923              		.loc 1 242 19 discriminator 1 view .LVU251
 924 0034 F2EE047A 		vmov.f32	s15, #1.0e+1
 925 0038 30EE270A 		vadd.f32	s0, s0, s15
 926              	.LVL82:
 246:controller/engine_cycle/ignition.c ****     return final_advance;
 927              		.loc 1 246 5 is_stmt 1 view .LVU252
 246:controller/engine_cycle/ignition.c ****     return final_advance;
 928              		.loc 1 246 12 is_stmt 0 view .LVU253
 929 003c EAE7     		b	.L66
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 27


 930              	.L71:
 931 003e 00BF     		.align	2
 932              	.L70:
 933 0040 00000000 		.word	engine
 934 0044 00000000 		.word	configuration
 935 0048 2C000000 		.word	configuration+44
 936              		.cfi_endproc
 937              	.LFE236:
 939              		.section	.bss.next_firing_cylinders.0,"aw",%nobits
 940              		.align	2
 943              	next_firing_cylinders.0:
 944 0000 0000     		.space	2
 945              		.section	.bss.spark_is_in_progress,"aw",%nobits
 948              	spark_is_in_progress:
 949 0000 00       		.space	1
 950              		.global	ignition_order
 951              		.section	.bss.ignition_order,"aw",%nobits
 952              		.align	2
 955              	ignition_order:
 956 0000 00000000 		.space	4
 957              		.global	ignition_coil_state
 958              		.section	.bss.ignition_coil_state,"aw",%nobits
 959              		.align	2
 962              	ignition_coil_state:
 963 0000 00000000 		.space	4
 964              		.global	ignition_outputs
 965              		.section	.bss.ignition_outputs,"aw",%nobits
 966              		.align	2
 969              	ignition_outputs:
 970 0000 00000000 		.space	32
 970      00000000 
 970      00000000 
 970      00000000 
 970      00000000 
 971              		.text
 972              	.Letext0:
 973              		.file 3 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 974              		.file 4 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 975              		.file 5 "C:/Users/alireza/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-
 976              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f401xc.h"
 977              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 978              		.file 8 "controller/types.h"
 979              		.file 9 "Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS_V2/cmsis_os2.h"
 980              		.file 10 "controller/engine_cycle/trigger.h"
 981              		.file 11 "controller/tables.h"
 982              		.file 12 "controller/IO/analog_inputs.h"
 983              		.file 13 "controller/IO/sensors.h"
 984              		.file 14 "controller/utils/pid.h"
 985              		.file 15 "controller/algorithm/governer.h"
 986              		.file 16 "controller/controller.h"
 987              		.file 17 "controller/engine_cycle/ignition.h"
 988              		.file 18 "controller/utils/timing.h"
 989              		.file 19 "controller/utils/error_handling.h"
ARM GAS  C:\Users\alireza\AppData\Local\Temp\cc5md5me.s 			page 28


DEFINED SYMBOLS
                            *ABS*:00000000 ignition.c
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:21     .rodata.ignition_coil_begin_charge.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:25     .text.ignition_coil_begin_charge:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:31     .text.ignition_coil_begin_charge:00000000 ignition_coil_begin_charge
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:119    .text.ignition_coil_begin_charge:0000004c $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:962    .bss.ignition_coil_state:00000000 ignition_coil_state
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:969    .bss.ignition_outputs:00000000 ignition_outputs
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:126    .text.ignition_coil_fire_spark:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:132    .text.ignition_coil_fire_spark:00000000 ignition_coil_fire_spark
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:224    .text.ignition_coil_fire_spark:00000050 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:948    .bss.spark_is_in_progress:00000000 spark_is_in_progress
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:232    .rodata.ignition_init.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:242    .text.ignition_init:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:248    .text.ignition_init:00000000 ignition_init
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:426    .text.ignition_init:000000a4 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:955    .bss.ignition_order:00000000 ignition_order
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:439    .rodata.ignition_trigger_event_handle.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:446    .text.ignition_trigger_event_handle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:452    .text.ignition_trigger_event_handle:00000000 ignition_trigger_event_handle
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:741    .text.ignition_trigger_event_handle:0000017c $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:943    .bss.next_firing_cylinders.0:00000000 next_firing_cylinders.0
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:762    .rodata.ignition_get_number_of_sparks_per_coil.str1.4:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:766    .text.ignition_get_number_of_sparks_per_coil:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:772    .text.ignition_get_number_of_sparks_per_coil:00000000 ignition_get_number_of_sparks_per_coil
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:832    .text.ignition_get_number_of_sparks_per_coil:00000028 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:838    .text.ignition_get_coil_duty_cycle:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:844    .text.ignition_get_coil_duty_cycle:00000000 ignition_get_coil_duty_cycle
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:857    .text.ignition_get_advance:00000000 $t
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:863    .text.ignition_get_advance:00000000 ignition_get_advance
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:933    .text.ignition_get_advance:00000040 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:940    .bss.next_firing_cylinders.0:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:949    .bss.spark_is_in_progress:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:952    .bss.ignition_order:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:959    .bss.ignition_coil_state:00000000 $d
C:\Users\alireza\AppData\Local\Temp\cc5md5me.s:966    .bss.ignition_outputs:00000000 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
log_error
HAL_GPIO_ReadPin
log_warning
configuration
engine
scheduler_schedule_event_with_arg
crankshaft_get_rpm
sensor_map_get
table_2d_get_value
